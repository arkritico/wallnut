{
  "regulationRef": "portaria-349b-2013-reh",
  "description": "Regras de conformidade térmica extraídas do REH (Portaria 349-B/2013), SCE (DL 118/2013), e Despacho 15793-K/2013 — usando lookup tables por zona climática e verificações energéticas globais",
  "extractedBy": "system-migration",
  "extractedAt": "2026-02-17",
  "rules": [
    {
      "id": "REH-UWALL-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Tabela I.01 — Umáx Paredes Exteriores",
      "description": "O coeficiente de transmissão térmica das paredes exteriores ({envelope.externalWallUValue} W/(m².K)) excede o valor máximo para a zona climática {location.climateZoneWinter}.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.externalWallUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_u_walls",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Reforçar o isolamento térmico das paredes exteriores. Soluções: ETICS (isolamento pelo exterior), isolamento na caixa-de-ar, ou isolamento pelo interior. Espessura e tipo de isolamento dependem do sistema construtivo.",
      "currentValueTemplate": "U = {envelope.externalWallUValue} W/(m².K)",
      "requiredValue": "Consultar Despacho 15793-K/2013 Tabela I.01 por zona climática ({location.climateZoneWinter}): I1 ≤ 0.50 / I2 ≤ 0.40 / I3 ≤ 0.35 W/(m².K)",
      "enabled": true,
      "tags": [
        "paredes",
        "valor-U",
        "isolamento",
        "lookup",
        "envolvente exterior"
      ]
    },
    {
      "id": "REH-UROOF-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Tabela I.01 — Umáx Cobertura",
      "description": "O coeficiente de transmissão térmica da cobertura ({envelope.roofUValue} W/(m².K)) excede o valor máximo para a zona climática {location.climateZoneWinter}.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.roofUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_u_roofs",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Reforçar o isolamento térmico da cobertura. A cobertura é tipicamente o elemento com maiores perdas térmicas. Soluções: isolamento na laje de esteira, isolamento nas vertentes, cobertura invertida.",
      "currentValueTemplate": "U = {envelope.roofUValue} W/(m².K)",
      "requiredValue": "Consultar Despacho 15793-K/2013 Tabela I.01 por zona climática ({location.climateZoneWinter}): I1 ≤ 0.40 / I2 ≤ 0.35 / I3 ≤ 0.30 W/(m².K)",
      "enabled": true,
      "tags": [
        "cobertura",
        "valor-U",
        "isolamento",
        "lookup"
      ]
    },
    {
      "id": "REH-UFLOOR-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Tabela I.01 — Umáx Pavimento Exterior",
      "description": "O coeficiente de transmissão térmica do pavimento em contacto com o exterior ({envelope.floorUValue} W/(m².K)) excede o valor máximo para a zona climática {location.climateZoneWinter}.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.floorUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_u_floors",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Reforçar o isolamento térmico do pavimento em contacto com o exterior ou espaço não-aquecido. Soluções: isolamento sob a laje, isolamento no pavimento flutuante.",
      "currentValueTemplate": "U = {envelope.floorUValue} W/(m².K)",
      "requiredValue": "Consultar Despacho 15793-K/2013 Tabela I.01 por zona climática ({location.climateZoneWinter}): I1 ≤ 0.50 / I2 ≤ 0.40 / I3 ≤ 0.35 W/(m².K)",
      "enabled": true,
      "tags": [
        "pavimento",
        "valor-U",
        "isolamento",
        "lookup"
      ]
    },
    {
      "id": "REH-UWIN-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Tabela I.01 — Umáx Vãos Envidraçados",
      "description": "O coeficiente de transmissão térmica dos vãos envidraçados ({envelope.windowUValue} W/(m².K)) excede o valor máximo para a zona climática {location.climateZoneWinter}.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.windowUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_u_windows",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Substituir ou melhorar os vãos envidraçados. Soluções: vidro duplo com caixa-de-ar >= 12mm, vidro de baixa emissividade, caixilharia com corte térmico (alumínio com RPT, PVC, madeira).",
      "currentValueTemplate": "U = {envelope.windowUValue} W/(m².K)",
      "requiredValue": "Consultar Despacho 15793-K/2013 Tabela I.01 por zona climática ({location.climateZoneWinter}): I1 ≤ 2.80 / I2 ≤ 2.40 / I3 ≤ 2.20 W/(m².K)",
      "enabled": true,
      "tags": [
        "envidraçados",
        "janelas",
        "valor-U",
        "lookup"
      ]
    },
    {
      "id": "REH-UINTWALL-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Tabela I.01 — Umáx Paredes Interiores (btr > 0.7)",
      "description": "O coeficiente de transmissão térmica da parede interior em contacto com espaço não-útil com btr > 0.7 ({envelope.interiorWallHighBtrUValue} W/(m².K)) excede o valor máximo para a zona climática {location.climateZoneWinter}. Para btr > 0.7, aplicam-se os mesmos limites das paredes exteriores.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.interiorWallHighBtrUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_u_walls",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Reforçar o isolamento da parede interior em contacto com espaço não-útil (ENU) com btr > 0.7. Para btr elevado, o ENU comporta-se quase como o exterior, pelo que os limites de U são iguais aos das paredes exteriores. Soluções: isolamento na face voltada ao ENU, contra-fachada isolada.",
      "currentValueTemplate": "U = {envelope.interiorWallHighBtrUValue} W/(m².K)",
      "requiredValue": "Igual ao limite de paredes exteriores para btr > 0.7: I1 ≤ 0.50 / I2 ≤ 0.40 / I3 ≤ 0.35 W/(m².K)",
      "enabled": true,
      "tags": [
        "paredes interiores",
        "valor-U",
        "btr",
        "envolvente interior",
        "ENU"
      ]
    },
    {
      "id": "REH-UINTWALL-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Tabela I.01 — Umáx Paredes Interiores (btr ≤ 0.7)",
      "description": "O coeficiente de transmissão térmica da parede interior em contacto com espaço não-útil com btr ≤ 0.7 ({envelope.interiorWallLowBtrUValue} W/(m².K)) excede o valor máximo majorado para a zona climática {location.climateZoneWinter}. Para btr ≤ 0.7, o limite é Umáx_exterior x 1.25.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.interiorWallLowBtrUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_u_interior_walls_low_btr",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Reforçar o isolamento da parede interior em contacto com ENU com btr ≤ 0.7. Embora o limite seja majorado em 25% face às paredes exteriores, o isolamento continua a ser necessário. Soluções: isolamento na face voltada ao ENU, painéis isolantes, contra-fachada com isolamento.",
      "currentValueTemplate": "U = {envelope.interiorWallLowBtrUValue} W/(m².K)",
      "requiredValue": "Umáx_exterior × 1.25 para btr ≤ 0.7: I1 ≤ 0.625 / I2 ≤ 0.50 / I3 ≤ 0.4375 W/(m².K)",
      "enabled": true,
      "tags": [
        "paredes interiores",
        "valor-U",
        "btr",
        "envolvente interior",
        "ENU"
      ]
    },
    {
      "id": "REH-UENV-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Tabela I.01 — Umáx Paredes de Meação",
      "description": "O coeficiente de transmissão térmica da parede em contacto com edifício adjacente ({envelope.adjacentWallUValue} W/(m².K)) excede o valor máximo de 0.80 W/(m².K). Os elementos em contacto com edifícios adjacentes (paredes de meação) devem respeitar este limite em todas as zonas climáticas.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.adjacentWallUValue",
          "operator": ">",
          "value": 0.8
        }
      ],
      "remediation": "Reforçar o isolamento térmico das paredes de meação. Soluções: isolamento pelo interior com placa de gesso cartonado e isolante térmico, contra-fachada com caixa-de-ar e isolamento. O valor máximo de U é 0.80 W/(m².K) para todas as zonas climáticas.",
      "currentValueTemplate": "U = {envelope.adjacentWallUValue} W/(m².K)",
      "requiredValue": "≤ 0.80 W/(m².K) (todas as zonas climáticas)",
      "enabled": true,
      "tags": [
        "paredes de meação",
        "valor-U",
        "isolamento",
        "envolvente interior"
      ]
    },
    {
      "id": "REH-UPAV-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Tabela I.01 — Umáx Pavimento sobre ENU",
      "description": "O coeficiente de transmissão térmica do pavimento sobre espaço não-aquecido ({envelope.floorOverUnheatedUValue} W/(m².K)) excede o valor máximo para a zona climática {location.climateZoneWinter}.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.floorOverUnheatedUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_u_floors",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Reforçar o isolamento térmico do pavimento sobre espaço não-aquecido (garagem, cave, arrecadação). Soluções: isolamento na face inferior da laje (projecção de poliuretano, painéis de EPS/XPS fixados mecanicamente), isolamento incorporado no pavimento flutuante.",
      "currentValueTemplate": "U = {envelope.floorOverUnheatedUValue} W/(m².K)",
      "requiredValue": "Consultar Despacho 15793-K/2013 por zona climática ({location.climateZoneWinter}): I1 ≤ 0.50 / I2 ≤ 0.40 / I3 ≤ 0.35 W/(m².K)",
      "enabled": true,
      "tags": [
        "pavimento",
        "valor-U",
        "isolamento",
        "espaço não-aquecido",
        "lookup"
      ]
    },
    {
      "id": "REH-UGROUNDFLOOR-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Tabela I.01 — Ubf Pavimento em Contacto com Solo",
      "description": "O coeficiente de transmissão térmica do pavimento em contacto com o solo ({envelope.groundFloorUValue} W/(m².K)) excede o valor máximo para a zona climática {location.climateZoneWinter}.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.groundFloorUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_u_ground_floor",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Reforçar o isolamento térmico do pavimento em contacto com o solo. Soluções: isolamento perimetral (XPS na fundação), isolamento sob a laje (antes da betonagem), isolamento sobre a laje (pavimento flutuante com isolamento). O cálculo de Ubf deve seguir a EN ISO 13370, considerando a dimensão característica do pavimento (B').",
      "currentValueTemplate": "Ubf = {envelope.groundFloorUValue} W/(m².K)",
      "requiredValue": "Consultar Despacho 15793-K/2013 por zona climática ({location.climateZoneWinter}): I1 ≤ 0.50 / I2 ≤ 0.40 / I3 ≤ 0.35 W/(m².K)",
      "enabled": true,
      "tags": [
        "pavimento",
        "solo",
        "valor-U",
        "isolamento",
        "Ubf",
        "lookup"
      ]
    },
    {
      "id": "REH-UDOOR-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Tabela I.01 — Umáx Portas Exteriores",
      "description": "O coeficiente de transmissão térmica das portas exteriores ({envelope.externalDoorUValue} W/(m².K)) excede o valor máximo para a zona climática {location.climateZoneWinter}.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.externalDoorUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_u_doors",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Substituir ou melhorar as portas exteriores. As portas exteriores opacas têm limites de U menos restritivos que os envidraçados mas devem ainda assim cumprir os máximos regulamentares. Soluções: porta com isolamento no interior (espuma de poliuretano ou lã mineral), porta com corte térmico, porta em madeira maciça (menor U que metálica sem isolamento).",
      "currentValueTemplate": "U = {envelope.externalDoorUValue} W/(m².K)",
      "requiredValue": "Consultar Despacho 15793-K/2013 por zona climática ({location.climateZoneWinter}): I1 ≤ 3.30 / I2 ≤ 2.80 / I3 ≤ 2.50 W/(m².K)",
      "enabled": true,
      "tags": [
        "portas",
        "valor-U",
        "envolvente exterior",
        "lookup"
      ]
    },
    {
      "id": "REH-PTL-PLANE-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Secção I.3 — Pontes Térmicas Planas (Umáx)",
      "description": "O coeficiente de transmissão térmica na zona de ponte térmica plana ({envelope.planarThermalBridgeUValue} W/(m².K)) excede o dobro do valor U da parede corrente. O Despacho 15793-K/2013 exige que U na zona da ponte térmica plana não exceda 2 × U da zona corrente adjacente.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.planarThermalBridgeUValue",
          "operator": ">",
          "value": 0.9
        }
      ],
      "remediation": "Corrigir as pontes térmicas planas. A regra fundamental é U_ptp ≤ 2 × U_parede_corrente. Pontes térmicas planas típicas: pilares, vigas de bordo, caixas de estore, talões de laje. Soluções: isolamento contínuo pelo exterior (ETICS elimina a maioria das PTP), reforço localizado com isolamento (mínimo 2/3 da espessura do isolamento corrente).",
      "currentValueTemplate": "U_ptp = {envelope.planarThermalBridgeUValue} W/(m².K)",
      "requiredValue": "≤ 2 × U_parede_corrente (máximo absoluto conforme Despacho 15793-K/2013)",
      "enabled": true,
      "tags": [
        "pontes térmicas planas",
        "valor-U",
        "isolamento",
        "envolvente"
      ]
    },
    {
      "id": "REH-PTL-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Tabela IV.3 — Pontes Térmicas Lineares (ψ global)",
      "description": "O coeficiente de transmissão térmica linear da ponte térmica ({envelope.thermalBridgeCoefficient} W/(m.K)) excede o valor máximo admissível de 0.50 W/(m.K). O tratamento de pontes térmicas é obrigatório em edifícios novos conforme o REH.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.thermalBridgeCoefficient",
          "operator": ">",
          "value": 0.5
        }
      ],
      "remediation": "Corrigir as pontes térmicas lineares. Soluções: isolamento contínuo pelo exterior (ETICS) que elimina a maioria das pontes térmicas, reforço localizado nas zonas de ligação. Valores de referência psi conforme tabelas do Despacho 15793-K/2013.",
      "currentValueTemplate": "psi = {envelope.thermalBridgeCoefficient} W/(m.K)",
      "requiredValue": "≤ 0.50 W/(m.K)",
      "enabled": true,
      "tags": [
        "pontes térmicas",
        "isolamento",
        "envolvente"
      ]
    },
    {
      "id": "REH-PTL-FACPAV-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Tabela IV.3 — PTL Ligação Fachada/Pavimento",
      "description": "O coeficiente de transmissão térmica linear na ligação fachada/pavimento ({envelope.psiFloorJunction} W/(m.K)) excede o valor de referência. Para ligação fachada-pavimento intermédio, os valores de referência são: isolamento repartido psi = 0.50, isolamento exterior psi = 0.10, isolamento interior psi = 0.50 W/(m.K).",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.psiFloorJunction",
          "operator": ">",
          "value": 0.5
        }
      ],
      "remediation": "Reduzir a ponte térmica na ligação fachada/pavimento. Soluções: prolongar o isolamento exterior sobre o topo da laje (mínimo 0.5m para cada lado), utilizar isolamento contínuo pelo exterior (ETICS) que reduz psi para ~0.10 W/(m.K), inserir banda de rotura térmica na laje ao nível da fachada.",
      "currentValueTemplate": "psi_fachada-pavimento = {envelope.psiFloorJunction} W/(m.K)",
      "requiredValue": "Referência Despacho 15793-K/2013 Tabela IV.3: isolamento exterior psi ≤ 0.10 / repartido ou interior psi ≤ 0.50 W/(m.K)",
      "enabled": true,
      "tags": [
        "pontes térmicas lineares",
        "fachada",
        "pavimento",
        "psi"
      ]
    },
    {
      "id": "REH-PTL-FACROOF-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Tabela IV.3 — PTL Ligação Fachada/Cobertura",
      "description": "O coeficiente de transmissão térmica linear na ligação fachada/cobertura ({envelope.psiRoofJunction} W/(m.K)) excede o valor de referência. Para ligação fachada-cobertura, os valores de referência são: isolamento repartido psi = 0.50, isolamento exterior psi = 0.10, isolamento interior psi = 0.50 W/(m.K).",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.psiRoofJunction",
          "operator": ">",
          "value": 0.5
        }
      ],
      "remediation": "Reduzir a ponte térmica na ligação fachada/cobertura. Soluções: garantir continuidade do isolamento entre fachada e cobertura, prolongar ETICS até ao remate superior, isolar platibanda ou beiral pelo exterior. A ligação fachada/cobertura é uma das pontes térmicas mais significativas.",
      "currentValueTemplate": "psi_fachada-cobertura = {envelope.psiRoofJunction} W/(m.K)",
      "requiredValue": "Referência Despacho 15793-K/2013 Tabela IV.3: isolamento exterior psi ≤ 0.10 / repartido ou interior psi ≤ 0.50 W/(m.K)",
      "enabled": true,
      "tags": [
        "pontes térmicas lineares",
        "fachada",
        "cobertura",
        "psi"
      ]
    },
    {
      "id": "REH-PTL-FACVAR-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Tabela IV.3 — PTL Ligação Fachada/Varanda",
      "description": "O coeficiente de transmissão térmica linear na ligação fachada/varanda ({envelope.psiBalconyJunction} W/(m.K)) excede o valor de referência de 0.55 W/(m.K). As varandas em consola constituem pontes térmicas significativas devido à continuidade da laje de betão.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.psiBalconyJunction",
          "operator": ">",
          "value": 0.55
        }
      ],
      "remediation": "Reduzir a ponte térmica na ligação fachada/varanda. Soluções: inserir elemento de rotura térmica na laje da varanda (tipo Schock Isokorb ou equivalente), isolar a face inferior da laje da varanda, prolongar o isolamento exterior sobre o topo e base da laje na zona de transição. Valores de referência: sem isolamento psi = 0.55, com rotura térmica psi = 0.10 W/(m.K).",
      "currentValueTemplate": "psi_fachada-varanda = {envelope.psiBalconyJunction} W/(m.K)",
      "requiredValue": "Referência Despacho 15793-K/2013 Tabela IV.3: sem tratamento psi ≤ 0.55 / com rotura térmica psi ≤ 0.10 W/(m.K)",
      "enabled": true,
      "tags": [
        "pontes térmicas lineares",
        "fachada",
        "varanda",
        "consola",
        "psi"
      ]
    },
    {
      "id": "REH-PTL-FACWIN-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Tabela IV.3 — PTL Ligação Fachada/Caixilharia",
      "description": "O coeficiente de transmissão térmica linear na ligação fachada/caixilharia ({envelope.psiWindowJunction} W/(m.K)) excede o valor de referência. A ligação entre a fachada e o contorno dos vãos envidraçados é uma ponte térmica frequente, especialmente quando o isolamento não envolve o aro da caixilharia.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.psiWindowJunction",
          "operator": ">",
          "value": 0.25
        }
      ],
      "remediation": "Reduzir a ponte térmica no contorno dos vãos envidraçados. Soluções: prolongar o isolamento exterior (ETICS) até ao aro da caixilharia com sobreposição mínima de 3 cm, posicionar a caixilharia no plano do isolamento, utilizar perfis de remate com corte térmico. Valores de referência: sem tratamento psi = 0.25, com isolamento envolvendo o aro psi = 0.10 W/(m.K).",
      "currentValueTemplate": "psi_fachada-caixilharia = {envelope.psiWindowJunction} W/(m.K)",
      "requiredValue": "Referência Despacho 15793-K/2013 Tabela IV.3: psi ≤ 0.25 (sem tratamento) / psi ≤ 0.10 (com tratamento) W/(m.K)",
      "enabled": true,
      "tags": [
        "pontes térmicas lineares",
        "fachada",
        "caixilharia",
        "vãos",
        "psi"
      ]
    },
    {
      "id": "REH-PTL-PILARVIGA-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Tabela IV.1 — PTL Zona Corrente/Pilar/Viga",
      "description": "A diferença entre o U da zona corrente e o U na zona do pilar/viga indica uma ponte térmica plana significativa. Na zona corrente da fachada, pilares e vigas de bordo em betão constituem pontes térmicas planas quando o isolamento não é contínuo. O U na zona do pilar/viga ({envelope.psiColumnBeam} W/(m².K)) deve ser verificado.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.psiColumnBeam",
          "operator": ">",
          "value": 0.9
        }
      ],
      "remediation": "Corrigir as pontes térmicas planas em pilares e vigas de bordo. Soluções: isolamento contínuo pelo exterior (ETICS) que elimina estas PTP, reforço localizado do isolamento nos pilares e vigas (mínimo 2/3 da espessura do isolamento corrente), utilizar elementos estruturais com menor condutibilidade (betão leve, tijolo estrutural). Regra: U_pilar/viga ≤ 2 × U_zona_corrente.",
      "currentValueTemplate": "U_pilar/viga = {envelope.psiColumnBeam} W/(m².K)",
      "requiredValue": "≤ 2 × U_zona_corrente (Despacho 15793-K/2013)",
      "enabled": true,
      "tags": [
        "pontes térmicas planas",
        "pilar",
        "viga",
        "zona corrente",
        "PTP"
      ]
    },
    {
      "id": "REH-GSOLAR-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 7.º — Factor Solar g⊥,vi Máximo",
      "description": "O factor solar dos envidraçados ({envelope.windowSolarFactor}) excede o valor máximo para a zona climática de verão {location.climateZoneSummer}.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.windowSolarFactor",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_solar_factor",
          "keys": [
            "location.climateZoneSummer"
          ]
        }
      ],
      "remediation": "Reduzir o factor solar dos envidraçados. Soluções: protecções solares exteriores (estores, palas, persianas), vidro de controlo solar, películas reflectoras. Protecções exteriores são mais eficazes que interiores.",
      "currentValueTemplate": "g⊥,vi = {envelope.windowSolarFactor}",
      "requiredValue": "Consultar Portaria 349-B/2013 por zona climática ({location.climateZoneSummer}): V1/V2 ≤ 0.56 / V3 ≤ 0.50",
      "enabled": true,
      "tags": [
        "factor solar",
        "envidraçados",
        "sobreaquecimento",
        "lookup"
      ]
    },
    {
      "id": "REH-GSOLAR-SOUTH-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 7.º — Factor Solar Envidraçados Orientação Sul",
      "description": "O factor solar dos envidraçados orientados a Sul ({envelope.windowSolarFactorSouth}) excede o valor máximo admissível de {envelope.windowSolarFactorSouth} para a orientação Sul na zona de verão {location.climateZoneSummer}. A orientação Sul recebe radiação solar intensa, requerendo protecção solar adequada.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.windowSolarFactorSouth",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_solar_factor_south",
          "keys": [
            "location.climateZoneSummer"
          ]
        }
      ],
      "remediation": "Reduzir o factor solar dos envidraçados orientados a Sul. Soluções mais eficazes para Sul: palas horizontais superiores (bloqueiam sol de verão alto, admitem sol de inverno baixo), estores exteriores, vegetação de folha caduca. O factor de correcção para protecção solar exterior (Fm,v) reduz significativamente g⊥,vi.",
      "currentValueTemplate": "g⊥,vi (Sul) = {envelope.windowSolarFactorSouth}",
      "requiredValue": "Consultar limites para orientação Sul: V1/V2 ≤ 0.56 / V3 ≤ 0.50",
      "enabled": true,
      "tags": [
        "factor solar",
        "envidraçados",
        "Sul",
        "orientação",
        "protecção solar"
      ]
    },
    {
      "id": "REH-GSOLAR-WEST-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 7.º — Factor Solar Envidraçados Orientação Oeste",
      "description": "O factor solar dos envidraçados orientados a Oeste ({envelope.windowSolarFactorWest}) excede o valor máximo admissível para a orientação Oeste na zona de verão {location.climateZoneSummer}. A orientação Oeste recebe radiação solar intensa ao final da tarde, sendo a orientação mais crítica para sobreaquecimento.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.windowSolarFactorWest",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_solar_factor_west",
          "keys": [
            "location.climateZoneSummer"
          ]
        }
      ],
      "remediation": "Reduzir o factor solar dos envidraçados orientados a Oeste. A exposição Oeste é a mais crítica para sobreaquecimento. Soluções: estores exteriores (preferível a palas horizontais, ineficazes contra sol baixo), portadas exteriores, película de controlo solar, reduzir a área de envidraçado a Oeste. Factor de correcção protecção exterior: Fm,v ~ 0.04-0.10.",
      "currentValueTemplate": "g⊥,vi (Oeste) = {envelope.windowSolarFactorWest}",
      "requiredValue": "Consultar limites para orientação Oeste: V1/V2 ≤ 0.56 / V3 ≤ 0.50 (valores mais exigentes em edifícios sem protecção)",
      "enabled": true,
      "tags": [
        "factor solar",
        "envidraçados",
        "Oeste",
        "orientação",
        "sobreaquecimento"
      ]
    },
    {
      "id": "REH-GSOLAR-EAST-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 7.º — Factor Solar Envidraçados Orientação Este",
      "description": "O factor solar dos envidraçados orientados a Este ({envelope.windowSolarFactorEast}) excede o valor máximo admissível para a orientação Este na zona de verão {location.climateZoneSummer}. A orientação Este recebe radiação solar intensa de manhã.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.windowSolarFactorEast",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_solar_factor_east",
          "keys": [
            "location.climateZoneSummer"
          ]
        }
      ],
      "remediation": "Reduzir o factor solar dos envidraçados orientados a Este. Tal como a Oeste, palas horizontais são pouco eficazes contra o sol baixo de manhã. Soluções: estores exteriores, portadas, lâminas verticais orientáveis, película de controlo solar, redução da área envidraçada a Este.",
      "currentValueTemplate": "g⊥,vi (Este) = {envelope.windowSolarFactorEast}",
      "requiredValue": "Consultar limites para orientação Este: V1/V2 ≤ 0.56 / V3 ≤ 0.50",
      "enabled": true,
      "tags": [
        "factor solar",
        "envidraçados",
        "Este",
        "orientação",
        "sobreaquecimento"
      ]
    },
    {
      "id": "REH-GSOLAR-PROTEXT-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 7.º — Protecção Solar Exterior Obrigatória",
      "description": "Os envidraçados não dispõem de protecção solar exterior ({envelope.hasExteriorSolarProtection} = false). O REH exige protecção solar nos vãos envidraçados, sendo as protecções exteriores significativamente mais eficazes que as interiores (factor de correcção Fm,v: exterior ~ 0.04-0.10 vs. interior ~ 0.30-0.50).",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.hasExteriorSolarProtection",
          "operator": "==",
          "value": false
        }
      ],
      "remediation": "Instalar protecção solar exterior nos vãos envidraçados. Tipos e factores de correcção (Fm,v) típicos: estore exterior de lâminas metálicas (0.04-0.07), portada exterior opaca (0.04-0.06), persiana de enrolar (0.05-0.10), toldo exterior (0.15-0.25). Protecções interiores (estore interior, cortina) têm Fm,v de 0.30-0.50, muito menos eficazes.",
      "currentValueTemplate": "Protecção solar exterior: {envelope.hasExteriorSolarProtection}",
      "requiredValue": "Protecção solar exterior recomendada/obrigatória em vãos com área significativa",
      "enabled": true,
      "tags": [
        "protecção solar",
        "exterior",
        "envidraçados",
        "sobreaquecimento"
      ]
    },
    {
      "id": "REH-VENT-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 10.º — Taxa de Renovação de Ar Mínima",
      "description": "A taxa de renovação de ar ({envelope.airChangesPerHour} h-1) é inferior ao mínimo regulamentar absoluto de 0.4 h-1.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.airChangesPerHour",
          "operator": "<",
          "value": 0.4
        }
      ],
      "remediation": "Aumentar a taxa de ventilação para cumprir o mínimo absoluto de 0.4 h-1. Soluções: grelhas de admissão auto-reguláveis nas fachadas, extracção mecânica nas instalações sanitárias e cozinha, sistema de ventilação mecânica centralizada (VMC). O valor de referência REH é 0.6 h-1 (utilizado no cálculo de Ni/Nv).",
      "currentValueTemplate": "{envelope.airChangesPerHour} h-1",
      "requiredValue": ">= 0.4 h-1 (mínimo absoluto REH)",
      "enabled": true,
      "tags": [
        "ventilação",
        "renovação de ar",
        "QAI"
      ]
    },
    {
      "id": "REH-VENT-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 10.º — Taxa de Renovação de Ar de Referência",
      "description": "A taxa de renovação de ar ({envelope.airChangesPerHour} h-1) é inferior ao valor de referência de 0.6 h-1 utilizado no cálculo regulamentar. Embora o mínimo absoluto seja 0.4 h-1, o valor de referência de 0.6 h-1 é utilizado nos cálculos de Ni e Nv e garante melhor qualidade do ar interior.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.airChangesPerHour",
          "operator": "<",
          "value": 0.6
        },
        {
          "field": "envelope.airChangesPerHour",
          "operator": ">=",
          "value": 0.4
        }
      ],
      "remediation": "Aumentar a taxa de ventilação para o valor de referência de 0.6 h-1. Soluções: dimensionar correctamente as grelhas de admissão de ar auto-reguláveis (classe 2 ou 3), garantir aberturas de passagem entre compartimentos (folga sob portas interiores >= 25mm ou grelhas de passagem), verificar as condutas de extracção natural (dimensão e altura). O valor de 0.6 h-1 garante conformidade com o cálculo de referência Ni/Nv.",
      "currentValueTemplate": "{envelope.airChangesPerHour} h-1",
      "requiredValue": ">= 0.6 h-1 (referência REH para cálculo Ni/Nv)",
      "enabled": true,
      "tags": [
        "ventilação",
        "renovação de ar",
        "QAI",
        "referência"
      ]
    },
    {
      "id": "REH-VENT-GRILLE-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 10.º — Grelhas de Admissão Auto-reguláveis",
      "description": "O edifício não dispõe de grelhas de admissão de ar auto-reguláveis ({envelope.hasSelfRegulatingGrilles} = false). O REH exige ventilação natural ou mecânica adequada. Em ventilação natural, as grelhas auto-reguláveis nas fachadas dos quartos e sala são essenciais para garantir caudais controlados de admissão de ar.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.hasSelfRegulatingGrilles",
          "operator": "==",
          "value": false
        },
        {
          "field": "envelope.ventilationType",
          "operator": "==",
          "value": "natural"
        }
      ],
      "remediation": "Instalar grelhas de admissão de ar auto-reguláveis (classe 2 ou 3, conforme EN 13141-1) nas fachadas dos compartimentos principais (quartos e sala). O dimensionamento deve garantir o caudal mínimo por compartimento. Grelhas auto-reguláveis mantêm caudal constante independentemente da pressão do vento, evitando sobreventilação (perdas térmicas) e subventilação.",
      "currentValueTemplate": "Grelhas auto-reguláveis: {envelope.hasSelfRegulatingGrilles}",
      "requiredValue": "Grelhas auto-reguláveis obrigatórias em ventilação natural",
      "enabled": true,
      "tags": [
        "ventilação",
        "grelhas",
        "auto-reguláveis",
        "admissão de ar"
      ]
    },
    {
      "id": "REH-VENT-EXTKITCH-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 10.º — Caudal de Extracção Cozinha",
      "description": "O caudal de extracção na cozinha ({envelope.kitchenExtractionRate} m3/h) é inferior ao mínimo de 60 m3/h. A cozinha é um compartimento de serviço que requer extracção permanente para remoção de vapores, odores e contaminantes da combustão.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.kitchenExtractionRate",
          "operator": "<",
          "value": 60
        }
      ],
      "remediation": "Aumentar o caudal de extracção na cozinha para >= 60 m3/h (mínimo). Para cozinhas com aparelhos de combustão (fogão a gás), pode ser necessário caudal superior. Soluções: conduta de extracção natural com secção adequada (mínimo 250 cm2), extractor mecânico (exaustor), integração no sistema VMC. A extracção deve ser permanente (grelha de extracção) complementada pelo exaustor.",
      "currentValueTemplate": "Caudal extracção cozinha = {envelope.kitchenExtractionRate} m3/h",
      "requiredValue": ">= 60 m3/h (cozinha)",
      "enabled": true,
      "tags": [
        "ventilação",
        "extracção",
        "cozinha",
        "caudal"
      ]
    },
    {
      "id": "REH-VENT-EXTBATH-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 10.º — Caudal de Extracção Instalação Sanitária",
      "description": "O caudal de extracção na instalação sanitária ({envelope.bathroomExtractionRate} m3/h) é inferior ao mínimo de 45 m3/h. As instalações sanitárias são compartimentos de serviço que requerem extracção para remoção de humidade e odores.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.bathroomExtractionRate",
          "operator": "<",
          "value": 45
        }
      ],
      "remediation": "Aumentar o caudal de extracção nas instalações sanitárias para >= 45 m3/h (mínimo por IS). Soluções: conduta de extracção natural com secção adequada, extractor mecânico temporizado (liga com iluminação, desliga após temporização), integração no sistema VMC. Instalações sanitárias interiores (sem janela) requerem obrigatoriamente extracção mecânica.",
      "currentValueTemplate": "Caudal extracção IS = {envelope.bathroomExtractionRate} m3/h",
      "requiredValue": ">= 45 m3/h (instalação sanitária)",
      "enabled": true,
      "tags": [
        "ventilação",
        "extracção",
        "instalação sanitária",
        "caudal"
      ]
    },
    {
      "id": "REH-VENT-VMC-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 10.º — VMC Eficiência Recuperação de Calor",
      "description": "A eficiência do recuperador de calor do sistema de ventilação mecânica centralizada ({envelope.heatRecoveryEfficiency}%) é inferior ao mínimo de 70%. O REH bonifica a utilização de VMC com recuperação de calor eficiente no cálculo de Ni, mas exige eficiência mínima de 70% para essa bonificação.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.ventilationType",
          "operator": "==",
          "value": "mechanical_heat_recovery"
        },
        {
          "field": "envelope.heatRecoveryEfficiency",
          "operator": "<",
          "value": 70
        }
      ],
      "remediation": "Substituir ou melhorar o recuperador de calor para atingir eficiência >= 70%. Recuperadores de calor de fluxos cruzados típicos atingem 50-75%, enquanto recuperadores de contra-corrente atingem 80-95%. A eficiência deve ser certificada conforme EN 308 ou equivalente. Com eficiência >= 70%, o sistema VMC permite bonificação significativa no cálculo de Ni.",
      "currentValueTemplate": "Eficiência recuperação = {envelope.heatRecoveryEfficiency}%",
      "requiredValue": ">= 70% (para bonificação no cálculo REH)",
      "enabled": true,
      "tags": [
        "ventilação",
        "VMC",
        "recuperação de calor",
        "eficiência"
      ]
    },
    {
      "id": "REH-AQS-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 11.º — Sistema Solar Térmico Obrigatório (Esolar)",
      "description": "O edifício não dispõe de sistema solar térmico ou sistema equivalente para preparação de águas quentes sanitárias (AQS). O REH exige uma contribuição de energia renovável para AQS (Esolar) em edifícios novos e grandes reabilitações, preferencialmente através de colectores solares térmicos.",
      "severity": "critical",
      "conditions": [
        {
          "field": "energy.hasSolarThermal",
          "operator": "==",
          "value": false
        }
      ],
      "remediation": "Instalar sistema solar térmico para preparação de AQS. A base de cálculo é 1.0 m2 de colector por ocupante convencional. Alternativas equivalentes: bomba de calor dedicada para AQS com COP >= 2.5, sistema fotovoltaico com termoacumulador eléctrico (potência equivalente), caldeira a biomassa. A contribuição Esolar deve cumprir o mínimo regulamentar.",
      "currentValueTemplate": "Sistema solar térmico: {energy.hasSolarThermal}",
      "requiredValue": "Sistema solar térmico ou equivalente obrigatório para AQS (1.0 m2 colector/ocupante)",
      "enabled": true,
      "tags": [
        "AQS",
        "solar térmico",
        "energia renovável",
        "Esolar"
      ]
    },
    {
      "id": "REH-AQS-COLLECTOR-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 11.º — Área Mínima de Colectores Solares",
      "description": "A área de colectores solares térmicos instalada ({energy.solarCollectorArea} m2) é inferior ao mínimo regulamentar de 1.0 m2 por ocupante convencional. Para {energy.conventionalOccupants} ocupantes, a área mínima é {energy.conventionalOccupants} m2.",
      "severity": "warning",
      "conditions": [
        {
          "field": "energy.hasSolarThermal",
          "operator": "==",
          "value": true
        },
        {
          "field": "energy.solarCollectorArea",
          "operator": "<",
          "value": 1.0
        }
      ],
      "remediation": "Aumentar a área de colectores solares térmicos para cumprir o mínimo de 1.0 m2 por ocupante convencional. O número de ocupantes convencionais é definido pelo REH como: T0 = 2, T1 = 2, T2 = 3, T3 = 4, T4 = 5, Tn = n+1 ocupantes. A orientação ideal dos colectores é Sul, com inclinação entre latitude-5 e latitude+5 graus.",
      "currentValueTemplate": "Área colectores = {energy.solarCollectorArea} m2",
      "requiredValue": ">= 1.0 m2 por ocupante convencional",
      "enabled": true,
      "tags": [
        "AQS",
        "solar térmico",
        "colectores",
        "área",
        "Esolar"
      ]
    },
    {
      "id": "REH-AQS-HEATPUMP-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 11.º — Bomba de Calor AQS (COP mínimo)",
      "description": "O COP da bomba de calor para AQS ({energy.dhwHeatPumpCOP}) é inferior ao mínimo de 2.5. A bomba de calor só é considerada como alternativa válida ao solar térmico se o COP for >= 2.5 (condições de referência conforme EN 16147).",
      "severity": "warning",
      "conditions": [
        {
          "field": "energy.dhwHeatPumpCOP",
          "operator": "<",
          "value": 2.5
        },
        {
          "field": "energy.hasSolarThermal",
          "operator": "==",
          "value": false
        }
      ],
      "remediation": "Substituir a bomba de calor por um modelo com COP >= 2.5 nas condições de referência (EN 16147), ou instalar sistema solar térmico. Bombas de calor aerotérmicas com COP >= 2.5 são aceites como alternativa ao solar térmico. O COP deve ser certificado pelo fabricante nas condições nominais (A7/W55 ou A20/W55 conforme o tipo).",
      "currentValueTemplate": "COP bomba de calor AQS = {energy.dhwHeatPumpCOP}",
      "requiredValue": "COP >= 2.5 (condições de referência EN 16147)",
      "enabled": true,
      "tags": [
        "AQS",
        "bomba de calor",
        "COP",
        "alternativa solar"
      ]
    },
    {
      "id": "REH-AQS-LEGIONELLA-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 11.º — Temperatura Acumulação AQS (Anti-Legionella)",
      "description": "A temperatura de acumulação de AQS ({energy.dhwStorageTemperature} C) é inferior a 60 C. Para prevenção da Legionella, a temperatura no depósito de AQS deve ser mantida a >= 60 C. A bactéria Legionella pneumophila prolifera entre 20 C e 50 C e é eliminada acima de 60 C.",
      "severity": "critical",
      "conditions": [
        {
          "field": "energy.dhwStorageTemperature",
          "operator": "<",
          "value": 60
        }
      ],
      "remediation": "Aumentar a temperatura de acumulação de AQS para >= 60 C no depósito. O termostato do acumulador deve ser regulado para 60-65 C. Em sistemas solares térmicos, garantir que o apoio (resistência eléctrica, caldeira) mantém 60 C quando a energia solar é insuficiente. Efectuar ciclos de aquecimento a 70 C semanalmente para desinfecção térmica. A distribuição deve garantir >= 50 C no ponto mais afastado.",
      "currentValueTemplate": "Temperatura acumulação = {energy.dhwStorageTemperature} C",
      "requiredValue": ">= 60 C (prevenção Legionella)",
      "enabled": true,
      "tags": [
        "AQS",
        "Legionella",
        "temperatura",
        "acumulação",
        "saúde"
      ]
    },
    {
      "id": "REH-NIC-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 3.º — Necessidades de Aquecimento (Nic ≤ Ni)",
      "description": "As necessidades nominais de energia útil para aquecimento Nic ({energy.heatingNeeds} kWh/(m2.ano)) excedem o valor limite Ni ({energy.heatingNeedsLimit} kWh/(m2.ano)). A verificação Nic <= Ni é obrigatória para conformidade regulamentar.",
      "severity": "critical",
      "conditions": [
        {
          "field": "energy.heatingNeeds",
          "operator": "formula_gt",
          "value": "energy.heatingNeedsLimit"
        }
      ],
      "remediation": "Reduzir as necessidades de aquecimento (Nic). Medidas: reforçar o isolamento térmico da envolvente (paredes, cobertura, pavimentos, envidraçados), corrigir pontes térmicas, melhorar a estanquidade ao ar, optimizar os ganhos solares de inverno (envidraçados a sul sem sombreamento excessivo), instalar sistema de ventilação com recuperação de calor.",
      "currentValueTemplate": "Nic = {energy.heatingNeeds} kWh/(m2.ano)",
      "requiredValue": "<= Ni = {energy.heatingNeedsLimit} kWh/(m2.ano) (Nic/Ni <= 1.0)",
      "enabled": true,
      "tags": [
        "necessidades energéticas",
        "aquecimento",
        "Nic",
        "Ni",
        "verificação regulamentar"
      ]
    },
    {
      "id": "REH-NVC-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 4.º — Necessidades de Arrefecimento (Nvc ≤ Nv)",
      "description": "As necessidades nominais de energia útil para arrefecimento Nvc ({energy.coolingNeeds} kWh/(m2.ano)) excedem o valor limite Nv ({energy.coolingNeedsLimit} kWh/(m2.ano)). A verificação Nvc <= Nv é obrigatória para conformidade regulamentar.",
      "severity": "critical",
      "conditions": [
        {
          "field": "energy.coolingNeeds",
          "operator": "formula_gt",
          "value": "energy.coolingNeedsLimit"
        }
      ],
      "remediation": "Reduzir as necessidades de arrefecimento (Nvc). Medidas: instalar protecções solares exteriores eficazes (estores, portadas, palas, vegetação), utilizar vidros de controlo solar, promover ventilação natural nocturna (free-cooling), melhorar a inércia térmica do edifício, utilizar cores claras nas fachadas.",
      "currentValueTemplate": "Nvc = {energy.coolingNeeds} kWh/(m2.ano)",
      "requiredValue": "<= Nv = {energy.coolingNeedsLimit} kWh/(m2.ano) (Nvc/Nv <= 1.0)",
      "enabled": true,
      "tags": [
        "necessidades energéticas",
        "arrefecimento",
        "Nvc",
        "Nv",
        "verificação regulamentar"
      ]
    },
    {
      "id": "REH-NAQC-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 5.º — Necessidades de AQS (Nac)",
      "description": "As necessidades de energia para preparação de AQS Nac ({energy.dhwNeeds} kWh/(m2.ano)) excedem o valor de referência. O cálculo de Nac considera o consumo de referência de 40 litros/pessoa.dia a 60 C e o contributo do sistema solar (Esolar).",
      "severity": "warning",
      "conditions": [
        {
          "field": "energy.dhwNeeds",
          "operator": "formula_gt",
          "value": "energy.dhwNeedsLimit"
        }
      ],
      "remediation": "Reduzir as necessidades de energia para AQS. Medidas: aumentar a contribuição solar (mais colectores ou melhor orientação), instalar bomba de calor para AQS (COP >= 2.5), melhorar o isolamento do depósito e tubagens de distribuição, instalar torneiras eficientes (com arejadores), considerar recirculação com temporização.",
      "currentValueTemplate": "Nac = {energy.dhwNeeds} kWh/(m2.ano)",
      "requiredValue": "<= Nac_ref = {energy.dhwNeedsLimit} kWh/(m2.ano)",
      "enabled": true,
      "tags": [
        "AQS",
        "necessidades energéticas",
        "Nac",
        "solar térmico"
      ]
    },
    {
      "id": "REH-NTC-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 6.º — Necessidades Globais de Energia Primária (Ntc ≤ Nt)",
      "description": "As necessidades nominais globais de energia primária Ntc ({energy.primaryEnergyNeeds} kWhEP/(m2.ano)) excedem o valor limite Nt ({energy.primaryEnergyLimit} kWhEP/(m2.ano)). A razão Ntc/Nt determina a classe energética do edifício. Ntc/Nt <= 1.0 é necessário para obter a classe energética mínima B-.",
      "severity": "critical",
      "conditions": [
        {
          "field": "energy.primaryEnergyNeeds",
          "operator": "formula_gt",
          "value": "energy.primaryEnergyLimit"
        }
      ],
      "remediation": "Reduzir as necessidades globais de energia primária (Ntc). Medidas combinadas: melhorar a envolvente térmica (reduz Nic e Nvc), instalar sistemas de climatização eficientes (bomba de calor, caldeira de condensação), instalar sistema solar térmico para AQS, integrar fontes de energia renovável (fotovoltaico, biomassa). O Ntc combina aquecimento, arrefecimento, AQS e ventilação.",
      "currentValueTemplate": "Ntc = {energy.primaryEnergyNeeds} kWhEP/(m2.ano)",
      "requiredValue": "<= Nt = {energy.primaryEnergyLimit} kWhEP/(m2.ano) (Ntc/Nt <= 1.0 para classe B-)",
      "enabled": true,
      "tags": [
        "energia primária",
        "Ntc",
        "Nt",
        "classe energética",
        "verificação regulamentar"
      ]
    },
    {
      "id": "REH-CERT-01",
      "regulationId": "dl-118-2013-sce",
      "article": "DL 118/2013 Art. 3.º — Certificação Energética Obrigatória",
      "description": "O edifício não possui certificado energético válido. O DL 118/2013 (SCE) exige certificação energética obrigatória para edifícios novos, grandes intervenções de reabilitação, e edifícios existentes aquando da venda ou arrendamento.",
      "severity": "critical",
      "conditions": [
        {
          "field": "energy.energyClass",
          "operator": "==",
          "value": null
        }
      ],
      "remediation": "Obter certificado energético emitido por perito qualificado (PQ) da ADENE. O certificado tem validade de 10 anos e classifica o edifício de A+ (mais eficiente) a F (menos eficiente). É obrigatório para: novos edifícios (licenciamento), grandes reabilitações, venda, arrendamento, e edifícios de serviços com Ap > 1000 m2.",
      "currentValueTemplate": "Classe energética: {energy.energyClass}",
      "requiredValue": "Certificado energético obrigatório (DL 118/2013 -- SCE)",
      "enabled": true,
      "tags": [
        "certificação energética",
        "SCE",
        "ADENE",
        "classe energética"
      ]
    },
    {
      "id": "REH-CLASS-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Anexo I — Classe Energética Mínima B-",
      "description": "A classe energética do edifício ({energy.energyClass}) não atinge o mínimo regulamentar. Os edifícios novos e grandes reabilitações devem obter, no mínimo, a classe energética B- (correspondente a Ntc/Nt <= 1.0).",
      "severity": "critical",
      "conditions": [
        {
          "field": "energy.energyClass",
          "operator": "ordinal_gt",
          "value": "B-",
          "scale": [
            "A+",
            "A",
            "B",
            "B-",
            "C",
            "D",
            "E",
            "F"
          ]
        }
      ],
      "remediation": "Melhorar o desempenho energético global do edifício para atingir no mínimo a classe B-. A classe depende da razão Ntc/Nt: A+ (<=0.25), A (0.26-0.50), B (0.51-0.75), B- (0.76-1.00), C (1.01-1.50), D (1.51-2.00), E (2.01-2.50), F (>2.50). Medidas: reforçar envolvente, sistemas eficientes, energias renováveis.",
      "currentValueTemplate": "Classe energética: {energy.energyClass}",
      "requiredValue": ">= B- (Ntc/Nt <= 1.0) para edifícios novos e grandes reabilitações",
      "enabled": true,
      "tags": [
        "classe energética",
        "Ntc/Nt",
        "edifícios novos",
        "reabilitação"
      ]
    },
    {
      "id": "REH-CLASS-APLUS-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Anexo I — Escala Classe A+ (Ntc/Nt ≤ 0.25)",
      "description": "O edifício atinge a classe energética A+ ({energy.energyClass}), correspondente a Ntc/Nt <= 0.25. Este é o nível máximo de eficiência energética na escala de certificação.",
      "severity": "info",
      "conditions": [
        {
          "field": "energy.energyClassRatio",
          "operator": "<=",
          "value": 0.25
        }
      ],
      "remediation": "O edifício já atinge a classe máxima A+. Manter as boas práticas: monitorizar consumos, garantir manutenção dos sistemas de climatização e AQS, verificar periodicamente o estado do isolamento e dos sistemas de energia renovável.",
      "currentValueTemplate": "Ntc/Nt = {energy.energyClassRatio}",
      "requiredValue": "A+ corresponde a Ntc/Nt <= 0.25",
      "enabled": true,
      "tags": [
        "classe energética",
        "A+",
        "Ntc/Nt",
        "certificação"
      ]
    },
    {
      "id": "REH-CLASS-A-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Anexo I — Escala Classe A (0.26 ≤ Ntc/Nt ≤ 0.50)",
      "description": "O edifício atinge a classe energética A ({energy.energyClass}), correspondente a 0.26 <= Ntc/Nt <= 0.50. Este é um nível elevado de eficiência energética.",
      "severity": "info",
      "conditions": [
        {
          "field": "energy.energyClassRatio",
          "operator": ">",
          "value": 0.25
        },
        {
          "field": "energy.energyClassRatio",
          "operator": "<=",
          "value": 0.5
        }
      ],
      "remediation": "O edifício atinge a classe A. Para atingir A+, considerar: aumentar a produção de energia renovável (fotovoltaico), melhorar ainda mais a eficiência dos sistemas de climatização, reforçar o isolamento da envolvente. A diferença entre A e A+ é tipicamente conseguida com mais energia renovável.",
      "currentValueTemplate": "Ntc/Nt = {energy.energyClassRatio}",
      "requiredValue": "A corresponde a 0.26 <= Ntc/Nt <= 0.50",
      "enabled": true,
      "tags": [
        "classe energética",
        "A",
        "Ntc/Nt",
        "certificação"
      ]
    },
    {
      "id": "REH-NZEB-01",
      "regulationId": "dl-118-2013-sce",
      "article": "DL 118/2013 Art. 16.º — Edifício nZEB (Classe A ou Superior desde 2021)",
      "description": "O edifício novo não atinge a classe energética A ou superior, não cumprindo o requisito nZEB (nearly Zero Energy Building). Desde 31 de Dezembro de 2020, todos os edifícios novos devem ser nZEB, correspondendo a classe energética A ou A+ (Ntc/Nt <= 0.50).",
      "severity": "critical",
      "conditions": [
        {
          "field": "building.isNew",
          "operator": "==",
          "value": true
        },
        {
          "field": "energy.energyClassRatio",
          "operator": ">",
          "value": 0.5
        }
      ],
      "remediation": "Para cumprir o requisito nZEB (classe A ou A+), implementar medidas integradas: envolvente térmica de elevado desempenho (U muito baixos), eliminação de pontes térmicas, ventilação com recuperação de calor eficiente (>= 70%), sistemas de climatização de alta eficiência (bomba de calor), produção significativa de energia renovável (solar térmico + fotovoltaico), iluminação LED. O objectivo nZEB implica um balanço energético quase nulo.",
      "currentValueTemplate": "Ntc/Nt = {energy.energyClassRatio} (Classe {energy.energyClass})",
      "requiredValue": "Ntc/Nt <= 0.50 (Classe A ou A+) — obrigatório para edifícios novos desde 2021 (nZEB)",
      "enabled": true,
      "tags": [
        "nZEB",
        "classe energética",
        "edifícios novos",
        "energia quase zero",
        "DL 118/2013"
      ]
    },
    {
      "id": "REH-RENOV-01",
      "regulationId": "dl-118-2013-sce",
      "article": "DL 118/2013 Art. 16.º — Contribuição de Energias Renováveis",
      "description": "O edifício não dispõe de sistemas de aproveitamento de energias renováveis ({energy.hasRenewableSystem} = false). O DL 118/2013 exige a integração de sistemas de energias renováveis em edifícios novos.",
      "severity": "warning",
      "conditions": [
        {
          "field": "energy.hasRenewableSystem",
          "operator": "==",
          "value": false
        }
      ],
      "remediation": "Instalar sistemas de aproveitamento de energias renováveis. Opções: painéis solares térmicos (AQS), painéis fotovoltaicos (electricidade para autoconsumo), bomba de calor (aerotérmica, geotérmica), caldeira a biomassa. A combinação de solar térmico para AQS e fotovoltaico para autoconsumo é a solução mais comum em edifícios residenciais.",
      "currentValueTemplate": "Sistema renovável instalado: {energy.hasRenewableSystem}",
      "requiredValue": "Sistema de energia renovável obrigatório em edifícios novos",
      "enabled": true,
      "tags": [
        "energias renováveis",
        "solar",
        "fotovoltaico",
        "nZEB"
      ]
    },
    {
      "id": "REH-INERT-FRACA-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Secção I.6 — Inércia Térmica Fraca (It < 150 kg/m2)",
      "description": "A classe de inércia térmica do edifício é fraca (It = {energy.thermalInertiaMass} kg/m2 < 150 kg/m2). Inércia fraca penaliza significativamente o desempenho no verão (maior Nvc) e pode originar desconforto térmico por sobreaquecimento.",
      "severity": "warning",
      "conditions": [
        {
          "field": "energy.thermalInertiaMass",
          "operator": "<",
          "value": 150
        }
      ],
      "remediation": "Considerar soluções que aumentem a inércia térmica do edifício para classe média (>= 150 kg/m2) ou forte (> 400 kg/m2). Soluções: paredes interiores em alvenaria de tijolo (em vez de gesso cartonado), lajes maciças em betão (expostas sem tecto falso), pavimentos cerâmicos sobre betonilha espessa. Inércia forte reduz Nvc e melhora o conforto térmico de verão.",
      "currentValueTemplate": "It = {energy.thermalInertiaMass} kg/m2 (classe fraca)",
      "requiredValue": "Recomendado: It >= 150 kg/m2 (classe média ou forte)",
      "enabled": true,
      "tags": [
        "inércia térmica",
        "massa térmica",
        "conforto térmico",
        "classe fraca"
      ]
    },
    {
      "id": "REH-INERT-MEDIA-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Secção I.6 — Inércia Térmica Média (150 ≤ It ≤ 400 kg/m2)",
      "description": "A classe de inércia térmica do edifício é média (It = {energy.thermalInertiaMass} kg/m2, entre 150 e 400 kg/m2). Inércia média oferece bom compromisso entre conforto térmico e flexibilidade construtiva.",
      "severity": "info",
      "conditions": [
        {
          "field": "energy.thermalInertiaMass",
          "operator": ">=",
          "value": 150
        },
        {
          "field": "energy.thermalInertiaMass",
          "operator": "<=",
          "value": 400
        }
      ],
      "remediation": "A inércia média é adequada para a maioria das situações. Para melhorar ainda mais o conforto de verão, considerar aumentar a inércia para classe forte (> 400 kg/m2) através de lajes maciças expostas, paredes interiores pesadas, e pavimentos com massa significativa.",
      "currentValueTemplate": "It = {energy.thermalInertiaMass} kg/m2 (classe média)",
      "requiredValue": "Classe média: 150 <= It <= 400 kg/m2",
      "enabled": true,
      "tags": [
        "inércia térmica",
        "massa térmica",
        "classe média"
      ]
    },
    {
      "id": "REH-INERT-FORTE-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Secção I.6 — Inércia Térmica Forte (It > 400 kg/m2)",
      "description": "A classe de inércia térmica do edifício é forte (It = {energy.thermalInertiaMass} kg/m2 > 400 kg/m2). Inércia forte beneficia significativamente o comportamento térmico, reduzindo Nvc e melhorando o conforto térmico.",
      "severity": "info",
      "conditions": [
        {
          "field": "energy.thermalInertiaMass",
          "operator": ">",
          "value": 400
        }
      ],
      "remediation": "O edifício possui inércia térmica forte, o que é benéfico para o desempenho energético. Manter as massas térmicas expostas (evitar tecto falso sobre laje maciça, manter paredes interiores pesadas) para maximizar o efeito de regulação térmica.",
      "currentValueTemplate": "It = {energy.thermalInertiaMass} kg/m2 (classe forte)",
      "requiredValue": "Classe forte: It > 400 kg/m2",
      "enabled": true,
      "tags": [
        "inércia térmica",
        "massa térmica",
        "classe forte"
      ]
    },
    {
      "id": "REH-ZONE-WINTER-HDD-01",
      "regulationId": "despacho-15793f-2013",
      "article": "Despacho 15793-F/2013 — Zona Climática de Inverno I1 (GD ≤ 1300)",
      "description": "A localização ({location.municipality}) tem {location.heatingDegreeDays} graus-dia (base 18 C), o que corresponde à zona climática de inverno I1 (GD <= 1300). A zona climática atribuída ({location.climateZoneWinter}) deve ser verificada.",
      "severity": "info",
      "conditions": [
        {
          "field": "location.heatingDegreeDays",
          "operator": "<=",
          "value": 1300
        },
        {
          "field": "location.climateZoneWinter",
          "operator": "==",
          "value": "I1"
        }
      ],
      "remediation": "Zona climática I1 confirmada. Os graus-dia (GD <= 1300) correspondem a clima de inverno ameno. Os limites de U são os menos restritivos (paredes 0.50, cobertura 0.40, pavimento 0.50 W/(m2.K)). Verificar se a altitude do local está correctamente considerada no cálculo dos GD.",
      "currentValueTemplate": "GD = {location.heatingDegreeDays} C.dia (zona {location.climateZoneWinter})",
      "requiredValue": "I1: GD <= 1300 C.dia",
      "enabled": true,
      "tags": [
        "zona climática",
        "inverno",
        "I1",
        "graus-dia",
        "localização"
      ]
    },
    {
      "id": "REH-ZONE-WINTER-HDD-02",
      "regulationId": "despacho-15793f-2013",
      "article": "Despacho 15793-F/2013 — Zona Climática de Inverno I2 (1300 < GD ≤ 1800)",
      "description": "A localização ({location.municipality}) tem {location.heatingDegreeDays} graus-dia (base 18 C), o que corresponde à zona climática de inverno I2 (1300 < GD <= 1800). A zona climática atribuída ({location.climateZoneWinter}) deve ser verificada.",
      "severity": "info",
      "conditions": [
        {
          "field": "location.heatingDegreeDays",
          "operator": ">",
          "value": 1300
        },
        {
          "field": "location.heatingDegreeDays",
          "operator": "<=",
          "value": 1800
        },
        {
          "field": "location.climateZoneWinter",
          "operator": "==",
          "value": "I2"
        }
      ],
      "remediation": "Zona climática I2 confirmada. Os graus-dia (1300 < GD <= 1800) correspondem a clima de inverno moderado. Os limites de U são intermédios (paredes 0.40, cobertura 0.35, pavimento 0.40 W/(m2.K)). Verificar se a altitude e a distância ao litoral estão correctamente consideradas.",
      "currentValueTemplate": "GD = {location.heatingDegreeDays} C.dia (zona {location.climateZoneWinter})",
      "requiredValue": "I2: 1300 < GD <= 1800 C.dia",
      "enabled": true,
      "tags": [
        "zona climática",
        "inverno",
        "I2",
        "graus-dia",
        "localização"
      ]
    },
    {
      "id": "REH-ZONE-WINTER-HDD-03",
      "regulationId": "despacho-15793f-2013",
      "article": "Despacho 15793-F/2013 — Zona Climática de Inverno I3 (GD > 1800)",
      "description": "A localização ({location.municipality}) tem {location.heatingDegreeDays} graus-dia (base 18 C), o que corresponde à zona climática de inverno I3 (GD > 1800). A zona climática atribuída ({location.climateZoneWinter}) deve ser verificada.",
      "severity": "info",
      "conditions": [
        {
          "field": "location.heatingDegreeDays",
          "operator": ">",
          "value": 1800
        },
        {
          "field": "location.climateZoneWinter",
          "operator": "==",
          "value": "I3"
        }
      ],
      "remediation": "Zona climática I3 confirmada. Os graus-dia (GD > 1800) correspondem a clima de inverno severo. Os limites de U são os mais restritivos (paredes 0.35, cobertura 0.30, pavimento 0.35 W/(m2.K)). Zonas de montanha e interior norte de Portugal. Isolamento térmico reforçado é essencial.",
      "currentValueTemplate": "GD = {location.heatingDegreeDays} C.dia (zona {location.climateZoneWinter})",
      "requiredValue": "I3: GD > 1800 C.dia",
      "enabled": true,
      "tags": [
        "zona climática",
        "inverno",
        "I3",
        "graus-dia",
        "localização"
      ]
    },
    {
      "id": "REH-ZONE-WINTER-MISMATCH-01",
      "regulationId": "despacho-15793f-2013",
      "article": "Despacho 15793-F/2013 — Incoerência Zona Climática Inverno / GD",
      "description": "Os graus-dia da localização ({location.heatingDegreeDays} C.dia) não são coerentes com a zona climática de inverno atribuída ({location.climateZoneWinter}). Verificar a atribuição da zona climática conforme o Despacho 15793-F/2013, considerando o município, a altitude e a distância ao litoral.",
      "severity": "warning",
      "conditions": [
        {
          "field": "location.heatingDegreeDays",
          "operator": ">",
          "value": 1300
        },
        {
          "field": "location.climateZoneWinter",
          "operator": "==",
          "value": "I1"
        }
      ],
      "remediation": "Verificar a atribuição da zona climática de inverno. Os limiares são: I1 (GD <= 1300), I2 (1300 < GD <= 1800), I3 (GD > 1800). O valor de GD depende do município de referência, da altitude do local e da distância ao litoral, conforme as tabelas do Despacho 15793-F/2013. Corrigir a zona climática para que seja coerente com os GD calculados.",
      "currentValueTemplate": "GD = {location.heatingDegreeDays} C.dia mas zona atribuída = {location.climateZoneWinter}",
      "requiredValue": "Zona climática coerente com os graus-dia (Despacho 15793-F/2013)",
      "enabled": true,
      "tags": [
        "zona climática",
        "inverno",
        "graus-dia",
        "incoerência",
        "validação"
      ]
    },
    {
      "id": "REH-ZONE-SUMMER-01",
      "regulationId": "despacho-15793f-2013",
      "article": "Despacho 15793-F/2013 — Zona Climática de Verão por θext,v",
      "description": "A temperatura exterior média de verão ({location.summerExteriorTemp} C) determina a zona climática de verão. Limiares: V1 (theta_ext,v <= 20 C), V2 (20 < theta_ext,v <= 22 C), V3 (theta_ext,v > 22 C). A zona atribuída ({location.climateZoneSummer}) deve ser coerente com a temperatura.",
      "severity": "info",
      "conditions": [
        {
          "field": "location.summerExteriorTemp",
          "operator": "exists",
          "value": true
        }
      ],
      "remediation": "Verificar a atribuição da zona climática de verão conforme o Despacho 15793-F/2013. Os limiares são: V1 (theta_ext,v <= 20 C, clima ameno), V2 (20 < theta_ext,v <= 22 C, clima moderado), V3 (theta_ext,v > 22 C, clima quente). A temperatura de verão afecta os limites de factor solar e as necessidades de arrefecimento (Nv).",
      "currentValueTemplate": "theta_ext,v = {location.summerExteriorTemp} C (zona {location.climateZoneSummer})",
      "requiredValue": "V1: theta_ext,v <= 20 / V2: 20 < theta_ext,v <= 22 / V3: theta_ext,v > 22 C",
      "enabled": true,
      "tags": [
        "zona climática",
        "verão",
        "temperatura",
        "localização"
      ]
    },
    {
      "id": "REH-ZONE-SUMMER-MISMATCH-01",
      "regulationId": "despacho-15793f-2013",
      "article": "Despacho 15793-F/2013 — Incoerência Zona Climática Verão / θext,v",
      "description": "A temperatura exterior média de verão ({location.summerExteriorTemp} C) não é coerente com a zona climática de verão atribuída ({location.climateZoneSummer}). Verificar a atribuição conforme o Despacho 15793-F/2013.",
      "severity": "warning",
      "conditions": [
        {
          "field": "location.summerExteriorTemp",
          "operator": ">",
          "value": 22
        },
        {
          "field": "location.climateZoneSummer",
          "operator": "!=",
          "value": "V3"
        }
      ],
      "remediation": "Corrigir a zona climática de verão. Com theta_ext,v > 22 C, a zona correcta é V3 (verão quente). Os limiares são: V1 (theta_ext,v <= 20), V2 (20 < theta_ext,v <= 22), V3 (theta_ext,v > 22). A zona V3 impõe limites de factor solar mais restritivos (g <= 0.50 vs. 0.56 para V1/V2).",
      "currentValueTemplate": "theta_ext,v = {location.summerExteriorTemp} C mas zona atribuída = {location.climateZoneSummer}",
      "requiredValue": "Zona climática de verão coerente com theta_ext,v (Despacho 15793-F/2013)",
      "enabled": true,
      "tags": [
        "zona climática",
        "verão",
        "temperatura",
        "incoerência",
        "validação"
      ]
    },
    {
      "id": "REH-COND-SUPERF-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 8.º — Condensações Superficiais (fRsi ≥ 0.75)",
      "description": "O factor de temperatura superficial interior fRsi ({envelope.condensationFactor}) é inferior ao mínimo de 0.75, indicando risco de condensações superficiais. As condensações podem originar bolores, degradação dos materiais e problemas de salubridade.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.condensationFactor",
          "operator": "<",
          "value": 0.75
        }
      ],
      "remediation": "Corrigir as zonas com risco de condensações superficiais (fRsi < 0.75). Soluções: reforçar o isolamento térmico nos pontos críticos (pontes térmicas, cunhais, contorno de vãos), garantir ventilação adequada dos espaços, evitar caixilharias sem corte térmico. O isolamento pelo exterior (ETICS) é a solução mais eficaz para eliminar condensações nas pontes térmicas.",
      "currentValueTemplate": "fRsi = {envelope.condensationFactor}",
      "requiredValue": ">= 0.75 (todas as superfícies interiores)",
      "enabled": true,
      "tags": [
        "condensações",
        "fRsi",
        "pontes térmicas",
        "salubridade"
      ]
    },
    {
      "id": "REH-COND-SUPERF-PT-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 8.º — Condensações Superficiais em Pontes Térmicas",
      "description": "O factor de temperatura superficial interior na zona de ponte térmica fRsi ({envelope.condensationFactorThermalBridge}) é inferior ao mínimo de 0.75. As pontes térmicas (pilares, vigas de bordo, caixas de estore, cunhais) são os pontos mais críticos para condensações superficiais.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.condensationFactorThermalBridge",
          "operator": "<",
          "value": 0.75
        }
      ],
      "remediation": "Eliminar o risco de condensações nas pontes térmicas. Soluções prioritárias: isolamento contínuo pelo exterior (ETICS), que é a única solução que efectivamente elimina as pontes térmicas; isolamento localizado nos pilares e vigas (mínimo 2/3 da espessura do isolamento corrente); substituição de caixas de estore por modelos pré-fabricados com isolamento integrado. Verificação: fRsi = 1 - U_ponte / U_corrente × (1 - fRsi_corrente).",
      "currentValueTemplate": "fRsi (ponte térmica) = {envelope.condensationFactorThermalBridge}",
      "requiredValue": ">= 0.75 (em todos os pontos da superfície interior incluindo pontes térmicas)",
      "enabled": true,
      "tags": [
        "condensações",
        "fRsi",
        "pontes térmicas",
        "salubridade",
        "bolores"
      ]
    },
    {
      "id": "REH-COND-INT-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 8.º — Verificação de Condensações Internas (Método Glaser)",
      "description": "A verificação de condensações internas pelo método de Glaser (EN ISO 13788) indica risco de acumulação de humidade no interior do elemento construtivo ({envelope.hasInternalCondensationRisk} = true). Condensações internas podem degradar o isolamento térmico e comprometer a durabilidade da construção.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.hasInternalCondensationRisk",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Eliminar o risco de condensações internas. Soluções: colocar barreira de vapor pelo lado quente (interior) do isolamento (filme PE >= 200 microns, Sd >= 100 m), garantir que a resistência à difusão de vapor decresce do interior para o exterior, utilizar isolamento permeável ao vapor pelo exterior (lã mineral com revestimento permeável). Em coberturas, garantir ventilação do espaço de ar sob as telhas. Verificação pelo método de Glaser conforme EN ISO 13788.",
      "currentValueTemplate": "Risco de condensações internas: {envelope.hasInternalCondensationRisk}",
      "requiredValue": "Sem risco de condensações internas (verificação Glaser conforme EN ISO 13788)",
      "enabled": true,
      "tags": [
        "condensações internas",
        "Glaser",
        "barreira de vapor",
        "EN ISO 13788"
      ]
    },
    {
      "id": "REH-HEATING-EFF-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Tabela I.03 — Eficiência do Sistema de Aquecimento",
      "description": "A eficiência do sistema de aquecimento ({energy.heatingSystemEfficiency}%) é inferior ao mínimo de referência. Sistemas de aquecimento ineficientes aumentam significativamente o Ntc e penalizam a classe energética.",
      "severity": "warning",
      "conditions": [
        {
          "field": "energy.heatingSystemEfficiency",
          "operator": "<",
          "value": 85
        }
      ],
      "remediation": "Substituir o sistema de aquecimento por um mais eficiente. Opções por ordem de eficiência: bomba de calor ar-ar/ar-água (COP 3.0-5.0, equivalente a 300-500%), caldeira de condensação a gás (eficiência 95-107%), caldeira convencional a gás (eficiência 85-92%), aquecimento eléctrico por efeito de Joule (eficiência 100% mas penalizado pelo factor de conversão em energia primária). Os sistemas de referência REH variam por tipo.",
      "currentValueTemplate": "Eficiência aquecimento = {energy.heatingSystemEfficiency}%",
      "requiredValue": ">= 85% (referência para caldeira convencional) / COP >= 3.0 (bomba de calor)",
      "enabled": true,
      "tags": [
        "aquecimento",
        "eficiência",
        "sistema AVAC",
        "caldeira",
        "bomba de calor"
      ]
    },
    {
      "id": "REH-COOLING-EFF-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Tabela I.03 — Eficiência do Sistema de Arrefecimento",
      "description": "O EER/SEER do sistema de arrefecimento ({energy.coolingSystemEER}) é inferior ao mínimo de referência de 2.5. Sistemas de arrefecimento com baixo EER aumentam o consumo de energia primária para arrefecimento.",
      "severity": "warning",
      "conditions": [
        {
          "field": "energy.coolingSystemEER",
          "operator": "<",
          "value": 2.5
        }
      ],
      "remediation": "Substituir o sistema de arrefecimento por um mais eficiente. O EER (Energy Efficiency Ratio) mede a eficiência em arrefecimento. Opções: bomba de calor reversível classe A ou superior (EER/SEER >= 3.5-5.0), sistema multi-split inverter, sistema VRF. Complementar com medidas passivas: protecção solar, ventilação nocturna, inércia térmica. O REH utiliza EER de referência para o cálculo de Ntc.",
      "currentValueTemplate": "EER = {energy.coolingSystemEER}",
      "requiredValue": "EER >= 2.5 (referência REH) / recomendado >= 3.5",
      "enabled": true,
      "tags": [
        "arrefecimento",
        "EER",
        "eficiência",
        "sistema AVAC",
        "bomba de calor"
      ]
    },
    {
      "id": "REH-HEATING-HEATPUMP-COP-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Tabela I.03 — COP Mínimo Bomba de Calor Aquecimento",
      "description": "O COP da bomba de calor para aquecimento ({energy.heatingHeatPumpCOP}) é inferior a 3.0. Para que a bomba de calor seja considerada eficiente no cálculo REH, o COP deve ser >= 3.0 nas condições de referência.",
      "severity": "warning",
      "conditions": [
        {
          "field": "energy.heatingHeatPumpCOP",
          "operator": "<",
          "value": 3.0
        }
      ],
      "remediation": "Substituir a bomba de calor por um modelo com COP >= 3.0 nas condições de referência. Bombas de calor ar-água modernas atingem COP de 3.5-5.0. Bombas de calor geotérmicas atingem COP de 4.0-5.5. O COP deve ser certificado conforme EN 14511 (ar-água) ou EN 14825 (SCOP sazonal). COP mais elevado reduz significativamente o Ntc.",
      "currentValueTemplate": "COP = {energy.heatingHeatPumpCOP}",
      "requiredValue": "COP >= 3.0 (condições de referência)",
      "enabled": true,
      "tags": [
        "bomba de calor",
        "COP",
        "aquecimento",
        "eficiência"
      ]
    },
    {
      "id": "REH-PV-AUTOCONSUMO-01",
      "regulationId": "dl-118-2013-sce",
      "article": "DL 118/2013 Art. 16.º — Sistema Fotovoltaico para Autoconsumo",
      "description": "O edifício não dispõe de sistema fotovoltaico para autoconsumo ({energy.hasPVSystem} = false). A integração de produção fotovoltaica é fundamental para atingir os objectivos nZEB e melhorar a classe energética.",
      "severity": "info",
      "conditions": [
        {
          "field": "energy.hasPVSystem",
          "operator": "==",
          "value": false
        },
        {
          "field": "building.isNew",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Instalar sistema fotovoltaico para autoconsumo. Dimensionamento típico para habitação: 1.5-3.0 kWp (4-8 painéis de 400W). Orientação ideal: Sul, inclinação 30-35 graus. A produção fotovoltaica em autoconsumo reduz directamente o Ntc (factor de conversão Fpu = 2.5 para electricidade da rede vs. 0 para autoprodução renovável). Contribui significativamente para atingir classe A/A+.",
      "currentValueTemplate": "Sistema fotovoltaico: {energy.hasPVSystem}",
      "requiredValue": "Recomendado para edifícios novos (contribui para nZEB)",
      "enabled": true,
      "tags": [
        "fotovoltaico",
        "autoconsumo",
        "energia renovável",
        "nZEB"
      ]
    },
    {
      "id": "REH-FPU-ELEC-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Tabela 01 — Factor de Conversão Energia Primária (Electricidade)",
      "description": "O factor de conversão de energia primária utilizado para a electricidade da rede ({energy.primaryEnergyFactorElectricity}) difere do valor regulamentar de 2.5 kWhEP/kWh. O factor Fpu = 2.5 é obrigatório para converter o consumo eléctrico da rede em energia primária no cálculo de Ntc.",
      "severity": "warning",
      "conditions": [
        {
          "field": "energy.primaryEnergyFactorElectricity",
          "operator": "!=",
          "value": 2.5
        }
      ],
      "remediation": "Corrigir o factor de conversão de energia primária para electricidade da rede. O valor regulamentar é Fpu = 2.5 kWhEP/kWh (Portaria 349-B/2013). Este factor penaliza o aquecimento eléctrico por efeito de Joule (resistências). Para gás natural, Fpu = 1.0 kWhEP/kWh. Para biomassa sólida (pellets, lenha), Fpu = 1.0. Para energia renovável em autoconsumo, Fpu = 0.",
      "currentValueTemplate": "Fpu (electricidade) = {energy.primaryEnergyFactorElectricity} kWhEP/kWh",
      "requiredValue": "Fpu = 2.5 kWhEP/kWh (electricidade da rede, Portaria 349-B/2013)",
      "enabled": true,
      "tags": [
        "energia primária",
        "factor conversão",
        "Fpu",
        "electricidade"
      ]
    },
    {
      "id": "REH-AIRTIGHT-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 10.º — Estanquidade ao Ar (Ensaio Blower Door)",
      "description": "O resultado do ensaio de permeabilidade ao ar (n50 = {envelope.airPermeabilityN50} h-1) excede o valor de referência de 4.0 h-1 a 50 Pa. Embora o REH não imponha um limite obrigatório de n50, valores elevados indicam infiltrações excessivas que aumentam as perdas térmicas.",
      "severity": "info",
      "conditions": [
        {
          "field": "envelope.airPermeabilityN50",
          "operator": ">",
          "value": 4.0
        }
      ],
      "remediation": "Melhorar a estanquidade ao ar da envolvente. Pontos críticos: caixilharias (vedação perimetral), caixas de estore (vedação superior e inferior), passagem de tubagens pela envolvente, junta fachada-cobertura. Objectivo: n50 <= 4.0 h-1 (boa prática), n50 <= 1.0 h-1 (Passive House). A melhoria da estanquidade permite bonificação no cálculo REH do RPH (quando comprovada por ensaio Blower Door conforme EN 13829).",
      "currentValueTemplate": "n50 = {envelope.airPermeabilityN50} h-1 (a 50 Pa)",
      "requiredValue": "Recomendado n50 <= 4.0 h-1 (referência); <= 1.0 h-1 (excelente)",
      "enabled": true,
      "tags": [
        "estanquidade",
        "permeabilidade ao ar",
        "n50",
        "blower door",
        "infiltrações"
      ]
    },
    {
      "id": "REH-BIOMASS-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 11.º — Caldeira a Biomassa como Alternativa Solar",
      "description": "O edifício utiliza caldeira a biomassa ({energy.hasBiomassBoiler} = true) como fonte de energia renovável. A caldeira a biomassa (pellets, lenha) é aceite como alternativa ao solar térmico para AQS e aquecimento, com factor de energia primária Fpu = 1.0 kWhEP/kWh.",
      "severity": "info",
      "conditions": [
        {
          "field": "energy.hasBiomassBoiler",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "A caldeira a biomassa é uma solução válida de energia renovável. Verificar: eficiência mínima da caldeira (>= 85% para pellets, >= 75% para lenha), conformidade com norma EN 303-5 (classe 5 para emissões), armazenamento adequado de combustível, chaminé com altura e secção conforme regulamentação. O factor Fpu = 1.0 beneficia significativamente o cálculo de Ntc.",
      "currentValueTemplate": "Caldeira biomassa: {energy.hasBiomassBoiler}",
      "requiredValue": "Caldeira biomassa aceite como energia renovável (Fpu = 1.0 kWhEP/kWh)",
      "enabled": true,
      "tags": [
        "biomassa",
        "caldeira",
        "pellets",
        "energia renovável",
        "alternativa solar"
      ]
    },
    {
      "id": "REH-REHAB-UMAX-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 2.º n.º 4 — Requisitos para Grandes Reabilitações",
      "description": "O edifício em grande reabilitação deve cumprir os requisitos máximos de U-value do REH nos elementos intervencionados. Para grandes reabilitações (custo > 25% do valor do edifício), os elementos construtivos intervencionados devem cumprir os Umáx como se fossem novos.",
      "severity": "warning",
      "conditions": [
        {
          "field": "building.isRehabilitation",
          "operator": "==",
          "value": true
        },
        {
          "field": "building.isMajorRehabilitation",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Em grandes reabilitações, os elementos intervencionados devem cumprir os Umáx do REH para edifícios novos. Elementos não intervencionados podem manter os valores existentes. Verificar: paredes (se reabilitadas, Umáx por zona), cobertura (se reabilitada, Umáx por zona), envidraçados (se substituídos, Umáx e factor solar). A classe energética mínima é B- (Ntc/Nt <= 1.0).",
      "currentValueTemplate": "Grande reabilitação: {building.isMajorRehabilitation}",
      "requiredValue": "Elementos intervencionados: Umáx como edifício novo; Classe >= B-",
      "enabled": true,
      "tags": [
        "reabilitação",
        "grande intervenção",
        "Umáx",
        "requisitos"
      ]
    },
    {
      "id": "REH-WINDOW-AREA-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 7.º — Rácio Área Envidraçada / Área Pavimento",
      "description": "O rácio entre a área total de envidraçados e a área de pavimento ({computed.windowToFloorRatio}%) excede 20%. Quando Aenv/Ap > 20%, os requisitos de factor solar tornam-se mais exigentes e a verificação g⊥,vi × Fo × Ff <= g_max é obrigatória.",
      "severity": "warning",
      "conditions": [
        {
          "field": "computed.windowToFloorRatio",
          "operator": ">",
          "value": 0.2
        }
      ],
      "remediation": "O rácio Aenv/Ap > 20% implica verificação obrigatória do factor solar ponderado. Soluções: reduzir a área de envidraçados (especialmente a Oeste e Este), instalar protecções solares exteriores eficazes, utilizar vidros de controlo solar com g⊥ baixo. A verificação deve considerar os factores de sombreamento (Fo = obstruções, Ff = elementos de fachada).",
      "currentValueTemplate": "Aenv/Ap = {computed.windowToFloorRatio}%",
      "requiredValue": "Se Aenv/Ap > 20%: verificação obrigatória g⊥,vi × Fo × Ff <= g_max",
      "enabled": true,
      "tags": [
        "envidraçados",
        "área",
        "rácio",
        "factor solar",
        "sobreaquecimento"
      ]
    },
    {
      "id": "REH-WALL-UREF-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Tabela I.01 — U de Referência Paredes (para cálculo Ni)",
      "description": "O coeficiente U das paredes exteriores ({envelope.externalWallUValue} W/(m2.K)) excede o valor de referência utilizado no cálculo de Ni. Embora cumpra o Umáx, valores acima do Uref penalizam o cálculo das necessidades de aquecimento.",
      "severity": "info",
      "conditions": [
        {
          "field": "envelope.externalWallUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "ref_u_walls",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Para optimizar o cálculo de Ni (necessidades de aquecimento), o U das paredes deve aproximar-se do valor de referência (Uref). Valores de referência: I1: 0.40, I2: 0.35, I3: 0.30 W/(m2.K). Estes valores são inferiores ao Umáx e representam o desempenho de referência para a classe B-.",
      "currentValueTemplate": "U paredes = {envelope.externalWallUValue} W/(m2.K)",
      "requiredValue": "Uref (referência para Ni): I1 ≤ 0.40 / I2 ≤ 0.35 / I3 ≤ 0.30 W/(m2.K)",
      "enabled": true,
      "tags": [
        "paredes",
        "valor-U",
        "referência",
        "Ni",
        "optimização"
      ]
    },
    {
      "id": "REH-ROOF-UREF-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Tabela I.01 — U de Referência Cobertura (para cálculo Ni)",
      "description": "O coeficiente U da cobertura ({envelope.roofUValue} W/(m2.K)) excede o valor de referência utilizado no cálculo de Ni. Valores acima do Uref penalizam o cálculo das necessidades de aquecimento.",
      "severity": "info",
      "conditions": [
        {
          "field": "envelope.roofUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "ref_u_roofs",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Para optimizar o cálculo de Ni, o U da cobertura deve aproximar-se do valor de referência (Uref). Valores de referência: I1: 0.35, I2: 0.30, I3: 0.25 W/(m2.K). A cobertura é o elemento onde o reforço de isolamento é tipicamente mais custo-eficaz.",
      "currentValueTemplate": "U cobertura = {envelope.roofUValue} W/(m2.K)",
      "requiredValue": "Uref (referência para Ni): I1 ≤ 0.35 / I2 ≤ 0.30 / I3 ≤ 0.25 W/(m2.K)",
      "enabled": true,
      "tags": [
        "cobertura",
        "valor-U",
        "referência",
        "Ni",
        "optimização"
      ]
    },
    {
      "id": "REH-WINDOW-UREF-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Tabela I.01 — U de Referência Envidraçados (para cálculo Ni)",
      "description": "O coeficiente U dos envidraçados ({envelope.windowUValue} W/(m2.K)) excede o valor de referência utilizado no cálculo de Ni. Valores acima do Uref penalizam as necessidades de aquecimento.",
      "severity": "info",
      "conditions": [
        {
          "field": "envelope.windowUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "ref_u_windows",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Para optimizar o cálculo de Ni, o U dos envidraçados deve aproximar-se do valor de referência. Valores de referência: I1: 2.40, I2: 2.20, I3: 2.00 W/(m2.K). Soluções: vidro duplo com caixa-de-ar >= 16mm, vidro de baixa emissividade, caixilharia com corte térmico, vidro triplo para I3.",
      "currentValueTemplate": "U envidraçados = {envelope.windowUValue} W/(m2.K)",
      "requiredValue": "Uref (referência para Ni): I1 ≤ 2.40 / I2 ≤ 2.20 / I3 ≤ 2.00 W/(m2.K)",
      "enabled": true,
      "tags": [
        "envidraçados",
        "valor-U",
        "referência",
        "Ni",
        "optimização"
      ]
    },
    {
      "id": "REH-MOISTURE-01",
      "regulationId": "en-iso-13788",
      "article": "EN ISO 13788 — Condensação Superficial em Pontes Térmicas",
      "description": "O fator de temperatura superficial (fRsi) na ponte térmica mais desfavorável ({envelope.fRsiMin}) é inferior ao mínimo de 0.75, indicando risco de condensação superficial e bolor.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.fRsiMin",
          "operator": "<",
          "value": 0.75
        }
      ],
      "currentValueTemplate": "fRsi mínimo = {envelope.fRsiMin}",
      "requiredValue": "fRsi ≥ 0.75 em todas as pontes térmicas (EN ISO 13788)",
      "remediation": "Corrigir a ponte térmica para aumentar o fRsi acima de 0.75: (1) continuidade do isolamento (ETICS); (2) isolamento pelo interior com corte na laje; (3) em pilares/vigas de betão em fachada, garantir pelo menos 40mm de isolamento na face exterior.",
      "enabled": true,
      "tags": [
        "condensação",
        "fRsi",
        "bolor",
        "ponte térmica"
      ]
    },
    {
      "id": "REH-MOISTURE-02",
      "regulationId": "en-iso-13788",
      "article": "EN ISO 13788 — Condensação Intersticial (Método de Glaser)",
      "description": "A verificação pelo método de Glaser indica risco de condensação intersticial no interior da parede/cobertura.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.glaserCondensationRisk",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Risco de condensação intersticial identificado",
      "requiredValue": "Condensação acumulada ≤ evaporação anual; sem acumulação a longo prazo",
      "remediation": "Eliminar o risco de condensação intersticial: (1) colocar barreira pára-vapor no lado quente do isolamento (Sd ≥ 10m); (2) usar isolamento impermeável ao vapor (XPS, PUR); (3) em coberturas, garantir ventilação do espaço entre isolamento e revestimento exterior.",
      "enabled": true,
      "tags": [
        "condensação intersticial",
        "Glaser",
        "barreira pára-vapor"
      ]
    },
    {
      "id": "REH-MOISTURE-03",
      "regulationId": "en-iso-13788",
      "article": "EN ISO 13788 — Humidade Relativa Interior Excessiva",
      "description": "A humidade relativa interior média ({thermal.avgRelativeHumidity}%) excede 60% de forma prolongada, favorecendo o desenvolvimento de bolores.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.avgRelativeHumidity",
          "operator": ">",
          "value": 60
        }
      ],
      "currentValueTemplate": "HR interior média: {thermal.avgRelativeHumidity}%",
      "requiredValue": "HR ≤ 60% em período prolongado; ideal: 40-60%",
      "remediation": "Reduzir a humidade relativa interior: (1) aumentar a ventilação (mínimo 0.4 Rph); (2) instalar extração mecânica em cozinha e IS; (3) eliminar pontes térmicas que causam condensação; (4) verificar infiltrações de água pela cobertura ou fachada.",
      "enabled": true,
      "tags": [
        "humidade",
        "bolor",
        "ventilação",
        "HR"
      ]
    },
    {
      "id": "REH-MOISTURE-04",
      "regulationId": "en-iso-13788",
      "article": "EN ISO 13788 — Barreira Pára-vapor em Coberturas",
      "description": "A cobertura com isolamento permeável ao vapor não dispõe de barreira pára-vapor no lado interior.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.roofVapourBarrier",
          "operator": "==",
          "value": false
        },
        {
          "field": "envelope.roofInsulationPermeableToVapour",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Cobertura sem barreira pára-vapor",
      "requiredValue": "Barreira pára-vapor (Sd ≥ 10 m) no lado quente do isolamento em coberturas",
      "remediation": "Instalar barreira pára-vapor (filme PE, folha de alumínio ou membrana com Sd ≥ 10m) no lado interior do isolamento da cobertura. Garantir continuidade da barreira, selando juntas e perfurações.",
      "enabled": true,
      "tags": [
        "barreira pára-vapor",
        "cobertura",
        "condensação"
      ]
    },
    {
      "id": "REH-MOISTURE-05",
      "regulationId": "en-iso-13788",
      "article": "EN ISO 13788 — Evaporação Insuficiente de Condensação Sazonal",
      "description": "A condensação sazonal acumulada no inverno não evapora completamente no verão.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.seasonalEvaporationSufficient",
          "operator": "==",
          "value": false
        }
      ],
      "currentValueTemplate": "Evaporação sazonal insuficiente",
      "requiredValue": "Evaporação ≥ condensação anual (balanço anual positivo obrigatório)",
      "remediation": "Soluções: (1) adicionar barreira pára-vapor; (2) alterar a sequência de camadas (isolamento pelo exterior); (3) prever ventilação do espaço entre camadas; (4) usar isolamento impermeável ao vapor.",
      "enabled": true,
      "tags": [
        "evaporação",
        "condensação sazonal",
        "balanço anual"
      ]
    },
    {
      "id": "REH-COMFORT-01",
      "regulationId": "en-16798-1",
      "article": "EN 16798-1 — Temperatura Operativa de Aquecimento",
      "description": "A temperatura operativa de aquecimento ({thermal.heatingSetpoint}°C) está fora do intervalo recomendado.",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.heatingSetpoint",
          "operator": "not_in_range",
          "value": [
            20,
            22
          ]
        }
      ],
      "currentValueTemplate": "Setpoint aquecimento: {thermal.heatingSetpoint}°C",
      "requiredValue": "20-22°C para categoria II; 21-23°C para categoria I",
      "remediation": "Ajustar o setpoint de aquecimento para 20-22°C (categoria II EN 16798-1).",
      "enabled": true,
      "tags": [
        "conforto",
        "temperatura",
        "aquecimento",
        "setpoint"
      ]
    },
    {
      "id": "REH-COMFORT-02",
      "regulationId": "en-16798-1",
      "article": "EN 16798-1 — Temperatura Operativa de Arrefecimento",
      "description": "A temperatura operativa de arrefecimento ({thermal.coolingSetpoint}°C) está fora do intervalo recomendado.",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.coolingSetpoint",
          "operator": "not_in_range",
          "value": [
            24,
            26
          ]
        }
      ],
      "currentValueTemplate": "Setpoint arrefecimento: {thermal.coolingSetpoint}°C",
      "requiredValue": "24-26°C para categoria II; 23-25°C para categoria I",
      "remediation": "Ajustar o setpoint de arrefecimento para 24-26°C (categoria II).",
      "enabled": true,
      "tags": [
        "conforto",
        "temperatura",
        "arrefecimento",
        "setpoint"
      ]
    },
    {
      "id": "REH-COMFORT-03",
      "regulationId": "en-16798-1",
      "article": "EN 16798-1 — Assimetria de Temperatura Radiante",
      "description": "A assimetria de temperatura radiante junto à fachada excede os limites de conforto.",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.radiantAsymmetry",
          "operator": ">",
          "value": 10
        }
      ],
      "currentValueTemplate": "Assimetria radiante: {thermal.radiantAsymmetry}°C",
      "requiredValue": "≤ 10°C para parede fria; ≤ 5°C para teto quente",
      "remediation": "Reduzir a assimetria radiante: melhorar isolamento das paredes/fachadas, substituir envidraçados, instalar cortinas interiores.",
      "enabled": true,
      "tags": [
        "conforto",
        "assimetria",
        "radiante",
        "fachada"
      ]
    },
    {
      "id": "REH-COMFORT-04",
      "regulationId": "en-16798-1",
      "article": "EN 16798-1 — Gradiente Vertical de Temperatura",
      "description": "O gradiente vertical de temperatura entre tornozelo e cabeça excede 3°C.",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.verticalTempGradient",
          "operator": ">",
          "value": 3
        }
      ],
      "currentValueTemplate": "Gradiente vertical: {thermal.verticalTempGradient}°C",
      "requiredValue": "≤ 3°C entre 0.1 m e 1.1 m de altura",
      "remediation": "Usar piso radiante, melhorar isolamento do pavimento, distribuir aquecimento de forma mais uniforme.",
      "enabled": true,
      "tags": [
        "conforto",
        "gradiente",
        "temperatura",
        "vertical"
      ]
    },
    {
      "id": "REH-COMFORT-05",
      "regulationId": "en-16798-1",
      "article": "EN 16798-1 — Temperatura do Pavimento",
      "description": "A temperatura do pavimento ({thermal.floorTemperature}°C) está fora do intervalo de conforto.",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.floorTemperature",
          "operator": "not_in_range",
          "value": [
            19,
            29
          ]
        }
      ],
      "currentValueTemplate": "Temperatura do pavimento: {thermal.floorTemperature}°C",
      "requiredValue": "19-29°C; com piso radiante: máx. 29°C (35°C em IS)",
      "remediation": "Isolar o pavimento sobre espaços não aquecidos. Em piso radiante, limitar a temperatura da água de retorno.",
      "enabled": true,
      "tags": [
        "conforto",
        "pavimento",
        "temperatura",
        "piso radiante"
      ]
    },
    {
      "id": "REH-NZEB-02",
      "regulationId": "dl-101d-2020-nzeb",
      "article": "DL 101-D/2020 — Envolvente Reforçada NZEB",
      "description": "O edifício novo não cumpre os requisitos de envolvente reforçada NZEB.",
      "severity": "critical",
      "conditions": [
        {
          "field": "thermal.nzebEnvelopeCompliant",
          "operator": "==",
          "value": false
        },
        {
          "field": "isRehabilitation",
          "operator": "==",
          "value": false
        }
      ],
      "currentValueTemplate": "Envolvente não cumpre requisitos NZEB",
      "requiredValue": "U paredes ≤ 0.35, coberturas ≤ 0.30, pavimentos ≤ 0.35, Uw ≤ 2.0 W/m²·K",
      "remediation": "Usar ETICS ≥ 80mm, cobertura com isolamento ≥ 100mm, vidro duplo low-e com caixilharia de corte térmico.",
      "enabled": true,
      "tags": [
        "NZEB",
        "envolvente",
        "reforçada",
        "U valores"
      ]
    },
    {
      "id": "REH-NZEB-03",
      "regulationId": "dl-101d-2020-nzeb",
      "article": "DL 101-D/2020 — Estanquidade ao Ar (Blower Door)",
      "description": "O resultado do teste blower door ({thermal.n50Value} Rph @ 50 Pa) excede o limite NZEB.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.n50Value",
          "operator": ">",
          "value": 3.0
        },
        {
          "field": "isRehabilitation",
          "operator": "==",
          "value": false
        }
      ],
      "currentValueTemplate": "n50 = {thermal.n50Value} Rph",
      "requiredValue": "n50 ≤ 3.0 Rph (NZEB); idealmente ≤ 1.0",
      "remediation": "Melhorar estanquidade: fitas de vedação, selagem de passagens, membrana contínua, caixas de estore estanques.",
      "enabled": true,
      "tags": [
        "estanquidade",
        "blower door",
        "n50",
        "NZEB"
      ]
    },
    {
      "id": "REH-NZEB-04",
      "regulationId": "dl-101d-2020-nzeb",
      "article": "DL 101-D/2020 — Edifícios Públicos NZEB (desde 2018)",
      "description": "O edifício público novo não cumpre os requisitos NZEB obrigatórios desde 2018.",
      "severity": "critical",
      "conditions": [
        {
          "field": "building.isPublicBuilding",
          "operator": "==",
          "value": true
        },
        {
          "field": "thermal.nzebCompliant",
          "operator": "==",
          "value": false
        },
        {
          "field": "isRehabilitation",
          "operator": "==",
          "value": false
        }
      ],
      "currentValueTemplate": "Edifício público não NZEB",
      "requiredValue": "NZEB obrigatório para edifícios públicos novos desde 31/12/2018",
      "remediation": "Garantir: classe A, envolvente reforçada, renováveis ≥ 50%, sistemas de alta eficiência.",
      "enabled": true,
      "tags": [
        "NZEB",
        "público",
        "obrigatório",
        "2018"
      ]
    },
    {
      "id": "REH-NZEB-05",
      "regulationId": "dl-101d-2020-nzeb",
      "article": "DL 101-D/2020 — Contribuição Renovável Local NZEB",
      "description": "O edifício NZEB não possui produção de energia renovável local suficiente.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.nzebLocalRenewableInsufficient",
          "operator": "==",
          "value": true
        },
        {
          "field": "isRehabilitation",
          "operator": "==",
          "value": false
        }
      ],
      "currentValueTemplate": "Contribuição renovável local insuficiente",
      "requiredValue": "≥ 50% de energia renovável produzida no local",
      "remediation": "Aumentar produção renovável local: solar térmico para AQS (≥ 50%), PV autoconsumo, bomba de calor com SPF > 2.5.",
      "enabled": true,
      "tags": [
        "NZEB",
        "renovável",
        "local",
        "PV",
        "solar"
      ]
    },
    {
      "id": "REH-CLIMATE-01",
      "regulationId": "despacho-15793f-2013",
      "article": "Despacho 15793-F — Zona Climática de Inverno por GD",
      "description": "A zona climática de inverno não está corretamente definida.",
      "severity": "info",
      "conditions": [
        {
          "field": "location.climateZoneWinterDefined",
          "operator": "==",
          "value": false
        }
      ],
      "currentValueTemplate": "Zona climática de inverno não definida",
      "requiredValue": "I1: GD ≤ 1300; I2: 1300 < GD ≤ 1800; I3: GD > 1800",
      "remediation": "Definir zona climática de inverno por graus-dia (base 20°C) do local: I1 (≤ 1300 GD: litoral sul), I2 (1300-1800 GD), I3 (> 1800 GD: interior norte).",
      "enabled": true,
      "tags": [
        "zona climática",
        "inverno",
        "graus-dia"
      ]
    },
    {
      "id": "REH-CLIMATE-02",
      "regulationId": "despacho-15793f-2013",
      "article": "Despacho 15793-F — Zona Climática de Verão por θext,v",
      "description": "A zona climática de verão não está corretamente definida.",
      "severity": "info",
      "conditions": [
        {
          "field": "location.climateZoneSummerDefined",
          "operator": "==",
          "value": false
        }
      ],
      "currentValueTemplate": "Zona climática de verão não definida",
      "requiredValue": "V1: θext,v ≤ 20°C; V2: 20 < θext,v ≤ 22°C; V3: θext,v > 22°C",
      "remediation": "Definir zona climática de verão por temperatura exterior média: V1 (≤ 20°C), V2 (20-22°C), V3 (> 22°C).",
      "enabled": true,
      "tags": [
        "zona climática",
        "verão",
        "temperatura"
      ]
    },
    {
      "id": "REH-RETROFIT-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Elementos Intervencionados na Reabilitação",
      "description": "Na reabilitação, os elementos da envolvente intervencionados não cumprem os Umáx de edifícios novos.",
      "severity": "critical",
      "conditions": [
        {
          "field": "thermal.retrofitElementsMeetNewRequirements",
          "operator": "==",
          "value": false
        },
        {
          "field": "isRehabilitation",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Elementos reabilitados não cumprem Umáx",
      "requiredValue": "Elementos intervencionados: Umáx como edifício novo",
      "remediation": "Elementos da envolvente intervencionados devem cumprir os Umáx vigentes para edifícios novos na zona climática. Elementos não intervencionados mantêm valores existentes.",
      "enabled": true,
      "tags": [
        "reabilitação",
        "Umáx",
        "elementos intervencionados"
      ]
    },
    {
      "id": "REH-RETROFIT-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Classe Mínima B- após Grande Reabilitação",
      "description": "O edifício após grande reabilitação não atinge classe energética B-.",
      "severity": "critical",
      "conditions": [
        {
          "field": "thermal.postRehabClassAtLeastBminus",
          "operator": "==",
          "value": false
        },
        {
          "field": "isRehabilitation",
          "operator": "==",
          "value": true
        },
        {
          "field": "building.isMajorRehabilitation",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Classe após reabilitação inferior a B-",
      "requiredValue": "Classe ≥ B- (Ntc/Nt ≤ 1.00)",
      "remediation": "Isolar paredes pelo exterior (ETICS ≥ 60mm), cobertura, substituir envidraçados, instalar sistema eficiente (bomba de calor) e solar térmico.",
      "enabled": true,
      "tags": [
        "reabilitação",
        "classe B-",
        "grande intervenção"
      ]
    },
    {
      "id": "REH-RETROFIT-03",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Envidraçados Substituídos na Reabilitação",
      "description": "Os envidraçados substituídos na reabilitação não cumprem Uw máximo.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.replacedWindowsUwCompliant",
          "operator": "==",
          "value": false
        },
        {
          "field": "isRehabilitation",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Envidraçados substituídos com Uw excessivo",
      "requiredValue": "Uw ≤ Umáx: I1=2.80, I2=2.40, I3=2.20 W/m²·K",
      "remediation": "Instalar vidro duplo (mínimo 4/12/4) com caixilharia de corte térmico. Para zona I3, vidro duplo low-e (Uw ≈ 1.5-1.8).",
      "enabled": true,
      "tags": [
        "reabilitação",
        "envidraçados",
        "Uw",
        "substituição"
      ]
    },
    {
      "id": "REH-SHADE-01",
      "regulationId": "portaria-379a-2015",
      "article": "Portaria 379-A/2015 — Sombreamento de Claraboias",
      "description": "As claraboias não dispõem de dispositivo de sombreamento.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.skylightShadingDevice",
          "operator": "==",
          "value": false
        }
      ],
      "currentValueTemplate": "Claraboias sem sombreamento",
      "requiredValue": "Fator solar com proteção ≤ 0.25",
      "remediation": "Instalar sombreamento: estores exteriores, vidro de controlo solar (g ≤ 0.25), ou película de proteção solar.",
      "enabled": true,
      "tags": [
        "claraboia",
        "sombreamento",
        "fator solar"
      ]
    },
    {
      "id": "REH-SHADE-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Obstruções de Horizonte (Fo)",
      "description": "O fator de obstrução de horizonte não foi considerado no cálculo dos ganhos solares.",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.horizonObstructionConsidered",
          "operator": "==",
          "value": false
        }
      ],
      "currentValueTemplate": "Obstruções de horizonte não consideradas",
      "requiredValue": "Fo determinado por levantamento dos ângulos de obstrução",
      "remediation": "Levantar ângulos de obstrução do horizonte por orientação de fachada. Ângulos > 20° reduzem significativamente os ganhos solares de inverno.",
      "enabled": true,
      "tags": [
        "obstrução",
        "horizonte",
        "Fo",
        "ganhos solares"
      ]
    },
    {
      "id": "REH-VENTREQ-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Taxa de Ventilação Mínima",
      "description": "A taxa de ventilação ({thermal.ventilationRph} Rph) é inferior ao mínimo de 0.4 Rph.",
      "severity": "critical",
      "conditions": [
        {
          "field": "thermal.ventilationRph",
          "operator": "<",
          "value": 0.4
        }
      ],
      "currentValueTemplate": "Rph = {thermal.ventilationRph}",
      "requiredValue": "≥ 0.4 Rph (REH)",
      "remediation": "Garantir 0.4 Rph: grelhas auto-reguláveis + condutas de extração, ou ventilação mecânica com recuperação de calor.",
      "enabled": true,
      "tags": [
        "ventilação",
        "Rph",
        "mínimo"
      ]
    },
    {
      "id": "REH-VENTREQ-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Recuperação de Calor na Ventilação Mecânica",
      "description": "A ventilação mecânica não dispõe de recuperador de calor com eficiência ≥ 70%.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.mechVentHeatRecovery",
          "operator": "<",
          "value": 70
        },
        {
          "field": "thermal.hasMechanicalVentilation",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Eficiência: {thermal.mechVentHeatRecovery}%",
      "requiredValue": "≥ 70% de eficiência sensível para crédito no cálculo de Nic",
      "remediation": "Instalar recuperador com eficiência ≥ 70%: placas cruzadas (50-70%), rotativo (70-85%), ou contra-corrente (80-90%).",
      "enabled": true,
      "tags": [
        "ventilação",
        "recuperação de calor",
        "mecânica"
      ]
    },
    {
      "id": "REH-VENTREQ-03",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Extração em Cozinhas e IS",
      "description": "A cozinha e IS não dispõem de extração conforme NP 1037-1.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.kitchenBathroomExtractionCompliant",
          "operator": "==",
          "value": false
        }
      ],
      "currentValueTemplate": "Extração não conforme",
      "requiredValue": "Cozinha ≥ 60 m³/h; IS ≥ 45 m³/h; WC ≥ 30 m³/h",
      "remediation": "Instalar hotte na cozinha (≥ 60 m³/h) e extração nas IS (≥ 45 m³/h). Garantir admissão de ar nos compartimentos principais.",
      "enabled": true,
      "tags": [
        "ventilação",
        "extração",
        "cozinha",
        "IS"
      ]
    },
    {
      "id": "REH-PIPEINS-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Isolamento de Tubagens de AQS",
      "description": "As tubagens de AQS não possuem isolamento térmico adequado.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.aqsPipeInsulationCompliant",
          "operator": "==",
          "value": false
        }
      ],
      "currentValueTemplate": "Tubagens AQS sem isolamento adequado",
      "requiredValue": "Espessura ≥ diâmetro do tubo (min. 20mm); λ ≤ 0.040 W/m·K",
      "remediation": "Isolar tubagens com manga de espuma elastomérica: espessura ≥ diâmetro do tubo. Isolar válvulas, tês e curvas.",
      "enabled": true,
      "tags": [
        "tubagens",
        "AQS",
        "isolamento"
      ]
    },
    {
      "id": "REH-PIPEINS-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Isolamento de Tubagens de Aquecimento Central",
      "description": "As tubagens de aquecimento não estão isoladas em zonas não aquecidas.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.heatingPipeInsulationInUnheated",
          "operator": "==",
          "value": false
        }
      ],
      "currentValueTemplate": "Tubagens de aquecimento sem isolamento em zonas não aquecidas",
      "requiredValue": "Isolamento obrigatório em zonas não aquecidas",
      "remediation": "Isolar tubagens em cave, garagem, desvão: manga elastomérica ou lã mineral (espessura ≥ diâmetro tubo, mín. 20mm).",
      "enabled": true,
      "tags": [
        "tubagens",
        "aquecimento",
        "isolamento"
      ]
    },
    {
      "id": "REH-COBISO-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Tabela I.01 — Espessura Mínima de Isolamento em Cobertura Plana",
      "description": "A espessura de isolamento térmico da cobertura plana ({envelope.flatRoofInsulationThickness} mm) é insuficiente para a zona climática {location.climateZoneWinter}.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.flatRoofInsulationThickness",
          "operator": "<",
          "value": 80
        },
        {
          "field": "envelope.roofType",
          "operator": "==",
          "value": "flat"
        }
      ],
      "currentValueTemplate": "Espessura isolamento cobertura plana: {envelope.flatRoofInsulationThickness} mm",
      "requiredValue": "≥ 80 mm (EPS/XPS λ ≤ 0.036 W/m·K) para cumprir Umáx coberturas",
      "remediation": "Aplicar isolamento térmico na cobertura plana com espessura mínima de 80 mm (EPS, XPS ou PIR). Em zonas I2/I3 poderá ser necessário 100-120 mm para cumprir U ≤ 0.35/0.30 W/(m².K).",
      "enabled": true,
      "tags": [
        "cobertura plana",
        "isolamento",
        "espessura",
        "envolvente exterior"
      ]
    },
    {
      "id": "REH-COBISO-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 — Isolamento de Cobertura Inclinada",
      "description": "A espessura de isolamento térmico da cobertura inclinada ({envelope.pitchedRoofInsulationThickness} mm) é insuficiente para garantir o cumprimento do Umáx regulamentar.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.pitchedRoofInsulationThickness",
          "operator": "<",
          "value": 80
        },
        {
          "field": "envelope.roofType",
          "operator": "==",
          "value": "pitched"
        }
      ],
      "currentValueTemplate": "Espessura isolamento cobertura inclinada: {envelope.pitchedRoofInsulationThickness} mm",
      "requiredValue": "≥ 80 mm na laje de esteira ou ≥ 100 mm nas vertentes (lã mineral ou EPS)",
      "remediation": "Colocar isolamento na laje de esteira (solução mais económica) ou nas vertentes (se desvão habitável). Usar lã mineral, EPS ou projecção de espuma com espessura adequada à zona climática.",
      "enabled": true,
      "tags": [
        "cobertura inclinada",
        "isolamento",
        "espessura",
        "esteira",
        "vertentes"
      ]
    },
    {
      "id": "REH-COBISO-03",
      "regulationId": "dl-101d-2020-nzeb",
      "article": "DL 101-D/2020 — Desempenho Térmico de Cobertura Verde",
      "description": "A cobertura verde não atinge o valor de U máximo regulamentar ({envelope.greenRoofUValue} W/(m².K)).",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.greenRoofUValue",
          "operator": ">",
          "value": 0.35
        },
        {
          "field": "envelope.hasGreenRoof",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "U cobertura verde: {envelope.greenRoofUValue} W/(m².K)",
      "requiredValue": "≤ 0.35 W/(m².K) (incluindo contribuição do substrato vegetal)",
      "remediation": "A camada vegetal da cobertura verde contribui para a resistência térmica, mas não substitui o isolamento. Garantir isolamento XPS/PIR sob a camada drenante com espessura adequada para cumprir o Umáx.",
      "enabled": true,
      "tags": [
        "cobertura verde",
        "valor-U",
        "isolamento",
        "sustentabilidade"
      ]
    },
    {
      "id": "REH-COBISO-04",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 — Espaço de Ventilação em Cobertura",
      "description": "O espaço de ventilação entre o isolamento e a telha ({envelope.roofVentilationGap} mm) é insuficiente para prevenir condensações na cobertura inclinada.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.roofVentilationGap",
          "operator": "<",
          "value": 40
        },
        {
          "field": "envelope.roofType",
          "operator": "==",
          "value": "pitched"
        }
      ],
      "currentValueTemplate": "Espaço de ventilação: {envelope.roofVentilationGap} mm",
      "requiredValue": "≥ 40 mm de caixa-de-ar ventilada entre isolamento e subtelha",
      "remediation": "Prever espaço de ventilação entre o isolamento nas vertentes e a subtelha (mínimo 40 mm). Garantir aberturas de entrada de ar na cumeeira e nos beirais para circulação natural.",
      "enabled": true,
      "tags": [
        "cobertura",
        "ventilação",
        "caixa-de-ar",
        "condensação"
      ]
    },
    {
      "id": "REH-COBISO-05",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 — Cobertura Invertida: Impermeabilização",
      "description": "Na cobertura invertida, a impermeabilização não está posicionada sob o isolamento térmico.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.invertedRoofWaterproofingBelowInsulation",
          "operator": "==",
          "value": false
        },
        {
          "field": "envelope.roofType",
          "operator": "==",
          "value": "inverted"
        }
      ],
      "currentValueTemplate": "Impermeabilização não está sob o isolamento na cobertura invertida",
      "requiredValue": "Impermeabilização sob o isolamento (cobertura invertida correta)",
      "remediation": "Na cobertura invertida, a membrana impermeabilizante deve ficar sob o isolamento (XPS), protegida termicamente. O isolamento XPS deve ter absorção de água ≤ 1% e resistência à compressão adequada para suportar a camada de protecção/lastro.",
      "enabled": true,
      "tags": [
        "cobertura invertida",
        "impermeabilização",
        "XPS",
        "sistema construtivo"
      ]
    },
    {
      "id": "REH-PAVISO-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 — Isolamento de Pavimento em Contacto com Solo",
      "description": "O pavimento em contacto com o solo não possui isolamento térmico perimetral ou na totalidade da área ({envelope.groundFloorInsulationThickness} mm).",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.groundFloorInsulationThickness",
          "operator": "<",
          "value": 50
        },
        {
          "field": "envelope.groundFloorContact",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Espessura isolamento pavimento térreo: {envelope.groundFloorInsulationThickness} mm",
      "requiredValue": "≥ 50 mm (XPS ≥ 300 kPa) sob laje ou perimetral conforme EN ISO 13370",
      "remediation": "Aplicar isolamento sob a laje em contacto com o solo (XPS de alta resistência à compressão ≥ 300 kPa) ou isolamento perimetral com profundidade ≥ 1.0 m. O cálculo de Ubf deve seguir a EN ISO 13370.",
      "enabled": true,
      "tags": [
        "pavimento",
        "solo",
        "isolamento perimetral",
        "XPS"
      ]
    },
    {
      "id": "REH-PAVISO-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 — Isolamento de Pavimento Suspenso",
      "description": "O pavimento suspenso sobre espaço não aquecido não possui isolamento térmico adequado ({envelope.suspendedFloorInsulationThickness} mm).",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.suspendedFloorInsulationThickness",
          "operator": "<",
          "value": 60
        },
        {
          "field": "envelope.hasSuspendedFloor",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Espessura isolamento pavimento suspenso: {envelope.suspendedFloorInsulationThickness} mm",
      "requiredValue": "≥ 60 mm (lã mineral ou EPS) na face inferior da laje",
      "remediation": "Isolar a face inferior da laje do pavimento suspenso com painéis rígidos (EPS, XPS) fixados mecanicamente ou projecção de espuma de poliuretano (PUR). Espessura mínima de 60 mm para zonas I1, podendo ser necessário 80-100 mm para I2/I3.",
      "enabled": true,
      "tags": [
        "pavimento suspenso",
        "isolamento",
        "laje",
        "espaço não aquecido"
      ]
    },
    {
      "id": "REH-PAVISO-03",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 — Isolamento do Tecto de Garagem",
      "description": "O tecto da garagem (pavimento do espaço habitável acima) não possui isolamento térmico adequado ({envelope.garageCeilingUValue} W/(m².K)).",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.garageCeilingUValue",
          "operator": ">",
          "value": 0.5
        },
        {
          "field": "envelope.hasGarageBelow",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "U tecto garagem: {envelope.garageCeilingUValue} W/(m².K)",
      "requiredValue": "≤ 0.50 W/(m².K) para zona I1; ≤ 0.40 para I2; ≤ 0.35 para I3",
      "remediation": "Isolar o tecto da garagem pela face inferior com painéis de EPS/XPS (espessura ≥ 60mm) ou projecção de PUR. Solução alternativa: pavimento flutuante com isolamento no piso do espaço habitável acima.",
      "enabled": true,
      "tags": [
        "garagem",
        "tecto",
        "isolamento",
        "pavimento sobre ENU"
      ]
    },
    {
      "id": "REH-PAVISO-04",
      "regulationId": "en-iso-10211",
      "article": "EN ISO 10211 — Corte Térmico em Varanda/Consola",
      "description": "A laje de varanda/consola não possui corte térmico na ligação com a laje interior, constituindo uma ponte térmica linear significativa ({envelope.balconyThermalBreak}).",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.balconyThermalBreak",
          "operator": "==",
          "value": false
        },
        {
          "field": "envelope.hasBalcony",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Sem corte térmico na ligação laje-varanda",
      "requiredValue": "Corte térmico estrutural com ψ ≤ 0.50 W/(m·K) na ligação laje-varanda",
      "remediation": "Instalar elemento de corte térmico estrutural (tipo Schöck Isokorb ou equivalente) na ligação entre a laje interior e a consola da varanda. Reduz ψ de ~1.0 para ≤ 0.15 W/(m·K). Alternativa: varanda autoportante com apoio independente.",
      "enabled": true,
      "tags": [
        "varanda",
        "corte térmico",
        "ponte térmica",
        "laje",
        "consola"
      ]
    },
    {
      "id": "REH-PAVISO-05",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Isolamento sob Piso Radiante",
      "description": "O isolamento sob o sistema de piso radiante ({envelope.underfloorHeatingInsulationThickness} mm) é insuficiente, provocando perdas térmicas para baixo.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.underfloorHeatingInsulationThickness",
          "operator": "<",
          "value": 50
        },
        {
          "field": "thermal.hasUnderfloorHeating",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Espessura isolamento sob piso radiante: {envelope.underfloorHeatingInsulationThickness} mm",
      "requiredValue": "≥ 50 mm (EPS/XPS) sobre laje interior; ≥ 80 mm sobre solo ou ENU",
      "remediation": "Colocar isolamento rígido (EPS, XPS ou painéis com plots) sob as tubagens do piso radiante com espessura mínima de 50 mm sobre laje interior e 80 mm sobre solo ou espaço não aquecido. Usar isolamento com resistência à compressão ≥ 50 kPa.",
      "enabled": true,
      "tags": [
        "piso radiante",
        "isolamento",
        "pavimento",
        "aquecimento"
      ]
    },
    {
      "id": "REH-PARISO-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 — Isolamento na Caixa-de-Ar de Parede Dupla",
      "description": "A espessura de isolamento na caixa-de-ar da parede dupla ({envelope.cavityWallInsulationThickness} mm) é insuficiente para cumprir o Umáx regulamentar.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.cavityWallInsulationThickness",
          "operator": "<",
          "value": 60
        },
        {
          "field": "envelope.wallType",
          "operator": "==",
          "value": "cavity"
        }
      ],
      "currentValueTemplate": "Espessura isolamento caixa-de-ar: {envelope.cavityWallInsulationThickness} mm",
      "requiredValue": "≥ 60 mm (EPS, lã mineral) para I1; ≥ 80 mm para I2/I3",
      "remediation": "Preencher totalmente a caixa-de-ar com isolamento térmico (EPS, lã mineral em painéis ou injecção de espuma). Evitar pontes térmicas nas ligações entre panos. Em reabilitação, considerar injecção de espuma de poliuretano ou grânulos de EPS.",
      "enabled": true,
      "tags": [
        "parede dupla",
        "caixa-de-ar",
        "isolamento",
        "envolvente exterior"
      ]
    },
    {
      "id": "REH-PARISO-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 — Isolamento ETICS em Parede Simples",
      "description": "A espessura de isolamento ETICS ({envelope.eticsInsulationThickness} mm) é insuficiente para cumprir o Umáx da parede exterior na zona climática {location.climateZoneWinter}.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.eticsInsulationThickness",
          "operator": "<",
          "value": 60
        },
        {
          "field": "envelope.wallType",
          "operator": "==",
          "value": "etics"
        }
      ],
      "currentValueTemplate": "Espessura ETICS: {envelope.eticsInsulationThickness} mm",
      "requiredValue": "≥ 60 mm (EPS) para I1; ≥ 80 mm para I2; ≥ 100 mm para I3",
      "remediation": "Aplicar sistema ETICS (External Thermal Insulation Composite System) com espessura de EPS adequada à zona climática. O ETICS elimina pontes térmicas planas e é a solução mais eficaz para isolamento pelo exterior. Usar EPS com λ ≤ 0.036 W/(m·K).",
      "enabled": true,
      "tags": [
        "ETICS",
        "parede simples",
        "isolamento pelo exterior",
        "envolvente exterior"
      ]
    },
    {
      "id": "REH-PARISO-03",
      "regulationId": "en-iso-13788",
      "article": "EN ISO 13788 — Barreira Pára-Vapor em Isolamento Interior de Paredes",
      "description": "O isolamento térmico pelo interior da parede não possui barreira pára-vapor, com risco de condensações internas.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.interiorWallInsulationVapourBarrier",
          "operator": "==",
          "value": false
        },
        {
          "field": "envelope.wallType",
          "operator": "==",
          "value": "interior_insulation"
        }
      ],
      "currentValueTemplate": "Sem barreira pára-vapor no isolamento interior de paredes",
      "requiredValue": "Barreira pára-vapor (Sd ≥ 10 m) no lado quente do isolamento",
      "remediation": "Instalar barreira pára-vapor (filme PE 200μm ou membrana com Sd ≥ 10 m) no lado interior (quente) do isolamento. Alternativa: usar isolamento com revestimento de alumínio incorporado. Selar todas as juntas e perfurações para garantir continuidade.",
      "enabled": true,
      "tags": [
        "isolamento interior",
        "barreira pára-vapor",
        "condensação",
        "paredes"
      ]
    },
    {
      "id": "REH-PARISO-04",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 — Isolamento de Paredes de Meação",
      "description": "A parede de meação (entre frações ou edifícios adjacentes) não possui isolamento térmico adequado ({envelope.partyWallUValue} W/(m².K)).",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.partyWallUValue",
          "operator": ">",
          "value": 0.8
        }
      ],
      "currentValueTemplate": "U parede de meação: {envelope.partyWallUValue} W/(m².K)",
      "requiredValue": "≤ 0.80 W/(m².K) para paredes de meação (todas as zonas climáticas)",
      "remediation": "Isolar paredes de meação com contra-fachada com isolamento (lã mineral ≥ 40 mm + gesso cartonado) ou painéis isolantes colados. O isolamento acústico pode ser combinado com o isolamento térmico usando lã mineral de alta densidade.",
      "enabled": true,
      "tags": [
        "parede de meação",
        "isolamento",
        "entre frações",
        "valor-U"
      ]
    },
    {
      "id": "REH-PARISO-05",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 — Isolamento de Paredes Enterradas",
      "description": "As paredes enterradas (cave/subsolo) não possuem isolamento térmico adequado ({envelope.basementWallInsulationThickness} mm).",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.basementWallInsulationThickness",
          "operator": "<",
          "value": 50
        },
        {
          "field": "envelope.hasBasementWalls",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Espessura isolamento paredes enterradas: {envelope.basementWallInsulationThickness} mm",
      "requiredValue": "≥ 50 mm (XPS ou espuma de vidro celular) com impermeabilização associada",
      "remediation": "Aplicar isolamento pelo exterior das paredes enterradas com XPS (resistente à humidade e compressão do solo) ou espuma de vidro celular. Mínimo 50 mm, com membrana impermeabilizante e drenagem periférica. Pelo interior, usar XPS + gesso cartonado hidrófugo.",
      "enabled": true,
      "tags": [
        "paredes enterradas",
        "cave",
        "isolamento",
        "XPS",
        "impermeabilização"
      ]
    },
    {
      "id": "REH-CAIXILH-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Tabela I.01 — Vidro Duplo Mínimo",
      "description": "Os vãos envidraçados não possuem vidro duplo, utilizando vidro simples com U excessivo ({envelope.glazingType}).",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.glazingType",
          "operator": "==",
          "value": "single"
        }
      ],
      "currentValueTemplate": "Tipo de vidro: simples ({envelope.glazingType})",
      "requiredValue": "Vidro duplo (mínimo 4-12-4 mm) ou superior em todas as zonas climáticas",
      "remediation": "Substituir vidro simples por vidro duplo com caixa-de-ar ≥ 12 mm (U ≈ 2.8 W/(m².K)) ou vidro duplo com baixa emissividade (U ≈ 1.4-1.8 W/(m².K)). Em zonas I2/I3, considerar vidro triplo.",
      "enabled": true,
      "tags": [
        "vidro duplo",
        "envidraçados",
        "caixilharia",
        "valor-U"
      ]
    },
    {
      "id": "REH-CAIXILH-02",
      "regulationId": "dl-101d-2020-nzeb",
      "article": "DL 101-D/2020 — Revestimento de Baixa Emissividade em Envidraçados",
      "description": "Os vãos envidraçados não possuem revestimento de baixa emissividade (low-E), recomendado para edifícios NZEB.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.hasLowEGlazing",
          "operator": "==",
          "value": false
        },
        {
          "field": "thermal.nzebRequired",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Envidraçados sem revestimento low-E",
      "requiredValue": "Vidro com revestimento de baixa emissividade (ε ≤ 0.10) para edifícios NZEB",
      "remediation": "Aplicar vidro com revestimento de baixa emissividade (low-E) na face 3 do vidro duplo. Reduz U do envidraçado de ~2.8 para ~1.4 W/(m².K). Optar por low-E seletivo em fachadas com elevada exposição solar para manter ganhos solares no inverno.",
      "enabled": true,
      "tags": [
        "low-E",
        "envidraçados",
        "NZEB",
        "emissividade"
      ]
    },
    {
      "id": "REH-CAIXILH-03",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 — Corte Térmico na Caixilharia",
      "description": "A caixilharia em alumínio não possui corte térmico (RPT), resultando em U de caixilharia excessivo ({envelope.frameThermalBreak}).",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.frameThermalBreak",
          "operator": "==",
          "value": false
        },
        {
          "field": "envelope.frameMaterial",
          "operator": "==",
          "value": "aluminium"
        }
      ],
      "currentValueTemplate": "Caixilharia alumínio sem corte térmico (RPT)",
      "requiredValue": "Caixilharia com rotura de ponte térmica (RPT ≥ 24 mm) ou PVC/madeira",
      "remediation": "Substituir caixilharia de alumínio sem corte térmico (Uf ≈ 5.7 W/(m².K)) por caixilharia com RPT (Uf ≈ 2.8-3.8 W/(m².K)), PVC (Uf ≈ 1.4-2.2 W/(m².K)) ou madeira (Uf ≈ 1.8-2.5 W/(m².K)). A RPT mínima recomendada é de 24 mm.",
      "enabled": true,
      "tags": [
        "caixilharia",
        "corte térmico",
        "RPT",
        "alumínio",
        "valor-U"
      ]
    },
    {
      "id": "REH-CAIXILH-04",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 — Valor U de Clarabóias",
      "description": "O coeficiente de transmissão térmica das clarabóias ({envelope.skylightUValue} W/(m².K)) excede o valor máximo regulamentar.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.skylightUValue",
          "operator": ">",
          "value": 2.8
        },
        {
          "field": "envelope.hasSkylights",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "U clarabóias: {envelope.skylightUValue} W/(m².K)",
      "requiredValue": "≤ 2.80 W/(m².K) para I1; ≤ 2.40 para I2; ≤ 2.20 para I3",
      "remediation": "Substituir clarabóias por modelos com vidro duplo de baixa emissividade e caixilho com corte térmico. Considerar clarabóias tubulares para iluminação sem perdas térmicas significativas. Em zonas I3, considerar vidro triplo.",
      "enabled": true,
      "tags": [
        "clarabóias",
        "valor-U",
        "envidraçados",
        "cobertura"
      ]
    },
    {
      "id": "REH-CAIXILH-05",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 — Desempenho Térmico de Fachada Cortina",
      "description": "O sistema de fachada cortina não cumpre o valor U máximo regulamentar ({envelope.curtainWallUValue} W/(m².K)) para a zona climática {location.climateZoneWinter}.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.curtainWallUValue",
          "operator": ">",
          "value": 2.4
        },
        {
          "field": "envelope.hasCurtainWall",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "U fachada cortina: {envelope.curtainWallUValue} W/(m².K)",
      "requiredValue": "Ucw ≤ 2.40 W/(m².K) para envidraçados; painéis opacos devem cumprir Umáx de paredes",
      "remediation": "Utilizar vidro duplo com baixa emissividade e caixa-de-ar com gás árgon nos módulos envidraçados. Os painéis opacos (spandrel) devem ter isolamento para cumprir Umáx de paredes. Garantir corte térmico nos perfis de alumínio da fachada cortina.",
      "enabled": true,
      "tags": [
        "fachada cortina",
        "valor-U",
        "envidraçados",
        "envolvente exterior"
      ]
    },
    {
      "id": "REH-INERCIA-01",
      "regulationId": "despacho-15793f-2013",
      "article": "Despacho 15793-F/2013 — Classificação da Inércia Térmica",
      "description": "A massa superficial útil por unidade de área de pavimento ({thermal.thermalMassPerArea} kg/m²) resulta numa classe de inércia térmica ({thermal.thermalMassClass}) que pode ser desfavorável para o desempenho energético.",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.thermalMassPerArea",
          "operator": "<",
          "value": 150
        }
      ],
      "currentValueTemplate": "It = {thermal.thermalMassPerArea} kg/m²; Classe: {thermal.thermalMassClass}",
      "requiredValue": "It < 150 → Fraca; 150 ≤ It ≤ 400 → Média; It > 400 → Forte",
      "remediation": "A inércia térmica influencia os parâmetros de aquecimento e arrefecimento. Para aumentar a inércia: usar paredes de alvenaria com reboco, lajes maciças de betão, pavimentos cerâmicos ou de pedra. Evitar revestimentos isolantes nas superfícies interiores.",
      "enabled": true,
      "tags": [
        "inércia térmica",
        "massa superficial",
        "classificação",
        "desempenho"
      ]
    },
    {
      "id": "REH-INERCIA-02",
      "regulationId": "despacho-15793f-2013",
      "article": "Despacho 15793-F/2013 — Contribuição do Betão Exposto para Inércia Térmica",
      "description": "As superfícies de betão aparente interiores ({thermal.exposedConcreteArea} m²) contribuem significativamente para a inércia térmica mas podem comprometer o conforto acústico.",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.exposedConcreteArea",
          "operator": ">",
          "value": 0
        },
        {
          "field": "thermal.thermalMassClass",
          "operator": "==",
          "value": "forte"
        }
      ],
      "currentValueTemplate": "Área betão exposto: {thermal.exposedConcreteArea} m²; Inércia: forte",
      "requiredValue": "Massa superficial útil: Mi = 150 kg/m² para betão (espessura útil até 0.30 m)",
      "remediation": "O betão exposto contribui com ~150 kg/m² de massa superficial útil para a inércia térmica (espessura útil limitada a 0.30 m ou metade da espessura total). Garantir que o conforto acústico é assegurado com soluções complementares.",
      "enabled": true,
      "tags": [
        "betão exposto",
        "inércia térmica",
        "massa superficial",
        "forte"
      ]
    },
    {
      "id": "REH-INERCIA-03",
      "regulationId": "despacho-15793f-2013",
      "article": "Despacho 15793-F/2013 — Limitações de Construção Leve",
      "description": "A construção leve (estrutura em aço leve ou madeira) resulta em inércia térmica fraca ({thermal.thermalMassClass}), com impacto negativo no sobreaquecimento estival.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.thermalMassClass",
          "operator": "==",
          "value": "fraca"
        },
        {
          "field": "location.climateZoneSummer",
          "operator": "in",
          "value": ["V2", "V3"]
        }
      ],
      "currentValueTemplate": "Inércia: {thermal.thermalMassClass}; Zona verão: {location.climateZoneSummer}",
      "requiredValue": "Inércia ≥ média recomendada em zonas V2/V3 para controlo de sobreaquecimento",
      "remediation": "Em construção leve com zona de verão V2/V3, compensar a baixa inércia com: paredes interiores em alvenaria, laje de betão no pavimento térreo, revestimentos cerâmicos/pedra no pavimento, sistemas de sombreamento exterior eficazes. Considerar materiais de mudança de fase (PCM).",
      "enabled": true,
      "tags": [
        "construção leve",
        "inércia fraca",
        "sobreaquecimento",
        "verão"
      ]
    },
    {
      "id": "REH-INERCIA-04",
      "regulationId": "despacho-15793f-2013",
      "article": "Despacho 15793-F/2013 — Posição da Massa Térmica Relativamente ao Isolamento",
      "description": "O isolamento térmico pelo interior reduz a massa térmica útil disponível, impedindo a contribuição das paredes exteriores para a inércia térmica.",
      "severity": "info",
      "conditions": [
        {
          "field": "envelope.wallType",
          "operator": "==",
          "value": "interior_insulation"
        },
        {
          "field": "thermal.thermalMassClass",
          "operator": "==",
          "value": "fraca"
        }
      ],
      "currentValueTemplate": "Isolamento pelo interior: massa térmica das paredes exteriores não contribui para inércia",
      "requiredValue": "Massa térmica no lado interior do isolamento para máxima inércia",
      "remediation": "O isolamento pelo exterior (ETICS) permite que a massa das paredes de alvenaria/betão contribua para a inércia térmica. Se o isolamento interior for necessário, maximizar a massa térmica com: lajes de betão expostas, paredes interiores pesadas, revestimentos cerâmicos/pedra.",
      "enabled": true,
      "tags": [
        "inércia térmica",
        "posição isolamento",
        "massa térmica",
        "ETICS"
      ]
    },
    {
      "id": "REH-INERCIA-05",
      "regulationId": "dl-101d-2020-nzeb",
      "article": "DL 101-D/2020 — Materiais de Mudança de Fase (PCM) para Inércia Térmica",
      "description": "Em construção leve, a ausência de materiais de mudança de fase (PCM) ou soluções equivalentes não permite compensar a baixa inércia térmica.",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.thermalMassClass",
          "operator": "==",
          "value": "fraca"
        },
        {
          "field": "thermal.hasPCM",
          "operator": "==",
          "value": false
        }
      ],
      "currentValueTemplate": "Sem PCM em construção de inércia fraca",
      "requiredValue": "PCM com temperatura de fusão 22-26°C recomendado para compensar baixa inércia",
      "remediation": "Incorporar materiais de mudança de fase (PCM) em placas de gesso cartonado, tectos ou pavimentos para aumentar a capacidade de armazenamento térmico. Temperatura de fusão ideal: 22-26°C. Alternativa: soluções com betão leve com PCM micro-encapsulado.",
      "enabled": true,
      "tags": [
        "PCM",
        "mudança de fase",
        "inércia térmica",
        "construção leve"
      ]
    },
    {
      "id": "REH-SOBRAQ-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Artigo 11.º — Avaliação de Risco de Sobreaquecimento",
      "description": "O factor de utilização dos ganhos solares na estação de arrefecimento é insuficiente, indicando risco de sobreaquecimento ({thermal.summerGainUtilizationFactor}).",
      "severity": "critical",
      "conditions": [
        {
          "field": "thermal.overheatingRiskAssessed",
          "operator": "==",
          "value": false
        }
      ],
      "currentValueTemplate": "Avaliação de risco de sobreaquecimento: não realizada",
      "requiredValue": "Avaliação obrigatória do risco de sobreaquecimento conforme REH",
      "remediation": "Realizar avaliação de sobreaquecimento conforme metodologia REH: calcular Nvc (necessidades de arrefecimento) e verificar se Nvc ≤ Nv. Implementar medidas passivas: sombreamento exterior, ventilação natural, inércia térmica, orientação dos envidraçados.",
      "enabled": true,
      "tags": [
        "sobreaquecimento",
        "ganhos solares",
        "arrefecimento",
        "verão"
      ]
    },
    {
      "id": "REH-SOBRAQ-02",
      "regulationId": "en-16798-1",
      "article": "EN 16798-1 — Ventilação Natural para Arrefecimento",
      "description": "O edifício não dispõe de ventilação natural cruzada adequada para arrefecimento passivo na estação de verão.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.naturalCrossVentilation",
          "operator": "==",
          "value": false
        },
        {
          "field": "location.climateZoneSummer",
          "operator": "in",
          "value": ["V2", "V3"]
        }
      ],
      "currentValueTemplate": "Sem ventilação natural cruzada em zona {location.climateZoneSummer}",
      "requiredValue": "Ventilação cruzada disponível em todas as zonas habitáveis para arrefecimento passivo",
      "remediation": "Garantir ventilação natural cruzada com aberturas em fachadas opostas. Dimensionar aberturas para taxa de renovação ≥ 4 RPH no verão. Instalar janelas de correr ou basculantes para controlo do caudal. Em zonas V2/V3, a ventilação natural é essencial para reduzir Nvc.",
      "enabled": true,
      "tags": [
        "ventilação natural",
        "arrefecimento passivo",
        "ventilação cruzada",
        "verão"
      ]
    },
    {
      "id": "REH-SOBRAQ-03",
      "regulationId": "en-16798-1",
      "article": "EN 16798-1 — Estratégia de Arrefecimento Nocturno",
      "description": "Não está prevista estratégia de arrefecimento nocturno (night cooling) para dissipar calor acumulado durante o dia.",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.nightCoolingStrategy",
          "operator": "==",
          "value": false
        },
        {
          "field": "thermal.thermalMassClass",
          "operator": "in",
          "value": ["media", "forte"]
        }
      ],
      "currentValueTemplate": "Sem estratégia de arrefecimento nocturno",
      "requiredValue": "Arrefecimento nocturno recomendado para edifícios com inércia média/forte em zonas V2/V3",
      "remediation": "Implementar arrefecimento nocturno: aberturas automatizadas ou manuais para ventilação durante a noite (quando Text < Tint). Eficaz com inércia média ou forte. Garantir segurança contra intrusão com grelhas anti-vandalismo ou sistemas motorizados.",
      "enabled": true,
      "tags": [
        "arrefecimento nocturno",
        "ventilação",
        "inércia térmica",
        "passivo"
      ]
    },
    {
      "id": "REH-SOBRAQ-04",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 — Sombreamento Exterior Obrigatório",
      "description": "Os vãos envidraçados orientados a Sul, Este ou Oeste não possuem dispositivos de sombreamento exterior ({envelope.externalShadingProvided}).",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.externalShadingProvided",
          "operator": "==",
          "value": false
        },
        {
          "field": "envelope.windowOrientationRequiresSunControl",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Sem sombreamento exterior nos vãos envidraçados com exposição solar",
      "requiredValue": "Sombreamento exterior obrigatório para envidraçados S/E/O com Aenv > 5% Ap",
      "remediation": "Instalar dispositivos de sombreamento exterior: estores venezianos exteriores, portadas, palas horizontais (fachada Sul) ou verticais (fachadas E/O), brise-soleil. O factor solar com protecção (gT) deve cumprir os limites do Despacho 15793-K/2013.",
      "enabled": true,
      "tags": [
        "sombreamento exterior",
        "factor solar",
        "envidraçados",
        "sobreaquecimento"
      ]
    },
    {
      "id": "REH-SOBRAQ-05",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 — Vidro de Controlo Solar",
      "description": "Os envidraçados com grande exposição solar não possuem vidro de controlo solar, resultando em ganhos solares excessivos ({envelope.solarControlGlass}).",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.solarControlGlass",
          "operator": "==",
          "value": false
        },
        {
          "field": "envelope.windowSolarFactor",
          "operator": ">",
          "value": 0.5
        }
      ],
      "currentValueTemplate": "Vidro sem controlo solar; g⊥ = {envelope.windowSolarFactor}",
      "requiredValue": "Vidro de controlo solar (g⊥ ≤ 0.50) recomendado para fachadas com elevada exposição",
      "remediation": "Utilizar vidro de controlo solar com factor solar g⊥ ≤ 0.50 nas fachadas com maior exposição solar (S/E/O). Optar por vidro selectivo que mantém boa transmissão luminosa (TL ≥ 70%) com baixo factor solar. Combinação com sombreamento exterior para desempenho óptimo.",
      "enabled": true,
      "tags": [
        "controlo solar",
        "vidro",
        "factor solar",
        "envidraçados"
      ]
    },
    {
      "id": "REH-AQS2-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Eficiência do Sistema de Preparação de AQS",
      "description": "A eficiência do sistema de preparação de águas quentes sanitárias ({thermal.aqsSystemEfficiency}%) é inferior ao mínimo regulamentar.",
      "severity": "critical",
      "conditions": [
        {
          "field": "thermal.aqsSystemEfficiency",
          "operator": "<",
          "value": 0.82
        }
      ],
      "currentValueTemplate": "Eficiência AQS: {thermal.aqsSystemEfficiency}",
      "requiredValue": "η ≥ 0.82 para caldeiras; COP ≥ 2.8 para bombas de calor",
      "remediation": "Substituir o sistema de preparação de AQS por equipamento de alta eficiência: caldeira de condensação (η ≥ 0.92), bomba de calor dedicada AQS (COP ≥ 2.8), ou sistema solar térmico com apoio eficiente. Para esquentadores, η ≥ 0.82.",
      "enabled": true,
      "tags": [
        "AQS",
        "eficiência",
        "caldeira",
        "bomba de calor"
      ]
    },
    {
      "id": "REH-AQS2-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Perdas Térmicas do Depósito de AQS",
      "description": "As perdas térmicas do depósito de acumulação de AQS ({thermal.aqsTankHeatLoss} W) excedem o limite para o volume instalado.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.aqsTankHeatLossExcessive",
          "operator": "==",
          "value": true
        },
        {
          "field": "thermal.hasAqsStorageTank",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Perdas depósito AQS: {thermal.aqsTankHeatLoss} W",
      "requiredValue": "Perdas ≤ 1.6 + 0.8 × V^0.5 W (EN 15332) para depósitos de AQS",
      "remediation": "Substituir ou reisolar o depósito de AQS: isolamento mínimo 50 mm de espuma rígida de PUR (λ ≤ 0.025 W/m·K). Verificar que a classe energética do depósito é ≥ B. Para volumes > 500 L, considerar depósitos com isolamento reforçado (≥ 80 mm).",
      "enabled": true,
      "tags": [
        "AQS",
        "depósito",
        "perdas térmicas",
        "isolamento"
      ]
    },
    {
      "id": "REH-AQS2-03",
      "regulationId": "portaria-379a-2015",
      "article": "Portaria 379-A/2015 — Eficiência da Bomba Circuladora de AQS",
      "description": "A bomba circuladora do circuito de AQS não é de alta eficiência ({thermal.aqsCirculationPumpEfficient}).",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.aqsCirculationPumpEfficient",
          "operator": "==",
          "value": false
        },
        {
          "field": "thermal.hasAqsCirculationPump",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Bomba circuladora AQS não é de alta eficiência",
      "requiredValue": "Bomba circuladora com EEI ≤ 0.23 (classe A ou superior)",
      "remediation": "Substituir a bomba circuladora por modelo de alta eficiência (EEI ≤ 0.23, classe A). Instalar temporizador ou controlador para funcionamento apenas nos períodos de consumo. Considerar bomba com velocidade variável para adaptação ao caudal.",
      "enabled": true,
      "tags": [
        "AQS",
        "bomba circuladora",
        "eficiência",
        "circulação"
      ]
    },
    {
      "id": "REH-AQS2-04",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Prevenção de Legionella no Sistema de AQS",
      "description": "O sistema de AQS não garante a temperatura mínima de prevenção de Legionella no depósito ({thermal.aqsStorageTemperature}°C).",
      "severity": "critical",
      "conditions": [
        {
          "field": "thermal.aqsStorageTemperature",
          "operator": "<",
          "value": 60
        },
        {
          "field": "thermal.hasAqsStorageTank",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Temperatura depósito AQS: {thermal.aqsStorageTemperature}°C",
      "requiredValue": "≥ 60°C no depósito para prevenção de Legionella (DL 306/2007)",
      "remediation": "Garantir temperatura mínima de 60°C no depósito de AQS para prevenção de Legionella pneumophila. Programar ciclos de choque térmico (≥ 70°C) periódicos. Em sistemas com bomba de calor, prever resistência eléctrica de apoio para atingir 60°C.",
      "enabled": true,
      "tags": [
        "AQS",
        "Legionella",
        "temperatura",
        "saúde pública"
      ]
    },
    {
      "id": "REH-AQS2-05",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Artigo 8.º — Integração de Solar Térmico para AQS",
      "description": "O edifício novo não possui sistema solar térmico para preparação de AQS ou sistema alternativo equivalente ({thermal.solarThermalInstalled}).",
      "severity": "critical",
      "conditions": [
        {
          "field": "thermal.solarThermalInstalled",
          "operator": "==",
          "value": false
        },
        {
          "field": "thermal.solarThermalAlternativeProvided",
          "operator": "==",
          "value": false
        },
        {
          "field": "isRehabilitation",
          "operator": "==",
          "value": false
        }
      ],
      "currentValueTemplate": "Sem sistema solar térmico ou alternativa para AQS",
      "requiredValue": "Solar térmico obrigatório (1 m²/ocupante) ou sistema alternativo equivalente (Esolar ≥ Qa × 0.50)",
      "remediation": "Instalar sistema solar térmico com área mínima de 1 m² de colector por ocupante convencional. Alternativas equivalentes: bomba de calor AQS com COP ≥ 2.8, caldeira de biomassa, sistema fotovoltaico dedicado a AQS com energia equivalente ao contributo solar mínimo.",
      "enabled": true,
      "tags": [
        "solar térmico",
        "AQS",
        "obrigatório",
        "energia renovável"
      ]
    },
    {
      "id": "REH-PONTES2-01",
      "regulationId": "en-iso-10211",
      "article": "EN ISO 10211 — Tratamento da Ligação Laje-Parede de Fachada",
      "description": "A ligação entre a laje de piso e a parede de fachada não possui tratamento de ponte térmica adequado ({envelope.slabWallJunctionPsi} W/(m·K)).",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.slabWallJunctionPsi",
          "operator": ">",
          "value": 0.5
        }
      ],
      "currentValueTemplate": "ψ ligação laje-parede: {envelope.slabWallJunctionPsi} W/(m·K)",
      "requiredValue": "ψ ≤ 0.50 W/(m·K) para ligação laje-parede tratada",
      "remediation": "Tratar a ponte térmica na ligação laje-parede: prolongar o isolamento ETICS sobre o topo da laje, aplicar isolamento na face inferior da laje junto à fachada (≥ 1.0 m), ou usar corte térmico pré-fabricado na ligação. Com ETICS contínuo, ψ pode ser reduzido para < 0.10 W/(m·K).",
      "enabled": true,
      "tags": [
        "ponte térmica",
        "laje-parede",
        "ligação",
        "ψ",
        "ETICS"
      ]
    },
    {
      "id": "REH-PONTES2-02",
      "regulationId": "en-iso-10211",
      "article": "EN ISO 10211 — Tratamento de Pilar em Fachada",
      "description": "Os pilares inseridos na fachada não possuem isolamento térmico, constituindo pontes térmicas planas significativas ({envelope.facadePillarInsulated}).",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.facadePillarInsulated",
          "operator": "==",
          "value": false
        },
        {
          "field": "envelope.hasFacadePillars",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Pilares em fachada sem isolamento térmico",
      "requiredValue": "U na zona do pilar ≤ 2 × U da parede corrente (Despacho 15793-K/2013)",
      "remediation": "Isolar os pilares pelo exterior com ETICS (mínimo mesma espessura que a parede corrente). Em parede dupla, envolver o pilar com isolamento na caixa-de-ar. O ETICS é a solução mais eficaz pois garante continuidade do isolamento. Verificar que U do pilar não excede 2 × U da parede corrente.",
      "enabled": true,
      "tags": [
        "pilar",
        "fachada",
        "ponte térmica plana",
        "isolamento",
        "ETICS"
      ]
    },
    {
      "id": "REH-PONTES2-03",
      "regulationId": "en-iso-10211",
      "article": "EN ISO 10211 — Isolamento do Peitoril da Janela",
      "description": "O peitoril da janela não possui isolamento térmico na ligação com a fachada, gerando ponte térmica linear na base do vão ({envelope.windowSillInsulated}).",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.windowSillInsulated",
          "operator": "==",
          "value": false
        }
      ],
      "currentValueTemplate": "Peitoril da janela sem isolamento na ligação com fachada",
      "requiredValue": "Isolamento contínuo sob o peitoril com sobreposição ao isolamento da parede ≥ 50 mm",
      "remediation": "Aplicar isolamento térmico sob o peitoril da janela com sobreposição ao isolamento da parede (≥ 50 mm). Em ETICS, garantir que o isolamento envolve a soleira/peitoril sem interrupção. Usar perfis de peitoril com corte térmico para reduzir o ψ linear da ligação.",
      "enabled": true,
      "tags": [
        "peitoril",
        "janela",
        "ponte térmica",
        "isolamento",
        "ligação"
      ]
    },
    {
      "id": "REH-PONTES2-04",
      "regulationId": "en-iso-10211",
      "article": "EN ISO 10211 — Ligação Cobertura-Parede de Fachada",
      "description": "A ligação entre a cobertura e a parede de fachada apresenta ponte térmica não tratada ({envelope.roofWallJunctionPsi} W/(m·K)).",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.roofWallJunctionPsi",
          "operator": ">",
          "value": 0.5
        }
      ],
      "currentValueTemplate": "ψ ligação cobertura-parede: {envelope.roofWallJunctionPsi} W/(m·K)",
      "requiredValue": "ψ ≤ 0.50 W/(m·K) para ligação cobertura-parede tratada",
      "remediation": "Garantir continuidade do isolamento na ligação cobertura-parede: prolongar o isolamento da cobertura até se sobrepor ao isolamento da parede (mínimo 100 mm de sobreposição). Em ETICS, o isolamento da platibanda deve ser contínuo até à cobertura. ψ pode ser reduzido para < 0.15 W/(m·K) com tratamento adequado.",
      "enabled": true,
      "tags": [
        "cobertura-parede",
        "ponte térmica",
        "ligação",
        "ψ",
        "platibanda"
      ]
    },
    {
      "id": "REH-PONTES2-05",
      "regulationId": "en-iso-10211",
      "article": "EN ISO 10211 — Isolamento Perimetral da Fundação",
      "description": "A fundação não possui isolamento perimetral, gerando ponte térmica significativa na base da fachada ({envelope.foundationPerimeterInsulated}).",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.foundationPerimeterInsulated",
          "operator": "==",
          "value": false
        }
      ],
      "currentValueTemplate": "Sem isolamento perimetral na fundação",
      "requiredValue": "Isolamento perimetral XPS ≥ 50 mm com profundidade ≥ 0.60 m abaixo do nível do solo",
      "remediation": "Aplicar isolamento perimetral na fundação com XPS (resistente à humidade) com espessura ≥ 50 mm e profundidade ≥ 0.60 m abaixo do nível do solo. Proteger o isolamento com membrana drenante. Em zonas I3, considerar profundidade ≥ 1.0 m e espessura ≥ 80 mm.",
      "enabled": true,
      "tags": [
        "fundação",
        "isolamento perimetral",
        "ponte térmica",
        "XPS",
        "base fachada"
      ]
    },
    {
      "id": "REH-CERTIF-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Artigo 6.º — Verificação do Cálculo de Nic",
      "description": "As necessidades nominais de energia útil para aquecimento (Nic = {thermal.nic} kWh/(m².ano)) excedem o valor limite (Ni = {thermal.ni} kWh/(m².ano)).",
      "severity": "critical",
      "conditions": [
        {
          "field": "thermal.nic",
          "operator": "formula_gt",
          "value": "thermal.ni"
        }
      ],
      "currentValueTemplate": "Nic = {thermal.nic} kWh/(m².ano)",
      "requiredValue": "Nic ≤ Ni = {thermal.ni} kWh/(m².ano)",
      "remediation": "Reduzir as necessidades de aquecimento: reforçar isolamento da envolvente (paredes, cobertura, pavimentos), melhorar vãos envidraçados, tratar pontes térmicas, optimizar orientação e área de envidraçados para maximizar ganhos solares no inverno, garantir ventilação adequada sem perdas excessivas.",
      "enabled": true,
      "tags": [
        "Nic",
        "aquecimento",
        "necessidades energéticas",
        "verificação"
      ]
    },
    {
      "id": "REH-CERTIF-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Artigo 6.º — Verificação do Cálculo de Nvc",
      "description": "As necessidades nominais de energia útil para arrefecimento (Nvc = {thermal.nvc} kWh/(m².ano)) excedem o valor limite (Nv = {thermal.nv} kWh/(m².ano)).",
      "severity": "critical",
      "conditions": [
        {
          "field": "thermal.nvc",
          "operator": "formula_gt",
          "value": "thermal.nv"
        }
      ],
      "currentValueTemplate": "Nvc = {thermal.nvc} kWh/(m².ano)",
      "requiredValue": "Nvc ≤ Nv = {thermal.nv} kWh/(m².ano)",
      "remediation": "Reduzir as necessidades de arrefecimento: instalar sombreamento exterior nos vãos envidraçados (estores, palas, brise-soleil), usar vidro de controlo solar, aumentar inércia térmica, implementar ventilação natural cruzada e arrefecimento nocturno, reduzir cargas internas.",
      "enabled": true,
      "tags": [
        "Nvc",
        "arrefecimento",
        "necessidades energéticas",
        "verificação"
      ]
    },
    {
      "id": "REH-CERTIF-03",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Artigo 6.º — Verificação do Rácio Ntc/Nt",
      "description": "O rácio entre as necessidades nominais globais de energia primária (Ntc) e o valor limite (Nt) excede 1.0, indicando incumprimento regulamentar ({thermal.ntcNtRatio}).",
      "severity": "critical",
      "conditions": [
        {
          "field": "thermal.ntcNtRatio",
          "operator": ">",
          "value": 1.0
        }
      ],
      "currentValueTemplate": "Ntc/Nt = {thermal.ntcNtRatio}",
      "requiredValue": "Ntc/Nt ≤ 1.0 (condição de conformidade REH)",
      "remediation": "Reduzir o rácio Ntc/Nt abaixo de 1.0: melhorar a envolvente térmica, usar sistemas de climatização de alta eficiência, integrar energias renováveis (solar térmico, fotovoltaico, bomba de calor). O rácio determina a classe energética: ≤ 0.25 → A+; ≤ 0.50 → A; ≤ 0.75 → B; ≤ 1.0 → B-.",
      "enabled": true,
      "tags": [
        "Ntc/Nt",
        "classe energética",
        "verificação",
        "conformidade"
      ]
    },
    {
      "id": "REH-CERTIF-04",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Determinação da Classe Energética",
      "description": "A classe energética do edifício ({thermal.energyClass}) é inferior a B-, o limite mínimo para edifícios novos.",
      "severity": "critical",
      "conditions": [
        {
          "field": "thermal.ntcNtRatio",
          "operator": ">",
          "value": 1.0
        },
        {
          "field": "isRehabilitation",
          "operator": "==",
          "value": false
        }
      ],
      "currentValueTemplate": "Classe energética: {thermal.energyClass} (Ntc/Nt = {thermal.ntcNtRatio})",
      "requiredValue": "Classe ≥ B- (Ntc/Nt ≤ 1.0) para edifícios novos",
      "remediation": "Para atingir classe B- (mínimo para edifícios novos): Ntc/Nt ≤ 1.0. Para classes superiores: B (≤ 0.75), A (≤ 0.50), A+ (≤ 0.25). Implementar medidas combinadas na envolvente, sistemas e renováveis para reduzir o rácio Ntc/Nt.",
      "enabled": true,
      "tags": [
        "classe energética",
        "certificação",
        "edifício novo",
        "Ntc/Nt"
      ]
    },
    {
      "id": "REH-CERTIF-05",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Documentação para Certificação Energética",
      "description": "A documentação técnica necessária para a emissão do certificado energético está incompleta ({thermal.certificationDocumentationComplete}).",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.certificationDocumentationComplete",
          "operator": "==",
          "value": false
        }
      ],
      "currentValueTemplate": "Documentação para certificação: incompleta",
      "requiredValue": "Documentação completa: peças desenhadas, fichas técnicas, declarações de desempenho (DoP), cálculo térmico detalhado",
      "remediation": "Reunir documentação obrigatória para certificação: plantas e cortes com identificação da envolvente, fichas técnicas dos isolamentos e envidraçados, declarações de desempenho (DoP/CE), memória de cálculo térmico (Nic, Nvc, Nac, Ntc), fichas ITED, certificados de equipamentos AVAC e AQS.",
      "enabled": true,
      "tags": [
        "certificação",
        "documentação",
        "perito qualificado",
        "SCE"
      ]
    },
    {
      "id": "REH-MANUT-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Frequência de Inspecção do Isolamento Térmico",
      "description": "A inspecção periódica ao estado do isolamento térmico da envolvente não está programada ou está em atraso ({maintenance.insulationInspectionOverdue}).",
      "severity": "info",
      "conditions": [
        {
          "field": "maintenance.insulationInspectionOverdue",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Inspecção do isolamento em atraso",
      "requiredValue": "Inspecção visual do isolamento da envolvente a cada 5 anos (ETICS, cobertura, caixilharia)",
      "remediation": "Programar inspecção periódica (a cada 5 anos) ao estado do isolamento: verificar fissuração e descolamento do ETICS, estado do isolamento da cobertura, vedação das caixilharias, integridade das juntas e remates. Registar observações e intervir preventivamente.",
      "enabled": true,
      "tags": [
        "manutenção",
        "inspecção",
        "isolamento",
        "ETICS",
        "cobertura"
      ]
    },
    {
      "id": "REH-MANUT-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Substituição de Filtros AVAC",
      "description": "Os filtros do sistema AVAC não foram substituídos dentro do intervalo recomendado ({maintenance.hvacFilterReplacementOverdue}).",
      "severity": "warning",
      "conditions": [
        {
          "field": "maintenance.hvacFilterReplacementOverdue",
          "operator": "==",
          "value": true
        },
        {
          "field": "thermal.hasHVACSystem",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Substituição de filtros AVAC em atraso",
      "requiredValue": "Substituição de filtros AVAC a cada 6 meses (ou conforme fabricante)",
      "remediation": "Substituir os filtros do sistema AVAC a cada 6 meses ou conforme recomendação do fabricante. Filtros colmatados reduzem o caudal de ar, aumentam o consumo energético e degradam a qualidade do ar interior. Usar filtros com classe mínima ISO ePM1 50% (antigo F7).",
      "enabled": true,
      "tags": [
        "manutenção",
        "AVAC",
        "filtros",
        "qualidade do ar"
      ]
    },
    {
      "id": "REH-MANUT-03",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Manutenção do Sistema Solar Térmico",
      "description": "A manutenção periódica do sistema solar térmico não está em dia ({maintenance.solarThermalMaintenanceOverdue}).",
      "severity": "warning",
      "conditions": [
        {
          "field": "maintenance.solarThermalMaintenanceOverdue",
          "operator": "==",
          "value": true
        },
        {
          "field": "thermal.solarThermalInstalled",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Manutenção solar térmico em atraso",
      "requiredValue": "Manutenção anual do sistema solar térmico (colectores, fluido, válvulas, depósito)",
      "remediation": "Realizar manutenção anual do sistema solar térmico: verificar pressão do circuito primário, estado do fluido térmico (substituir a cada 3-5 anos), limpar colectores, verificar ânodo do depósito, testar válvulas de segurança e purgadores, verificar isolamento das tubagens.",
      "enabled": true,
      "tags": [
        "manutenção",
        "solar térmico",
        "colectores",
        "fluido térmico"
      ]
    },
    {
      "id": "REH-MANUT-04",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Limpeza do Sistema de Ventilação",
      "description": "O sistema de ventilação mecânica não foi limpo/inspeccionado dentro do prazo recomendado ({maintenance.ventilationCleaningOverdue}).",
      "severity": "info",
      "conditions": [
        {
          "field": "maintenance.ventilationCleaningOverdue",
          "operator": "==",
          "value": true
        },
        {
          "field": "thermal.hasMechanicalVentilation",
          "operator": "==",
          "value": true
        }
      ],
      "currentValueTemplate": "Limpeza do sistema de ventilação em atraso",
      "requiredValue": "Limpeza e inspecção das condutas de ventilação a cada 2 anos",
      "remediation": "Limpar as condutas de ventilação e extraccão a cada 2 anos: aspirar depósitos de pó, verificar estanquidade das juntas, limpar grelhas de insuflação e extracção, verificar caudais em cada boca de ventilação com anemómetro. Registar os caudais medidos para comparação futura.",
      "enabled": true,
      "tags": [
        "manutenção",
        "ventilação",
        "condutas",
        "limpeza",
        "qualidade do ar"
      ]
    },
    {
      "id": "REH-MANUT-05",
      "regulationId": "en-iso-10211",
      "article": "EN ISO 10211 — Monitorização de Pontes Térmicas",
      "description": "Não existe monitorização do estado das zonas de ponte térmica para detecção precoce de patologias ({maintenance.thermalBridgeMonitoring}).",
      "severity": "info",
      "conditions": [
        {
          "field": "maintenance.thermalBridgeMonitoring",
          "operator": "==",
          "value": false
        }
      ],
      "currentValueTemplate": "Sem monitorização de pontes térmicas",
      "requiredValue": "Inspecção termográfica das pontes térmicas a cada 5 anos ou após patologias visíveis",
      "remediation": "Realizar inspecção termográfica (câmara de infravermelhos) nas zonas de ponte térmica conhecidas a cada 5 anos: ligações laje-parede, pilares em fachada, contorno de vãos, platibandas. Detectar precocemente: condensações, bolores, destacamento de revestimentos. Registar imagens termográficas para histórico.",
      "enabled": true,
      "tags": [
        "manutenção",
        "pontes térmicas",
        "termografia",
        "monitorização",
        "patologias"
      ]
    },
    {
      "id": "REH-PTLIN-01",
      "regulationId": "en-iso-10211",
      "article": "EN ISO 10211 — Transmitância Térmica Linear: Ligação Fachada-Cobertura",
      "description": "A transmitância térmica linear (ψ) na ligação fachada-cobertura ({envelope.psiRoofWallJunction} W/(m·K)) excede o limite máximo admissível.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.psiRoofWallJunction",
          "operator": ">",
          "value": 0.5
        }
      ],
      "remediation": "Assegurar continuidade do isolamento na transição fachada-cobertura. Prolongar o ETICS até à platibanda ou até ao remate com a cobertura. Usar perfis de remate com encaixe que garantam a sobreposição dos isolamentos.",
      "currentValueTemplate": "ψ ligação fachada-cobertura: {envelope.psiRoofWallJunction} W/(m·K)",
      "requiredValue": "ψ ≤ 0.50 W/(m·K) na ligação fachada-cobertura (EN ISO 10211 + Despacho 15793-K Tabela IV.3)",
      "enabled": true,
      "tags": [
        "ponte térmica linear",
        "ψ",
        "fachada-cobertura",
        "continuidade isolamento"
      ]
    },
    {
      "id": "REH-PTLIN-02",
      "regulationId": "en-iso-10211",
      "article": "EN ISO 10211 — Transmitância Térmica Linear: Ligação Fachada-Pavimento Intermédio",
      "description": "A transmitância térmica linear (ψ) na ligação fachada-pavimento intermédio ({envelope.psiFloorWallJunction} W/(m·K)) excede o limite aceitável.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.psiFloorWallJunction",
          "operator": ">",
          "value": 0.45
        }
      ],
      "remediation": "Aplicar isolamento contínuo pelo exterior (ETICS) que cubra a testa da laje. Se isolamento na caixa-de-ar, prever tapa-juntas de isolamento na testa da laje com espessura mínima de 30 mm.",
      "currentValueTemplate": "ψ ligação fachada-pavimento: {envelope.psiFloorWallJunction} W/(m·K)",
      "requiredValue": "ψ ≤ 0.45 W/(m·K) na ligação fachada-pavimento intermédio",
      "enabled": true,
      "tags": [
        "ponte térmica linear",
        "ψ",
        "fachada-pavimento",
        "testa de laje"
      ]
    },
    {
      "id": "REH-PTLIN-03",
      "regulationId": "despacho-15793k-2013",
      "article": "Despacho 15793-K/2013 Tabela IV.3 — ψ Máximo por Tipo de Ligação",
      "description": "A transmitância térmica linear (ψ) na ligação fachada-pavimento térreo ({envelope.psiGroundFloorJunction} W/(m·K)) excede o valor por defeito admissível.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.psiGroundFloorJunction",
          "operator": ">",
          "value": 0.50
        },
        {
          "field": "envelope.groundFloorContact",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Aplicar isolamento perimetral vertical na fundação (XPS ≥ 50 mm) até uma profundidade de 1.0 m, ou isolamento horizontal sob a laje com recobrimento de 1.0 m na periferia. Garantir sobreposição com o isolamento da fachada.",
      "currentValueTemplate": "ψ ligação fachada-pavimento térreo: {envelope.psiGroundFloorJunction} W/(m·K)",
      "requiredValue": "ψ ≤ 0.50 W/(m·K) na ligação fachada-pavimento térreo (Despacho 15793-K Tabela IV.3)",
      "enabled": true,
      "tags": [
        "ponte térmica linear",
        "ψ",
        "pavimento térreo",
        "fundação",
        "isolamento perimetral"
      ]
    },
    {
      "id": "REH-UGFLOOR-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 Tabela I.01 — Umáx Pavimento Térreo",
      "description": "O coeficiente de transmissão térmica do pavimento térreo ({envelope.groundFloorUValue} W/(m².K)) excede o valor máximo admissível para a zona climática {location.climateZoneWinter}.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.groundFloorUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_u_ground_floors",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Isolar o pavimento térreo com XPS de alta resistência à compressão (≥ 300 kPa) sob a laje, ou aplicar isolamento perimetral. O cálculo do Ubf deve seguir a EN ISO 13370, considerando a dimensão característica do pavimento e o perímetro exposto.",
      "currentValueTemplate": "U pavimento térreo = {envelope.groundFloorUValue} W/(m².K)",
      "requiredValue": "Consultar Despacho 15793-K/2013 Tabela I.01 por zona climática ({location.climateZoneWinter}): I1 ≤ 0.50 / I2 ≤ 0.40 / I3 ≤ 0.35 W/(m².K)",
      "enabled": true,
      "tags": [
        "pavimento térreo",
        "valor-U",
        "solo",
        "isolamento",
        "lookup"
      ]
    },
    {
      "id": "REH-UGFLOOR-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 — Pavimento Térreo: Isolamento Perimetral vs. Total",
      "description": "O pavimento térreo não possui isolamento na totalidade da área nem isolamento perimetral adequado ({envelope.groundFloorInsulationType}).",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.groundFloorInsulationType",
          "operator": "==",
          "value": "none"
        },
        {
          "field": "envelope.groundFloorContact",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Aplicar isolamento na totalidade da área sob a laje (solução preferencial para zonas I2/I3) ou, no mínimo, isolamento perimetral horizontal (faixa ≥ 1.0 m) ou vertical (profundidade ≥ 1.0 m). Usar XPS com resistência à compressão ≥ 300 kPa e espessura conforme cálculo térmico.",
      "currentValueTemplate": "Tipo de isolamento pavimento térreo: {envelope.groundFloorInsulationType}",
      "requiredValue": "Isolamento total sob a laje ou, no mínimo, isolamento perimetral (faixa ≥ 1.0 m)",
      "enabled": true,
      "tags": [
        "pavimento térreo",
        "isolamento perimetral",
        "XPS",
        "EN ISO 13370"
      ]
    },
    {
      "id": "REH-UGFLOOR-03",
      "regulationId": "dl-101d-2020-nzeb",
      "article": "DL 101-D/2020 — Pavimento Térreo NZEB: Requisito Reforçado",
      "description": "O pavimento térreo de edifício NZEB não cumpre o requisito reforçado de U ≤ 0.35 W/(m².K) ({envelope.groundFloorUValue} W/(m².K)).",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.groundFloorUValue",
          "operator": ">",
          "value": 0.35
        },
        {
          "field": "thermal.nzebRequired",
          "operator": "==",
          "value": true
        },
        {
          "field": "envelope.groundFloorContact",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Para edifícios NZEB, aplicar isolamento contínuo sob toda a laje do pavimento térreo com espessura mínima de 80 mm (XPS λ ≤ 0.034 W/(m·K)). Complementar com isolamento perimetral vertical até à base da fundação.",
      "currentValueTemplate": "U pavimento térreo = {envelope.groundFloorUValue} W/(m².K)",
      "requiredValue": "U ≤ 0.35 W/(m².K) para edifícios NZEB (DL 101-D/2020)",
      "enabled": true,
      "tags": [
        "pavimento térreo",
        "NZEB",
        "valor-U",
        "requisito reforçado"
      ]
    },
    {
      "id": "REH-COBTRC-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 — Cobertura Terraço: Isolamento Térmico",
      "description": "A cobertura em terraço não possui isolamento térmico com espessura adequada ({envelope.roofTerraceInsulationThickness} mm), provocando sobreaquecimento no verão e perdas no inverno.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.roofTerraceInsulationThickness",
          "operator": "<",
          "value": 80
        },
        {
          "field": "envelope.roofType",
          "operator": "==",
          "value": "terrace"
        }
      ],
      "remediation": "Aplicar isolamento térmico na cobertura terraço com espessura mínima de 80 mm (EPS/XPS). Soluções: cobertura invertida com XPS e protecção pesada (lajetas), ou isolamento sob a impermeabilização com protecção mecânica adequada.",
      "currentValueTemplate": "Espessura isolamento cobertura terraço: {envelope.roofTerraceInsulationThickness} mm",
      "requiredValue": "≥ 80 mm de isolamento (EPS/XPS) em cobertura terraço; ≥ 100 mm para zonas I2/I3",
      "enabled": true,
      "tags": [
        "cobertura terraço",
        "isolamento",
        "cobertura invertida",
        "XPS"
      ]
    },
    {
      "id": "REH-COBTRC-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Despacho 15793-K/2013 — Cobertura Terraço: Valor U Máximo",
      "description": "O coeficiente U da cobertura terraço ({envelope.roofTerraceUValue} W/(m².K)) excede o máximo regulamentar para a zona climática.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.roofTerraceUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_u_roofs",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Reforçar o isolamento da cobertura terraço. Solução recomendada: cobertura invertida com XPS ≥ 100 mm, impermeabilização protegida, e acabamento com lajetas sobre apoios reguláveis ou camada de brita.",
      "currentValueTemplate": "U cobertura terraço = {envelope.roofTerraceUValue} W/(m².K)",
      "requiredValue": "Consultar Despacho 15793-K/2013 Tabela I.01: I1 ≤ 0.40 / I2 ≤ 0.35 / I3 ≤ 0.30 W/(m².K)",
      "enabled": true,
      "tags": [
        "cobertura terraço",
        "valor-U",
        "lookup",
        "isolamento"
      ]
    },
    {
      "id": "REH-COBTRC-03",
      "regulationId": "portaria-379a-2015",
      "article": "Portaria 379-A/2015 — Cobertura Terraço Acessível: Acabamento Reflectivo",
      "description": "A cobertura terraço acessível não possui acabamento de cor clara ou reflectivo para redução de ganhos solares no verão ({envelope.roofTerraceSRI}).",
      "severity": "info",
      "conditions": [
        {
          "field": "envelope.roofTerraceSRI",
          "operator": "<",
          "value": 50
        },
        {
          "field": "envelope.roofType",
          "operator": "==",
          "value": "terrace"
        }
      ],
      "remediation": "Aplicar acabamento de cor clara (SRI ≥ 50) na cobertura terraço: lajetas de betão claras, pintura reflectiva branca, ou membranas de impermeabilização de cor clara (PVC branco). Reduz os ganhos solares estivais em 30-50%.",
      "currentValueTemplate": "SRI (Solar Reflectance Index) cobertura terraço: {envelope.roofTerraceSRI}",
      "requiredValue": "SRI ≥ 50 (recomendado); SRI ≥ 78 para cobertura cool roof",
      "enabled": true,
      "tags": [
        "cobertura terraço",
        "reflectividade",
        "SRI",
        "cool roof",
        "verão"
      ]
    },
    {
      "id": "REH-MASSTERM-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Inércia Térmica: Aproveitamento da Massa Térmica Interior",
      "description": "O edifício com inércia térmica forte não está a aproveitar a capacidade de armazenamento térmico — o isolamento está posicionado pelo interior, reduzindo a massa útil ({envelope.insulationPosition}).",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.insulationPosition",
          "operator": "==",
          "value": "interior"
        },
        {
          "field": "thermal.thermalInertiaClass",
          "operator": "==",
          "value": "forte"
        }
      ],
      "remediation": "Quando a inércia térmica é forte, posicionar o isolamento pelo exterior (ETICS) para tirar partido da massa das paredes como regulador térmico. O isolamento pelo interior reduz a massa térmica útil e anula a vantagem da inércia forte.",
      "currentValueTemplate": "Posição do isolamento: {envelope.insulationPosition} (com inércia {thermal.thermalInertiaClass})",
      "requiredValue": "Isolamento pelo exterior (ETICS) para maximizar massa térmica útil em edifícios de inércia forte",
      "enabled": true,
      "tags": [
        "massa térmica",
        "inércia",
        "ETICS",
        "isolamento exterior",
        "armazenamento térmico"
      ]
    },
    {
      "id": "REH-MASSTERM-02",
      "regulationId": "despacho-15793k-2013",
      "article": "Despacho 15793-K/2013 — Massa Térmica: Valor It Mínimo",
      "description": "A massa superficial útil por unidade de área de pavimento ({thermal.thermalMassIt} kg/m²) é inferior ao limiar de inércia média, penalizando o desempenho energético.",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.thermalMassIt",
          "operator": "<",
          "value": 150
        }
      ],
      "remediation": "Aumentar a massa térmica interior: usar paredes interiores em alvenaria (tijolo maciço ou bloco de betão), lajes maciças expostas sem tecto falso, pavimentos cerâmicos ou em pedra natural. Evitar revestimentos leves que isolem a massa da laje (alcatifas, tectos falsos extensivos).",
      "currentValueTemplate": "It = {thermal.thermalMassIt} kg/m² (classe: {thermal.thermalInertiaClass})",
      "requiredValue": "It ≥ 150 kg/m² para classe média; It ≥ 400 kg/m² para classe forte",
      "enabled": true,
      "tags": [
        "massa térmica",
        "It",
        "inércia",
        "massa superficial útil"
      ]
    },
    {
      "id": "REH-SOBRAQV-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Sobreaquecimento Estival: Nvc Excedido",
      "description": "As necessidades nominais de energia para arrefecimento ({thermal.nvcValue} kWh/(m².ano)) excedem o valor máximo admissível ({thermal.nvcMax} kWh/(m².ano)), indicando risco de sobreaquecimento.",
      "severity": "critical",
      "conditions": [
        {
          "field": "thermal.nvcRatio",
          "operator": ">",
          "value": 1.0
        }
      ],
      "remediation": "Reduzir as necessidades de arrefecimento: instalar sombreamento exterior eficaz (portadas, estores, palas), reduzir a área de envidraçados a Sul e Oeste, usar vidros com factor solar mais baixo (g⊥ ≤ 0.35), aumentar a inércia térmica, e promover a ventilação nocturna cruzada.",
      "currentValueTemplate": "Nvc/Nv = {thermal.nvcRatio} ({thermal.nvcValue}/{thermal.nvcMax} kWh/(m².ano))",
      "requiredValue": "Nvc ≤ Nv (rácio ≤ 1.0)",
      "enabled": true,
      "tags": [
        "sobreaquecimento",
        "verão",
        "Nvc",
        "arrefecimento",
        "factor solar"
      ]
    },
    {
      "id": "REH-SOBRAQV-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Sobreaquecimento: Percentagem de Horas com Temperatura > 25°C",
      "description": "A percentagem de horas com temperatura interior acima de 25°C ({thermal.overheatingHoursPercent}%) excede o limite de conforto.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.overheatingHoursPercent",
          "operator": ">",
          "value": 5.0
        }
      ],
      "remediation": "Implementar estratégias de prevenção de sobreaquecimento: sombreamento exterior móvel, ventilação nocturna (manual ou mecânica), palas horizontais em vãos orientados a Sul, vegetação caduca em fachadas Oeste, e redução de ganhos internos.",
      "currentValueTemplate": "Horas > 25°C: {thermal.overheatingHoursPercent}% do período de arrefecimento",
      "requiredValue": "≤ 5% de horas acima de 25°C no período de arrefecimento (EN 16798-1 categoria II)",
      "enabled": true,
      "tags": [
        "sobreaquecimento",
        "conforto",
        "horas",
        "temperatura limite",
        "verão"
      ]
    },
    {
      "id": "REH-SOBRAQV-03",
      "regulationId": "portaria-379a-2015",
      "article": "Portaria 379-A/2015 — Sombreamento Exterior Obrigatório (Vãos > 5% Apav)",
      "description": "Vãos envidraçados orientados a Oeste ou Sul com área superior a 5% da área de pavimento não possuem dispositivo de sombreamento exterior ({envelope.shadingDevicePresent}).",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.shadingDevicePresent",
          "operator": "==",
          "value": false
        },
        {
          "field": "envelope.windowToFloorAreaRatioSouthWest",
          "operator": ">",
          "value": 0.05
        }
      ],
      "remediation": "Instalar dispositivos de sombreamento exterior em todos os vãos orientados a Sul e Oeste com área > 5% Apav: estores exteriores, portadas, palas, brise-soleil, ou toldos. O sombreamento interior é insuficiente (redução de apenas 20-30% dos ganhos vs. 70-80% com sombreamento exterior).",
      "currentValueTemplate": "Sem sombreamento exterior em vãos S/W > 5% Apav",
      "requiredValue": "Dispositivo de sombreamento exterior obrigatório para vãos S/W > 5% da área de pavimento (Portaria 379-A/2015)",
      "enabled": true,
      "tags": [
        "sombreamento",
        "sobreaquecimento",
        "vãos",
        "Sul",
        "Oeste",
        "prevenção"
      ]
    },
    {
      "id": "REH-NIGHTCOOL-01",
      "regulationId": "en-16798-1",
      "article": "EN 16798-1 — Potencial de Arrefecimento Nocturno",
      "description": "O edifício em zona V2/V3 não dispõe de estratégia de ventilação nocturna para dissipação do calor acumulado durante o dia ({thermal.nightVentilationStrategy}).",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.nightVentilationStrategy",
          "operator": "==",
          "value": "none"
        },
        {
          "field": "location.climateZoneSummer",
          "operator": "in",
          "value": [
            "V2",
            "V3"
          ]
        }
      ],
      "remediation": "Implementar ventilação nocturna cruzada (Junho-Setembro): janelas opostas com abertura controlada, ou sistema de ventilação mecânica com bypass do recuperador. Taxa de renovação nocturna recomendada: ≥ 4 Rph. Eficácia depende da amplitude térmica diária (ΔT ≥ 8°C).",
      "currentValueTemplate": "Estratégia de ventilação nocturna: {thermal.nightVentilationStrategy}",
      "requiredValue": "Ventilação nocturna cruzada ou mecânica em zonas V2/V3 (caudal ≥ 4 Rph)",
      "enabled": true,
      "tags": [
        "arrefecimento nocturno",
        "ventilação",
        "verão",
        "V2",
        "V3",
        "passivo"
      ]
    },
    {
      "id": "REH-NIGHTCOOL-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Ventilação Nocturna: Segurança e Eficácia",
      "description": "O sistema de ventilação nocturna não garante segurança contra intrusão nem eficácia de ventilação ({thermal.nightVentilationSecure}).",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.nightVentilationSecure",
          "operator": "==",
          "value": false
        },
        {
          "field": "thermal.nightVentilationStrategy",
          "operator": "!=",
          "value": "none"
        }
      ],
      "remediation": "Garantir ventilação nocturna segura: usar janelas com abertura basculante limitada (≤ 100 mm), grelhas de ventilação com rede anti-intrusão, ou ventilação mecânica com bypass nocturno. Automatizar o controlo com sensor de temperatura exterior (activar quando Text < 22°C).",
      "currentValueTemplate": "Ventilação nocturna sem garantia de segurança anti-intrusão",
      "requiredValue": "Ventilação nocturna com sistema anti-intrusão e controlo automático por temperatura",
      "enabled": true,
      "tags": [
        "arrefecimento nocturno",
        "segurança",
        "automação",
        "ventilação"
      ]
    },
    {
      "id": "REH-PISORAD-01",
      "regulationId": "en-16798-1",
      "article": "EN 16798-1 — Temperatura Máxima da Superfície do Piso Radiante",
      "description": "A temperatura máxima da superfície do piso radiante ({thermal.underfloorMaxSurfaceTemp}°C) excede o limite de conforto.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.underfloorMaxSurfaceTemp",
          "operator": ">",
          "value": 29
        },
        {
          "field": "thermal.hasUnderfloorHeating",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Limitar a temperatura da superfície do piso radiante a 29°C nas zonas de permanência prolongada (salas, quartos). Em casas de banho e zonas periféricas, o limite pode ser 35°C. Regular a temperatura da água de ida e o espaçamento dos tubos.",
      "currentValueTemplate": "Temperatura superfície piso radiante: {thermal.underfloorMaxSurfaceTemp}°C",
      "requiredValue": "≤ 29°C em zonas de permanência; ≤ 35°C em casas de banho/zonas periféricas (EN 1264-2)",
      "enabled": true,
      "tags": [
        "piso radiante",
        "temperatura superfície",
        "conforto",
        "aquecimento"
      ]
    },
    {
      "id": "REH-PISORAD-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Piso Radiante: Resistência Térmica do Revestimento",
      "description": "A resistência térmica do revestimento do pavimento sobre o piso radiante ({thermal.floorCoveringResistance} m².K/W) é excessiva, reduzindo a eficiência do sistema.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.floorCoveringResistance",
          "operator": ">",
          "value": 0.15
        },
        {
          "field": "thermal.hasUnderfloorHeating",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Usar revestimentos de pavimento com baixa resistência térmica sobre piso radiante: cerâmica ou pedra (R ≈ 0.01-0.03 m².K/W), betão afagado, microcimento. Evitar alcatifas (R > 0.15) e soalho de madeira espesso (R > 0.10). Se madeira, usar soalho flutuante ≤ 8 mm.",
      "currentValueTemplate": "R revestimento pavimento: {thermal.floorCoveringResistance} m².K/W",
      "requiredValue": "R ≤ 0.15 m².K/W para revestimento sobre piso radiante (idealmente ≤ 0.10)",
      "enabled": true,
      "tags": [
        "piso radiante",
        "revestimento",
        "resistência térmica",
        "eficiência"
      ]
    },
    {
      "id": "REH-ISOPISORAD-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Isolamento Sob Piso Radiante sobre Solo",
      "description": "O isolamento sob o piso radiante em contacto com o solo ({envelope.underfloorHeatingGroundInsulation} mm) é insuficiente, provocando perdas térmicas significativas para o terreno.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.underfloorHeatingGroundInsulation",
          "operator": "<",
          "value": 80
        },
        {
          "field": "thermal.hasUnderfloorHeating",
          "operator": "==",
          "value": true
        },
        {
          "field": "envelope.groundFloorContact",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Aplicar isolamento rígido (XPS ≥ 300 kPa) com espessura mínima de 80 mm sob o sistema de piso radiante quando em contacto com o solo. Incluir barreira pára-vapor na face quente. A resistência térmica do isolamento deve ser ≥ 2.0 m².K/W.",
      "currentValueTemplate": "Espessura isolamento sob piso radiante (sobre solo): {envelope.underfloorHeatingGroundInsulation} mm",
      "requiredValue": "≥ 80 mm (XPS, λ ≤ 0.034) sob piso radiante sobre solo (R ≥ 2.0 m².K/W)",
      "enabled": true,
      "tags": [
        "piso radiante",
        "isolamento",
        "solo",
        "XPS",
        "perdas para baixo"
      ]
    },
    {
      "id": "REH-ISOPISORAD-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Isolamento Sob Piso Radiante sobre Laje Interior",
      "description": "O isolamento sob o piso radiante sobre laje interior ({envelope.underfloorHeatingInteriorInsulation} mm) é insuficiente para direccionar o calor para cima.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.underfloorHeatingInteriorInsulation",
          "operator": "<",
          "value": 50
        },
        {
          "field": "thermal.hasUnderfloorHeating",
          "operator": "==",
          "value": true
        },
        {
          "field": "envelope.groundFloorContact",
          "operator": "==",
          "value": false
        }
      ],
      "remediation": "Colocar painéis de isolamento com plots (EPS ≥ 30 mm + altura plot) ou placas rígidas de EPS/XPS (≥ 50 mm) sob as tubagens. Garantir que a resistência térmica do isolamento é pelo menos 3× a resistência térmica do revestimento de pavimento acima.",
      "currentValueTemplate": "Espessura isolamento sob piso radiante (laje interior): {envelope.underfloorHeatingInteriorInsulation} mm",
      "requiredValue": "≥ 50 mm (EPS/XPS) sob piso radiante sobre laje interior",
      "enabled": true,
      "tags": [
        "piso radiante",
        "isolamento",
        "laje interior",
        "direccionalidade térmica"
      ]
    },
    {
      "id": "REH-PMV-01",
      "regulationId": "en-16798-1",
      "article": "EN 16798-1 / ISO 7730 — Índice PMV: Voto Médio Previsível",
      "description": "O índice PMV (Predicted Mean Vote) calculado ({thermal.pmvIndex}) está fora do intervalo de conforto para a categoria especificada.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.pmvIndex",
          "operator": "not_in_range",
          "value": [
            -0.5,
            0.5
          ]
        }
      ],
      "remediation": "Ajustar as condições térmicas para obter PMV entre -0.5 e +0.5 (categoria II): verificar temperatura operativa, humidade relativa, velocidade do ar, e taxa metabólica/vestuário assumidos. Ajustar setpoints de aquecimento/arrefecimento conforme necessário.",
      "currentValueTemplate": "PMV = {thermal.pmvIndex}",
      "requiredValue": "-0.5 ≤ PMV ≤ +0.5 para categoria II (EN 16798-1); -0.2 ≤ PMV ≤ +0.2 para categoria I",
      "enabled": true,
      "tags": [
        "conforto térmico",
        "PMV",
        "ISO 7730",
        "categoria II"
      ]
    },
    {
      "id": "REH-PPD-01",
      "regulationId": "en-16798-1",
      "article": "EN 16798-1 / ISO 7730 — Índice PPD: Percentagem de Insatisfeitos",
      "description": "A percentagem previsível de insatisfeitos (PPD) ({thermal.ppdPercent}%) excede o limite de conforto.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.ppdPercent",
          "operator": ">",
          "value": 10
        }
      ],
      "remediation": "Reduzir o PPD para ≤ 10% (categoria II): melhorar isolamento da envolvente para reduzir assimetrias radiantes, controlar correntes de ar frio, garantir temperatura do pavimento entre 19-29°C, e eliminar gradientes verticais de temperatura > 3°C.",
      "currentValueTemplate": "PPD = {thermal.ppdPercent}%",
      "requiredValue": "PPD ≤ 10% para categoria II; PPD ≤ 6% para categoria I",
      "enabled": true,
      "tags": [
        "conforto térmico",
        "PPD",
        "ISO 7730",
        "insatisfeitos"
      ]
    },
    {
      "id": "REH-ZONTERM-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Zonamento Térmico: Separação de Espaços Aquecidos/Não Aquecidos",
      "description": "Não existe separação térmica adequada entre espaços aquecidos e espaços não úteis (ENU) com btr ≥ 0.7 ({envelope.enuSeparationUValue} W/(m².K)).",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.enuSeparationUValue",
          "operator": ">",
          "value": 0.8
        },
        {
          "field": "envelope.enuBtr",
          "operator": ">=",
          "value": 0.7
        }
      ],
      "remediation": "Isolar a envolvente interior que separa espaços aquecidos de ENU com btr ≥ 0.7 (garagens, arrumos, desvão). Aplicar isolamento com U ≤ 0.80 W/(m².K). Para btr ≥ 0.8, considerar requisitos mais exigentes equivalentes à envolvente exterior.",
      "currentValueTemplate": "U separação espaço aquecido/ENU: {envelope.enuSeparationUValue} W/(m².K) (btr={envelope.enuBtr})",
      "requiredValue": "U ≤ 0.80 W/(m².K) para separação com ENU (btr ≥ 0.7)",
      "enabled": true,
      "tags": [
        "zonamento térmico",
        "ENU",
        "btr",
        "envolvente interior"
      ]
    },
    {
      "id": "REH-ZONTERM-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Zonamento Térmico: Definição de btr",
      "description": "O coeficiente de redução de perdas (btr) do espaço não útil não foi calculado ou está incorrectamente definido ({envelope.enuBtrDefined}).",
      "severity": "info",
      "conditions": [
        {
          "field": "envelope.enuBtrDefined",
          "operator": "==",
          "value": false
        },
        {
          "field": "envelope.hasENU",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Calcular o btr de cada ENU conforme a Tabela 3 da Portaria 349-B/2013, em função do volume do ENU, da taxa de ventilação, e das áreas de envolvente interior/exterior. Valores típicos: garagem fechada btr ≈ 0.8; desvão ventilado btr ≈ 0.9; caixa de escada btr ≈ 0.6.",
      "currentValueTemplate": "btr do ENU não definido",
      "requiredValue": "btr calculado para cada ENU conforme Tabela 3 da Portaria 349-B/2013",
      "enabled": true,
      "tags": [
        "zonamento térmico",
        "btr",
        "ENU",
        "coeficiente redução"
      ]
    },
    {
      "id": "REH-ARREFPASS-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Estratégia de Arrefecimento Passivo: Ventilação Cruzada",
      "description": "O edifício em zona V2/V3 não possui condições para ventilação cruzada natural eficaz ({thermal.crossVentilationPossible}).",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.crossVentilationPossible",
          "operator": "==",
          "value": false
        },
        {
          "field": "location.climateZoneSummer",
          "operator": "in",
          "value": [
            "V2",
            "V3"
          ]
        }
      ],
      "remediation": "Garantir condições para ventilação cruzada: aberturas em fachadas opostas, com rácio de área livre ≥ 2% da área de pavimento. Orientar as aberturas para captar brisas predominantes. Assegurar percurso do ar desobstruído entre fachadas (portas interiores com grelhas ou folga).",
      "currentValueTemplate": "Ventilação cruzada: {thermal.crossVentilationPossible}",
      "requiredValue": "Ventilação cruzada obrigatória em zonas V2/V3 (aberturas em fachadas opostas ≥ 2% Apav)",
      "enabled": true,
      "tags": [
        "arrefecimento passivo",
        "ventilação cruzada",
        "verão",
        "V2",
        "V3"
      ]
    },
    {
      "id": "REH-ARREFPASS-02",
      "regulationId": "en-16798-1",
      "article": "EN 16798-1 — Arrefecimento Passivo: Sombreamento Exterior Orientação Oeste",
      "description": "Os vãos orientados a Oeste (±45°) não possuem sombreamento exterior eficaz, sendo a orientação com maior risco de sobreaquecimento ({envelope.westWindowShading}).",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.westWindowShading",
          "operator": "==",
          "value": "none"
        },
        {
          "field": "envelope.hasWestFacingWindows",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Instalar sombreamento exterior nos vãos a Oeste (orientação com sol rasante ao fim da tarde, difícil de sombrear com palas fixas): estores exteriores com lâminas orientáveis, portadas exteriores, ou brise-soleil vertical. Factor solar com protecção gT ≤ 0.25 recomendado.",
      "currentValueTemplate": "Sombreamento vãos Oeste: {envelope.westWindowShading}",
      "requiredValue": "Sombreamento exterior obrigatório em vãos Oeste: gT ≤ 0.25 com protecção activada",
      "enabled": true,
      "tags": [
        "arrefecimento passivo",
        "sombreamento",
        "Oeste",
        "gT",
        "sobreaquecimento"
      ]
    },
    {
      "id": "REH-ARREFPASS-03",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Arrefecimento Passivo: Coberturas Verdes/Ajardinadas",
      "description": "A cobertura plana não utiliza cobertura verde/ajardinada como estratégia de arrefecimento passivo em zona V3 ({envelope.greenRoofPresent}).",
      "severity": "info",
      "conditions": [
        {
          "field": "envelope.greenRoofPresent",
          "operator": "==",
          "value": false
        },
        {
          "field": "location.climateZoneSummer",
          "operator": "==",
          "value": "V3"
        },
        {
          "field": "envelope.roofType",
          "operator": "in",
          "value": [
            "flat",
            "terrace"
          ]
        }
      ],
      "remediation": "Considerar cobertura verde extensiva (sedum, gramíneas) sobre a impermeabilização: reduz a temperatura superficial em 20-30°C no verão, melhora o isolamento acústico, retém águas pluviais. Requer impermeabilização anti-raízes e camada drenante.",
      "currentValueTemplate": "Cobertura verde: {envelope.greenRoofPresent}",
      "requiredValue": "Recomendado: cobertura verde extensiva em zona V3 com cobertura plana",
      "enabled": true,
      "tags": [
        "arrefecimento passivo",
        "cobertura verde",
        "V3",
        "sustentabilidade"
      ]
    },
    {
      "id": "REH-ENVCONT-01",
      "regulationId": "en-iso-10211",
      "article": "EN ISO 10211 — Continuidade da Envolvente Térmica: Descontinuidades de Isolamento",
      "description": "Foram identificadas descontinuidades no isolamento da envolvente térmica ({envelope.insulationDiscontinuities} pontos), comprometendo o desempenho global.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.insulationDiscontinuities",
          "operator": ">",
          "value": 0
        }
      ],
      "remediation": "Eliminar todas as descontinuidades no isolamento da envolvente: garantir sobreposição de isolamento em todas as juntas, tratar pontos singulares (pilares, vigas de bordo, caixas de estore, contorno de vãos). Usar pormenores construtivos tipo de continuidade ETICS. Verificar com termografia após execução.",
      "currentValueTemplate": "Descontinuidades de isolamento: {envelope.insulationDiscontinuities} ponto(s)",
      "requiredValue": "0 descontinuidades de isolamento na envolvente térmica",
      "enabled": true,
      "tags": [
        "continuidade",
        "envolvente",
        "isolamento",
        "descontinuidades",
        "ETICS"
      ]
    },
    {
      "id": "REH-ENVCONT-02",
      "regulationId": "en-iso-10211",
      "article": "EN ISO 10211 — Continuidade da Envolvente: Ligação Caixilharia-Parede",
      "description": "A ligação entre a caixilharia e o isolamento da parede não está correctamente executada, existindo ponte térmica no contorno do vão ({envelope.windowFrameInsulationOverlap}).",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.windowFrameInsulationOverlap",
          "operator": "<",
          "value": 30
        }
      ],
      "remediation": "Garantir sobreposição do isolamento (ETICS) com o aro da caixilharia em pelo menos 30 mm. Usar pré-aros isolantes ou perfis de encaixe. Selar a junta entre o aro e a parede com fita de estanquidade expansiva e espuma de poliuretano. Rematar com perfil de pingadeira.",
      "currentValueTemplate": "Sobreposição isolamento-caixilharia: {envelope.windowFrameInsulationOverlap} mm",
      "requiredValue": "≥ 30 mm de sobreposição do isolamento com o aro da caixilharia",
      "enabled": true,
      "tags": [
        "continuidade",
        "caixilharia",
        "ponte térmica",
        "contorno de vão",
        "ETICS"
      ]
    },
    {
      "id": "REH-WWR-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Rácio Envidraçado/Parede: Impacto Térmico",
      "description": "O rácio envidraçado/parede (WWR) da fachada ({envelope.windowToWallRatio}%) é excessivo, comprometendo o desempenho térmico de inverno e verão.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.windowToWallRatio",
          "operator": ">",
          "value": 40
        }
      ],
      "remediation": "Limitar o WWR a ≤ 40% ou compensar com: vidro triplo (Uw ≤ 1.4), sombreamento exterior em todas as orientações, factor solar do vidro g⊥ ≤ 0.35 para vãos S/W. Verificar que Nvc e Nic permanecem dentro dos limites com a área de envidraçado proposta.",
      "currentValueTemplate": "WWR (Window-to-Wall Ratio): {envelope.windowToWallRatio}%",
      "requiredValue": "WWR ≤ 40% (recomendado); WWR > 40% requer compensação com vidro alto desempenho e sombreamento",
      "enabled": true,
      "tags": [
        "WWR",
        "envidraçado",
        "rácio",
        "fachada",
        "impacto térmico"
      ]
    },
    {
      "id": "REH-WWR-02",
      "regulationId": "dl-101d-2020-nzeb",
      "article": "DL 101-D/2020 — WWR em Edifício NZEB: Requisito de Compensação",
      "description": "O edifício NZEB com WWR > 30% não compensa o excesso de envidraçado com medidas adicionais ({envelope.windowToWallRatio}%).",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.windowToWallRatio",
          "operator": ">",
          "value": 30
        },
        {
          "field": "thermal.nzebRequired",
          "operator": "==",
          "value": true
        },
        {
          "field": "thermal.nzebWwrCompensation",
          "operator": "==",
          "value": false
        }
      ],
      "remediation": "Para edifícios NZEB com WWR > 30%: usar vidro triplo low-e com Uw ≤ 1.2 W/(m².K), sombreamento exterior automatizado, e demonstrar que Nic/Nvc não excedem 75% dos valores de referência. Considerar redução de área de envidraçados nas fachadas Este e Oeste.",
      "currentValueTemplate": "WWR = {envelope.windowToWallRatio}% (NZEB sem compensação)",
      "requiredValue": "WWR ≤ 30% ou compensação documentada (vidro triplo + sombreamento) em NZEB",
      "enabled": true,
      "tags": [
        "WWR",
        "NZEB",
        "envidraçado",
        "compensação",
        "vidro triplo"
      ]
    },
    {
      "id": "REH-PARTROMBE-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Parede de Armazenamento Térmico (Trombe): Espessura",
      "description": "A parede de armazenamento térmico (Trombe) tem espessura insuficiente ({thermal.trombeWallThickness} mm) para proporcionar desfasamento térmico adequado.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.trombeWallThickness",
          "operator": "<",
          "value": 200
        },
        {
          "field": "thermal.hasTrombeWall",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "A parede Trombe deve ter espessura entre 200-400 mm (betão) ou 250-350 mm (alvenaria maciça) para desfasamento térmico de 8-12 horas. Usar materiais de elevada capacidade térmica: betão (ρ ≥ 2200 kg/m³), tijolo maciço, ou materiais de mudança de fase (PCM).",
      "currentValueTemplate": "Espessura parede Trombe: {thermal.trombeWallThickness} mm",
      "requiredValue": "200-400 mm (betão) ou 250-350 mm (alvenaria maciça) para desfasamento 8-12h",
      "enabled": true,
      "tags": [
        "parede Trombe",
        "armazenamento térmico",
        "massa térmica",
        "passivo solar"
      ]
    },
    {
      "id": "REH-PARTROMBE-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Parede Trombe: Orientação e Envidraçado",
      "description": "A parede Trombe não está orientada a Sul (±15°) ou não possui envidraçado adequado ({thermal.trombeWallOrientation}, {thermal.trombeWallGlazing}).",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.trombeWallOrientationDeviation",
          "operator": ">",
          "value": 15
        },
        {
          "field": "thermal.hasTrombeWall",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "A parede Trombe deve estar orientada a Sul (±15°) e possuir envidraçado com elevada transmissão solar (vidro simples ou duplo claro, τ ≥ 0.75). Prever aberturas de ventilação na base e no topo da parede para circulação do ar aquecido (efeito termossifão). Incluir sombreamento exterior para o verão.",
      "currentValueTemplate": "Orientação parede Trombe: desvio de {thermal.trombeWallOrientationDeviation}° do Sul",
      "requiredValue": "Orientação Sul ± 15°; envidraçado com τ ≥ 0.75; aberturas de termossifão",
      "enabled": true,
      "tags": [
        "parede Trombe",
        "orientação",
        "Sul",
        "envidraçado",
        "termossifão"
      ]
    },
    {
      "id": "REH-SUNSPACE-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Estufa Solar (Sunspace): Separação Térmica",
      "description": "A estufa solar (sunspace) não possui separação térmica adequada do espaço aquecido ({thermal.sunspaceSeparationUValue} W/(m².K)).",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.sunspaceSeparationUValue",
          "operator": ">",
          "value": 1.5
        },
        {
          "field": "thermal.hasSunspace",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "A parede de separação entre a estufa e o espaço aquecido deve ter U ≤ 1.5 W/(m².K) e incluir aberturas reguláveis para captar ganhos solares no inverno e impedir sobreaquecimento. Prever: porta/janela estanque, massa térmica na parede de separação (cor escura), e ventilação da estufa no verão.",
      "currentValueTemplate": "U separação estufa-espaço aquecido: {thermal.sunspaceSeparationUValue} W/(m².K)",
      "requiredValue": "U ≤ 1.5 W/(m².K) na separação estufa-espaço aquecido; com massa térmica e aberturas reguláveis",
      "enabled": true,
      "tags": [
        "estufa solar",
        "sunspace",
        "separação térmica",
        "passivo solar"
      ]
    },
    {
      "id": "REH-SUNSPACE-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Estufa Solar: Ventilação Estival",
      "description": "A estufa solar não possui sistema de ventilação adequado para o verão, causando risco de sobreaquecimento ({thermal.sunspaceSummerVentilation}).",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.sunspaceSummerVentilation",
          "operator": "==",
          "value": false
        },
        {
          "field": "thermal.hasSunspace",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Prever aberturas de ventilação na estufa para o verão: ≥ 30% da área de envidraçado como área de abertura. Incluir aberturas superiores e inferiores para efeito chaminé. Sombreamento exterior (estores, toldos) ou vegetação caduca. Fechar a comunicação com o espaço aquecido no verão.",
      "currentValueTemplate": "Ventilação estival da estufa: {thermal.sunspaceSummerVentilation}",
      "requiredValue": "Aberturas de ventilação ≥ 30% da área de envidraçado da estufa; sombreamento exterior",
      "enabled": true,
      "tags": [
        "estufa solar",
        "ventilação",
        "verão",
        "sobreaquecimento"
      ]
    },
    {
      "id": "REH-CONSERV-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Conservatório/Jardim de Inverno: Separação Térmica",
      "description": "O conservatório (jardim de inverno) não possui separação térmica do espaço habitável ({thermal.conservatorySeparation}).",
      "severity": "critical",
      "conditions": [
        {
          "field": "thermal.conservatorySeparation",
          "operator": "==",
          "value": false
        },
        {
          "field": "thermal.hasConservatory",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "O conservatório deve ser termicamente separado do espaço aquecido com: parede com isolamento (U ≤ 1.5 W/(m².K)), portas/janelas com vedação estanque, e caixilharia com corte térmico. Sem separação, o conservatório é contabilizado como espaço aquecido e os seus envidraçados penalizam Nic e Nvc.",
      "currentValueTemplate": "Separação térmica do conservatório: {thermal.conservatorySeparation}",
      "requiredValue": "Separação térmica obrigatória: parede isolada U ≤ 1.5 + caixilharia estanque",
      "enabled": true,
      "tags": [
        "conservatório",
        "jardim de inverno",
        "separação térmica",
        "envolvente"
      ]
    },
    {
      "id": "REH-CONSERV-02",
      "regulationId": "despacho-15793k-2013",
      "article": "Despacho 15793-K/2013 — Conservatório: Factor de Temperatura btr",
      "description": "O conservatório termicamente separado não tem o btr correctamente calculado para contabilização das perdas ({thermal.conservatoryBtr}).",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.conservatoryBtrDefined",
          "operator": "==",
          "value": false
        },
        {
          "field": "thermal.hasConservatory",
          "operator": "==",
          "value": true
        },
        {
          "field": "thermal.conservatorySeparation",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Calcular o btr do conservatório conforme a Tabela 3 da Portaria 349-B/2013, em função do volume, ventilação e áreas de envolvente. Valores típicos: conservatório envidraçado btr ≈ 0.8 (inverno) a 1.0 (verão). O btr influencia o cálculo de Nic e Nvc através da envolvente interior.",
      "currentValueTemplate": "btr do conservatório: não definido",
      "requiredValue": "btr calculado conforme Tabela 3 (Portaria 349-B/2013)",
      "enabled": true,
      "tags": [
        "conservatório",
        "btr",
        "envolvente interior",
        "cálculo térmico"
      ]
    },
    {
      "id": "REH-CORTTERM-01",
      "regulationId": "en-16798-1",
      "article": "EN 16798-1 — Cortinas Térmicas: Resistência Térmica Adicional",
      "description": "As cortinas interiores utilizadas como complemento térmico têm resistência térmica insuficiente ({thermal.thermalCurtainResistance} m².K/W).",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.thermalCurtainResistance",
          "operator": "<",
          "value": 0.10
        },
        {
          "field": "thermal.hasThermalCurtains",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Para contribuição térmica eficaz, as cortinas devem ter resistência térmica ≥ 0.10 m².K/W: cortinas com forro térmico (tecido+alumínio), cortinas blackout pesadas (≥ 300 g/m²), ou cortinas duplas (voile + cortina pesada). Instalar com vedação lateral (calhas laterais) e pelmet superior para minimizar convecção.",
      "currentValueTemplate": "R cortinas térmicas: {thermal.thermalCurtainResistance} m².K/W",
      "requiredValue": "R ≥ 0.10 m².K/W para contribuição térmica significativa; R ≥ 0.25 com vedação lateral",
      "enabled": true,
      "tags": [
        "cortinas térmicas",
        "resistência térmica",
        "envidraçados",
        "complemento nocturno"
      ]
    },
    {
      "id": "REH-CORTTERM-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Protecção Nocturna de Envidraçados",
      "description": "Os envidraçados de grande dimensão não possuem protecção nocturna (portadas, estores, cortinas térmicas) para redução de perdas térmicas ({envelope.nightInsulationPresent}).",
      "severity": "info",
      "conditions": [
        {
          "field": "envelope.nightInsulationPresent",
          "operator": "==",
          "value": false
        },
        {
          "field": "envelope.windowToWallRatio",
          "operator": ">",
          "value": 25
        }
      ],
      "remediation": "Instalar protecção nocturna nos envidraçados: portadas exteriores de madeira (R ≈ 0.20 m².K/W), estores de enrolar com caixa isolada, ou cortinas térmicas com vedação. A protecção nocturna pode reduzir as perdas térmicas pelos vãos em 30-50% durante a noite.",
      "currentValueTemplate": "Protecção nocturna de envidraçados: {envelope.nightInsulationPresent}",
      "requiredValue": "Protecção nocturna recomendada para WWR > 25%: portadas, estores isolados ou cortinas térmicas",
      "enabled": true,
      "tags": [
        "protecção nocturna",
        "envidraçados",
        "portadas",
        "estores",
        "perdas térmicas"
      ]
    },
    {
      "id": "REH-CORTEVAR-01",
      "regulationId": "en-iso-10211",
      "article": "EN ISO 10211 — Corte Térmico em Varandas: Requisito de ψ",
      "description": "A varanda em consola não possui elemento de corte térmico, resultando em transmitância linear excessiva ({envelope.balconyPsiValue} W/(m·K)).",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.balconyPsiValue",
          "operator": ">",
          "value": 0.50
        },
        {
          "field": "envelope.hasBalcony",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Instalar elemento de corte térmico estrutural (Schöck Isokorb, Halfen HIT, ou equivalente) na ligação laje-varanda. Reduz ψ de ~1.0-1.2 para ≤ 0.15 W/(m·K). Dimensionar conforme as cargas estruturais (flexão, corte, momento). Alternativa: varanda autoportante com apoio independente.",
      "currentValueTemplate": "ψ varanda: {envelope.balconyPsiValue} W/(m·K)",
      "requiredValue": "ψ ≤ 0.50 W/(m·K) na ligação laje-varanda; ≤ 0.15 com corte térmico",
      "enabled": true,
      "tags": [
        "varanda",
        "corte térmico",
        "Isokorb",
        "ψ",
        "ponte térmica"
      ]
    },
    {
      "id": "REH-CORTEVAR-02",
      "regulationId": "dl-101d-2020-nzeb",
      "article": "DL 101-D/2020 — NZEB: Corte Térmico Obrigatório em Varandas",
      "description": "O edifício NZEB não possui corte térmico em todas as varandas em consola ({envelope.balconyThermalBreakAll}).",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.balconyThermalBreakAll",
          "operator": "==",
          "value": false
        },
        {
          "field": "thermal.nzebRequired",
          "operator": "==",
          "value": true
        },
        {
          "field": "envelope.hasBalcony",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Para edifícios NZEB, o corte térmico em varandas é considerado indispensável. Instalar elementos de corte térmico certificados em todas as varandas em consola. Verificar compatibilidade com o sistema estrutural e impermeabilização. Documentar valores de ψ por tipo de ligação.",
      "currentValueTemplate": "Corte térmico em todas as varandas NZEB: {envelope.balconyThermalBreakAll}",
      "requiredValue": "Corte térmico obrigatório em todas as varandas de edifícios NZEB (ψ ≤ 0.20)",
      "enabled": true,
      "tags": [
        "varanda",
        "NZEB",
        "corte térmico",
        "obrigatório"
      ]
    },
    {
      "id": "REH-TERMOG-01",
      "regulationId": "dl-118-2013-sce",
      "article": "DL 118/2013 SCE — Termografia: Verificação da Envolvente",
      "description": "Não foi realizada inspecção termográfica da envolvente do edifício para verificação da continuidade do isolamento e detecção de anomalias ({thermal.thermographyPerformed}).",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.thermographyPerformed",
          "operator": "==",
          "value": false
        },
        {
          "field": "thermal.buildingPhase",
          "operator": "==",
          "value": "completed"
        }
      ],
      "remediation": "Realizar inspecção termográfica da envolvente após conclusão da obra e antes da certificação energética: câmara de infravermelhos com resolução ≥ 320×240 pixels, ΔT interior-exterior ≥ 10°C, sem incidência solar directa nas 12h anteriores. Verificar: continuidade do isolamento, pontes térmicas, infiltrações de ar.",
      "currentValueTemplate": "Inspecção termográfica: {thermal.thermographyPerformed}",
      "requiredValue": "Inspecção termográfica recomendada após conclusão da obra (EN 13187)",
      "enabled": true,
      "tags": [
        "termografia",
        "inspecção",
        "envolvente",
        "EN 13187",
        "verificação"
      ]
    },
    {
      "id": "REH-TERMOG-02",
      "regulationId": "en-iso-10211",
      "article": "EN ISO 10211 / EN 13187 — Termografia: Condições de Ensaio",
      "description": "A inspecção termográfica foi realizada sem condições adequadas (ΔT < 10°C ou com incidência solar), invalidando os resultados ({thermal.thermographyConditionsValid}).",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.thermographyConditionsValid",
          "operator": "==",
          "value": false
        },
        {
          "field": "thermal.thermographyPerformed",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Repetir a inspecção termográfica em condições válidas conforme EN 13187: ΔT interior-exterior ≥ 10°C, sem incidência solar directa nas 12h anteriores, sem chuva nas 24h anteriores, velocidade do vento < 5 m/s. Período ideal: noite ou madrugada no inverno.",
      "currentValueTemplate": "Condições de ensaio termográfico: inválidas",
      "requiredValue": "ΔT ≥ 10°C, sem sol directo 12h, sem chuva 24h, vento < 5 m/s (EN 13187)",
      "enabled": true,
      "tags": [
        "termografia",
        "condições ensaio",
        "EN 13187",
        "ΔT"
      ]
    },
    {
      "id": "REH-TERMOG-03",
      "regulationId": "dl-118-2013-sce",
      "article": "DL 118/2013 SCE — Termografia: Detecção de Anomalias",
      "description": "A inspecção termográfica revelou anomalias térmicas na envolvente ({thermal.thermographyAnomaliesCount} anomalias detectadas).",
      "severity": "critical",
      "conditions": [
        {
          "field": "thermal.thermographyAnomaliesCount",
          "operator": ">",
          "value": 0
        },
        {
          "field": "thermal.thermographyPerformed",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Corrigir as anomalias detectadas na termografia: isolamento em falta ou mal aplicado, pontes térmicas não tratadas, infiltrações de ar. Classificar cada anomalia por gravidade e priorizar a correcção. Repetir termografia após intervenção para confirmar resolução.",
      "currentValueTemplate": "Anomalias termográficas: {thermal.thermographyAnomaliesCount}",
      "requiredValue": "0 anomalias térmicas na envolvente após construção/reabilitação",
      "enabled": true,
      "tags": [
        "termografia",
        "anomalias",
        "envolvente",
        "correcção"
      ]
    },
    {
      "id": "REH-COMMISS-01",
      "regulationId": "dl-118-2013-sce",
      "article": "DL 118/2013 SCE — Comissionamento Térmico: Verificação de Sistemas",
      "description": "O comissionamento térmico dos sistemas de climatização não foi realizado antes da ocupação ({thermal.thermalCommissioningCompleted}).",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.thermalCommissioningCompleted",
          "operator": "==",
          "value": false
        },
        {
          "field": "thermal.buildingPhase",
          "operator": "==",
          "value": "completed"
        }
      ],
      "remediation": "Realizar comissionamento térmico antes da ocupação: verificar caudais de ventilação em cada compartimento, calibrar termostatos e sensores, testar modos de operação (aquecimento, arrefecimento, ventilação), medir temperaturas de insuflação, verificar equilíbrio hidráulico. Registar todos os valores medidos.",
      "currentValueTemplate": "Comissionamento térmico: {thermal.thermalCommissioningCompleted}",
      "requiredValue": "Comissionamento térmico completo antes da ocupação (DL 118/2013 Art. 14.°)",
      "enabled": true,
      "tags": [
        "comissionamento",
        "sistemas",
        "climatização",
        "verificação"
      ]
    },
    {
      "id": "REH-COMMISS-02",
      "regulationId": "dl-118-2013-sce",
      "article": "DL 118/2013 SCE — Comissionamento: Verificação de Caudais de Ventilação",
      "description": "Os caudais de ventilação medidos durante o comissionamento desviam-se mais de 15% dos valores de projecto ({thermal.ventilationCommissioningDeviation}%).",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.ventilationCommissioningDeviation",
          "operator": ">",
          "value": 15
        },
        {
          "field": "thermal.thermalCommissioningCompleted",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Ajustar os caudais de ventilação para dentro de ±15% dos valores de projecto: regular as grelhas de insuflação/extracção, ajustar a velocidade do ventilador, limpar ou substituir filtros. Usar anemómetro calibrado para medição. Documentar caudais medidos vs. projectados em cada boca.",
      "currentValueTemplate": "Desvio caudais ventilação: {thermal.ventilationCommissioningDeviation}% vs. projecto",
      "requiredValue": "Desvio ≤ ±15% entre caudais medidos e projectados",
      "enabled": true,
      "tags": [
        "comissionamento",
        "ventilação",
        "caudais",
        "medição"
      ]
    },
    {
      "id": "REH-COMMISS-03",
      "regulationId": "dl-118-2013-sce",
      "article": "DL 118/2013 SCE — Comissionamento: Teste de Estanquidade",
      "description": "O teste de estanquidade ao ar (blower door) não foi realizado como parte do comissionamento ({thermal.blowerDoorTestPerformed}).",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.blowerDoorTestPerformed",
          "operator": "==",
          "value": false
        },
        {
          "field": "thermal.buildingPhase",
          "operator": "==",
          "value": "completed"
        }
      ],
      "remediation": "Realizar teste blower door conforme EN 13829/ISO 9972: pressurizar o edifício a 50 Pa e medir o caudal de fuga (n50). Para edifícios novos REH: n50 ≤ 4.0 Rph (mínimo); NZEB: n50 ≤ 3.0 Rph (recomendado ≤ 1.0). Identificar fugas com fumímetro ou termografia durante o teste.",
      "currentValueTemplate": "Teste blower door: {thermal.blowerDoorTestPerformed}",
      "requiredValue": "Teste blower door recomendado no comissionamento (EN 13829/ISO 9972)",
      "enabled": true,
      "tags": [
        "comissionamento",
        "blower door",
        "estanquidade",
        "n50"
      ]
    },
    {
      "id": "REH-RADIANT-01",
      "regulationId": "en-16798-1",
      "article": "EN 16798-1 — Sistema Radiante: Dimensionamento da Potência",
      "description": "A potência do sistema de aquecimento radiante ({thermal.radiantHeatingCapacity} W/m²) é insuficiente para compensar as perdas térmicas do compartimento.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.radiantHeatingCapacityRatio",
          "operator": "<",
          "value": 1.0
        },
        {
          "field": "thermal.heatingSystemType",
          "operator": "in",
          "value": [
            "underfloor",
            "radiant_ceiling",
            "radiant_wall"
          ]
        }
      ],
      "remediation": "Redimensionar o sistema radiante para cobrir as perdas térmicas: aumentar o espaçamento dos tubos (piso radiante), elevar a temperatura da água de ida, ou complementar com emissor pontual (toalheiro eléctrico em IS). Potência típica: 40-80 W/m² para piso radiante.",
      "currentValueTemplate": "Potência radiante / Perdas = {thermal.radiantHeatingCapacityRatio}",
      "requiredValue": "Rácio potência/perdas ≥ 1.0 (sistema dimensionado para cobrir as perdas térmicas)",
      "enabled": true,
      "tags": [
        "aquecimento radiante",
        "potência",
        "dimensionamento",
        "piso radiante"
      ]
    },
    {
      "id": "REH-RADIANT-02",
      "regulationId": "en-16798-1",
      "article": "EN 16798-1 — Sistema Radiante: Temperatura Baixa de Operação",
      "description": "O sistema de aquecimento radiante opera com temperatura de água superior a 45°C ({thermal.radiantSupplyTemp}°C), reduzindo a eficiência da bomba de calor.",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.radiantSupplyTemp",
          "operator": ">",
          "value": 45
        },
        {
          "field": "thermal.heatingSystemType",
          "operator": "in",
          "value": [
            "underfloor",
            "radiant_ceiling",
            "radiant_wall"
          ]
        }
      ],
      "remediation": "Sistemas radiantes devem operar com temperatura de água ≤ 45°C (idealmente 30-40°C) para maximizar o COP da bomba de calor. Se a temperatura necessária é > 45°C, melhorar o isolamento da envolvente ou reduzir o espaçamento dos tubos. Temperatura de retorno típica: 25-35°C.",
      "currentValueTemplate": "Temperatura de ida do sistema radiante: {thermal.radiantSupplyTemp}°C",
      "requiredValue": "≤ 45°C (idealmente 30-40°C) para eficiência com bomba de calor",
      "enabled": true,
      "tags": [
        "aquecimento radiante",
        "temperatura baixa",
        "bomba de calor",
        "COP"
      ]
    },
    {
      "id": "REH-PMVCAT-01",
      "regulationId": "en-16798-1",
      "article": "EN 16798-1 — Categoria de Conforto Térmico: PMV/PPD por Tipo de Espaço",
      "description": "O espaço sensível (quarto, sala) não atinge a categoria II de conforto térmico (PPD > 10%) ({thermal.sensitiveSpacePPD}%).",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.sensitiveSpacePPD",
          "operator": ">",
          "value": 10
        },
        {
          "field": "thermal.sensitiveSpaceType",
          "operator": "in",
          "value": [
            "bedroom",
            "living_room"
          ]
        }
      ],
      "remediation": "Para quartos e salas (ocupação prolongada), atingir categoria II (PPD ≤ 10%, PMV ±0.5): verificar isolamento da envolvente adjacente, eliminar correntes de ar frio, assegurar temperatura do pavimento 19-29°C, e reduzir assimetria radiante para < 10°C.",
      "currentValueTemplate": "PPD em espaço sensível: {thermal.sensitiveSpacePPD}%",
      "requiredValue": "PPD ≤ 10% (categoria II) em quartos e salas; PPD ≤ 15% (cat. III) em circulações",
      "enabled": true,
      "tags": [
        "conforto térmico",
        "PMV",
        "PPD",
        "categoria",
        "espaço sensível"
      ]
    },
    {
      "id": "REH-RENMIN-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 9.º — Requisito Mínimo de U de Paredes em Grande Reabilitação",
      "description": "Na grande reabilitação, o coeficiente de transmissão térmica das paredes exteriores intervencionadas ({envelope.rehabWallUValue} W/(m².K)) não cumpre o valor máximo admissível para a zona climática {location.climateZoneWinter}.",
      "severity": "critical",
      "conditions": [
        {
          "field": "isRehabilitation",
          "operator": "==",
          "value": true
        },
        {
          "field": "envelope.rehabWallUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_u_walls_rehab",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Reforçar o isolamento térmico das paredes exteriores intervencionadas. Em reabilitação, os valores máximos são menos restritivos que em construção nova, mas devem ser cumpridos nos elementos intervencionados. Soluções: ETICS, isolamento na caixa-de-ar, isolamento pelo interior com barreira pára-vapor.",
      "currentValueTemplate": "U parede reabilitada = {envelope.rehabWallUValue} W/(m².K)",
      "requiredValue": "Consultar Despacho 15793-K/2013 — valores máximos em reabilitação por zona climática: I1 ≤ 0.70 / I2 ≤ 0.60 / I3 ≤ 0.50 W/(m².K)",
      "enabled": true,
      "tags": [
        "reabilitação",
        "renovação",
        "paredes",
        "valor-U",
        "requisito mínimo"
      ]
    },
    {
      "id": "REH-RENMIN-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 9.º — Requisito Mínimo de U de Cobertura em Grande Reabilitação",
      "description": "Na grande reabilitação, o coeficiente de transmissão térmica da cobertura intervencionada ({envelope.rehabRoofUValue} W/(m².K)) não cumpre o valor máximo para a zona climática {location.climateZoneWinter}.",
      "severity": "critical",
      "conditions": [
        {
          "field": "isRehabilitation",
          "operator": "==",
          "value": true
        },
        {
          "field": "envelope.rehabRoofUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_u_roofs_rehab",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Reforçar o isolamento térmico da cobertura intervencionada. A cobertura é o elemento com maior potencial de poupança energética em reabilitação. Soluções: isolamento sobre a laje de esteira (sótão), isolamento nas vertentes, cobertura invertida com XPS.",
      "currentValueTemplate": "U cobertura reabilitada = {envelope.rehabRoofUValue} W/(m².K)",
      "requiredValue": "Consultar Despacho 15793-K/2013 — valores máximos em reabilitação por zona climática: I1 ≤ 0.50 / I2 ≤ 0.45 / I3 ≤ 0.40 W/(m².K)",
      "enabled": true,
      "tags": [
        "reabilitação",
        "renovação",
        "cobertura",
        "valor-U",
        "requisito mínimo"
      ]
    },
    {
      "id": "REH-RENMIN-03",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 9.º — Requisito Mínimo de U de Envidraçados em Renovação",
      "description": "Na renovação térmica, o coeficiente de transmissão térmica dos envidraçados substituídos ({envelope.rehabWindowUValue} W/(m².K)) não cumpre o valor máximo para a zona climática {location.climateZoneWinter}.",
      "severity": "warning",
      "conditions": [
        {
          "field": "isRehabilitation",
          "operator": "==",
          "value": true
        },
        {
          "field": "envelope.rehabWindowUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_u_windows_rehab",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Substituir os vãos envidraçados por soluções que cumpram os valores máximos de U em renovação. Soluções: vidro duplo com caixilharia de corte térmico, vidro duplo low-e, ou segunda janela interior. A substituição de envidraçados é uma das medidas com melhor relação custo-benefício em reabilitação.",
      "currentValueTemplate": "U envidraçado substituído = {envelope.rehabWindowUValue} W/(m².K)",
      "requiredValue": "Consultar Despacho 15793-K/2013 — valores máximos em reabilitação: I1 ≤ 3.30 / I2 ≤ 3.00 / I3 ≤ 2.80 W/(m².K)",
      "enabled": true,
      "tags": [
        "reabilitação",
        "renovação",
        "envidraçados",
        "valor-U",
        "caixilharia"
      ]
    },
    {
      "id": "REH-COSTBEN-01",
      "regulationId": "dl-118-2013-sce",
      "article": "DL 118/2013 Art. 32.º — Análise Custo-Benefício: Payback de Reforço de Isolamento",
      "description": "O período de retorno do investimento em reforço de isolamento térmico ({renovation.insulationPaybackYears} anos) excede o horizonte máximo aceitável de 15 anos, tornando a medida economicamente inviável conforme a análise custo-benefício.",
      "severity": "warning",
      "conditions": [
        {
          "field": "renovation.insulationPaybackYears",
          "operator": ">",
          "value": 15
        }
      ],
      "remediation": "Reconsiderar a espessura e tipo de isolamento para reduzir o custo do investimento, ou combinar com outras intervenções na envolvente para maximizar a poupança energética. Em reabilitação profunda, o payback do isolamento pode ser reduzido se combinado com substituição de sistemas e aproveitamento de renováveis.",
      "currentValueTemplate": "Payback isolamento = {renovation.insulationPaybackYears} anos",
      "requiredValue": "Payback ≤ 15 anos (horizonte económico de referência para edifícios residenciais)",
      "enabled": true,
      "tags": [
        "custo-benefício",
        "payback",
        "isolamento",
        "renovação",
        "investimento"
      ]
    },
    {
      "id": "REH-COSTBEN-02",
      "regulationId": "dl-118-2013-sce",
      "article": "DL 118/2013 Art. 32.º — Análise Custo-Benefício: Poupança Energética Mínima",
      "description": "A poupança energética estimada com a intervenção de renovação térmica ({renovation.energySavingsPercent}%) é inferior ao limiar mínimo de 25% para justificar o investimento.",
      "severity": "info",
      "conditions": [
        {
          "field": "renovation.energySavingsPercent",
          "operator": "<",
          "value": 25
        },
        {
          "field": "isRehabilitation",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Reavaliar o pacote de medidas de renovação para atingir uma poupança energética mínima de 25%. Considerar intervenções integradas: envolvente + sistemas + renováveis. O Fundo de Eficiência Energética (FEE) e outros incentivos requerem geralmente poupanças demonstráveis superiores a 25%.",
      "currentValueTemplate": "Poupança energética estimada = {renovation.energySavingsPercent}%",
      "requiredValue": "≥ 25% de poupança energética para viabilidade custo-benefício e acesso a incentivos",
      "enabled": true,
      "tags": [
        "custo-benefício",
        "poupança energética",
        "renovação",
        "incentivos",
        "FEE"
      ]
    },
    {
      "id": "REH-COSTBEN-03",
      "regulationId": "dl-118-2013-sce",
      "article": "DL 118/2013 Art. 32.º — Análise Custo-Benefício: Custo Óptimo de Renovação Térmica",
      "description": "O custo global de renovação térmica ({renovation.globalCostPerM2} EUR/m²) excede o nível de custo óptimo para o nível de desempenho energético pretendido.",
      "severity": "info",
      "conditions": [
        {
          "field": "renovation.globalCostPerM2",
          "operator": ">",
          "value": 350
        },
        {
          "field": "isRehabilitation",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Optimizar o pacote de medidas para reduzir o custo global. Priorizar medidas com melhor relação custo-eficácia: isolamento da cobertura (maior impacto, menor custo), substituição de envidraçados, ETICS. Considerar faseamento da intervenção e acesso a programas de financiamento (IFRRU 2020, PRR).",
      "currentValueTemplate": "Custo global renovação = {renovation.globalCostPerM2} EUR/m²",
      "requiredValue": "≤ 350 EUR/m² (nível de custo óptimo de referência para habitação em Portugal)",
      "enabled": true,
      "tags": [
        "custo-benefício",
        "custo óptimo",
        "renovação",
        "financiamento",
        "IFRRU"
      ]
    },
    {
      "id": "REH-ISOMAT-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Condutividade Térmica do Isolamento Aplicado",
      "description": "A condutividade térmica declarada do material de isolamento ({insulation.thermalConductivity} W/(m.K)) excede o valor máximo aceitável de 0.065 W/(m.K) para ser considerado como isolamento térmico no cálculo REH.",
      "severity": "critical",
      "conditions": [
        {
          "field": "insulation.thermalConductivity",
          "operator": ">",
          "value": 0.065
        }
      ],
      "remediation": "Utilizar materiais de isolamento com condutividade térmica declarada (lambda_D) inferior a 0.065 W/(m.K). Materiais típicos: EPS (0.037-0.040), XPS (0.033-0.036), lã mineral (0.035-0.040), PIR (0.022-0.026), cortiça expandida (0.040-0.045), aerogel (0.013-0.020). Verificar valores certificados conforme EN 13162 a EN 13171.",
      "currentValueTemplate": "λ_D = {insulation.thermalConductivity} W/(m.K)",
      "requiredValue": "λ_D ≤ 0.065 W/(m.K) para ser classificado como isolamento térmico",
      "enabled": true,
      "tags": [
        "isolamento",
        "condutividade",
        "material",
        "lambda",
        "selecção"
      ]
    },
    {
      "id": "REH-ISOMAT-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Espessura Mínima de Isolamento para Conformidade U",
      "description": "A espessura do isolamento térmico aplicado ({insulation.thicknessMM} mm) é insuficiente para atingir o valor U máximo da envolvente na zona climática {location.climateZoneWinter}.",
      "severity": "critical",
      "conditions": [
        {
          "field": "insulation.thicknessMM",
          "operator": "<",
          "value": 40
        },
        {
          "field": "location.climateZoneWinter",
          "operator": "in",
          "value": ["I2", "I3"]
        }
      ],
      "remediation": "Aumentar a espessura do isolamento térmico para garantir o cumprimento dos valores U máximos. Para zonas I2/I3, espessuras mínimas típicas: paredes (60-100mm EPS/MW), cobertura (80-120mm), pavimento (60-80mm). Calcular a espessura necessária em função da condutividade do isolamento e da resistência térmica do elemento construtivo base.",
      "currentValueTemplate": "Espessura isolamento = {insulation.thicknessMM} mm",
      "requiredValue": "≥ 40 mm mínimo absoluto; espessura real depende de λ_D do material e U_máx por zona climática",
      "enabled": true,
      "tags": [
        "isolamento",
        "espessura",
        "material",
        "selecção",
        "zona climática"
      ]
    },
    {
      "id": "REH-ISOMAT-03",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Certificação CE do Material de Isolamento",
      "description": "O material de isolamento térmico não possui marcação CE válida conforme as normas harmonizadas EN 13162 a EN 13171 ({insulation.hasCEMarking}).",
      "severity": "critical",
      "conditions": [
        {
          "field": "insulation.hasCEMarking",
          "operator": "==",
          "value": false
        }
      ],
      "remediation": "Substituir o material de isolamento por produto com marcação CE conforme as normas harmonizadas europeias: EN 13162 (lã mineral), EN 13163 (EPS), EN 13164 (XPS), EN 13165 (PUR/PIR), EN 13166 (resinas fenólicas), EN 13167 (vidro celular), EN 13168 (lã de madeira), EN 13169 (perlite), EN 13170 (cortiça expandida), EN 13171 (fibra de madeira). A Declaração de Desempenho (DoP) é obrigatória.",
      "currentValueTemplate": "Marcação CE: {insulation.hasCEMarking}",
      "requiredValue": "Marcação CE obrigatória conforme Regulamento (UE) 305/2011 (CPR)",
      "enabled": true,
      "tags": [
        "isolamento",
        "marcação CE",
        "certificação",
        "CPR",
        "material"
      ]
    },
    {
      "id": "REH-ETICS-FIRE-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 + SCIE — Barreira Corta-Fogo em ETICS com EPS (Edifícios > 28m)",
      "description": "O sistema ETICS com EPS aplicado em edifício com altura superior a 28m ({building.heightM} m) não possui barreiras corta-fogo horizontais em lã mineral ({insulation.eticsFireBarriers}).",
      "severity": "critical",
      "conditions": [
        {
          "field": "building.heightM",
          "operator": ">",
          "value": 28
        },
        {
          "field": "insulation.eticsInsulationType",
          "operator": "==",
          "value": "EPS"
        },
        {
          "field": "insulation.eticsFireBarriers",
          "operator": "==",
          "value": false
        }
      ],
      "remediation": "Instalar barreiras corta-fogo horizontais em lã mineral (MW) de classe A1/A2 em toda a largura da fachada, a cada 2 pisos (máximo 6m de altura). As barreiras devem ter largura mínima de 200mm e espessura igual à do EPS. Em alternativa, utilizar lã mineral (MW) como isolamento principal do ETICS em edifícios > 28m. Conforme ETAG 004 e regulamento SCIE.",
      "currentValueTemplate": "Edifício {building.heightM}m com ETICS-EPS sem barreiras corta-fogo",
      "requiredValue": "Barreiras corta-fogo MW obrigatórias a cada 2 pisos em ETICS-EPS para edifícios > 28m",
      "enabled": true,
      "tags": [
        "ETICS",
        "fogo",
        "barreira corta-fogo",
        "EPS",
        "lã mineral",
        "segurança"
      ]
    },
    {
      "id": "REH-ETICS-FIRE-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 + SCIE — Reacção ao Fogo do ETICS (Classe Mínima)",
      "description": "A classe de reacção ao fogo do sistema ETICS ({insulation.eticsFireClass}) não cumpre a classe mínima exigida para a utilização-tipo e altura do edifício.",
      "severity": "critical",
      "conditions": [
        {
          "field": "insulation.eticsFireClass",
          "operator": "ordinal_gt",
          "value": "B-s2,d0",
          "scale": [
            "A1",
            "A2-s1,d0",
            "B-s1,d0",
            "B-s2,d0",
            "C-s2,d0",
            "D-s2,d0",
            "E",
            "F"
          ]
        },
        {
          "field": "building.heightM",
          "operator": ">",
          "value": 9
        }
      ],
      "remediation": "Substituir o sistema ETICS por uma solução com classe de reacção ao fogo igual ou superior a B-s2,d0 para edifícios com altura > 9m. Para edifícios > 28m, considerar classe A2-s1,d0. O ETA (European Technical Assessment) do sistema ETICS deve declarar a classe de reacção ao fogo do sistema completo (não apenas do isolamento). Utilizar lã mineral (classe A1) para máxima segurança.",
      "currentValueTemplate": "Classe de reacção ao fogo ETICS: {insulation.eticsFireClass}",
      "requiredValue": "≤ B-s2,d0 para edifícios > 9m; ≤ A2-s1,d0 para edifícios > 28m",
      "enabled": true,
      "tags": [
        "ETICS",
        "fogo",
        "reacção ao fogo",
        "Euroclass",
        "segurança"
      ]
    },
    {
      "id": "REH-ETICS-FIRE-03",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 + SCIE — Protecção de Vãos em ETICS (Faixas Incombustíveis)",
      "description": "O sistema ETICS com isolamento combustível não possui faixas incombustíveis de lã mineral em torno dos vãos de janela ({insulation.eticsWindowFireStrips}).",
      "severity": "warning",
      "conditions": [
        {
          "field": "insulation.eticsInsulationType",
          "operator": "in",
          "value": ["EPS", "XPS", "PUR", "PIR"]
        },
        {
          "field": "insulation.eticsWindowFireStrips",
          "operator": "==",
          "value": false
        },
        {
          "field": "building.heightM",
          "operator": ">",
          "value": 9
        }
      ],
      "remediation": "Instalar faixas de lã mineral (MW classe A1) em torno de todos os vãos de janela e porta, com largura mínima de 200mm, como protecção contra propagação de fogo pela fachada. Esta medida é particularmente importante na verga (parte superior do vão) para evitar que as chamas do andar inferior inflamem o isolamento do andar superior.",
      "currentValueTemplate": "ETICS com isolamento combustível sem faixas MW nos vãos",
      "requiredValue": "Faixas MW classe A1 ≥ 200mm em torno de todos os vãos para edifícios > 9m",
      "enabled": true,
      "tags": [
        "ETICS",
        "fogo",
        "vãos",
        "lã mineral",
        "faixas incombustíveis"
      ]
    },
    {
      "id": "REH-ISOMOIST-01",
      "regulationId": "en-iso-13788",
      "article": "EN ISO 13788 — Resistência à Difusão de Vapor do Isolamento em Coberturas",
      "description": "O fator de resistência à difusão de vapor (μ) do isolamento aplicado na cobertura ({insulation.roofMuFactor}) é inadequado para a posição na secção construtiva, podendo causar condensações intersticiais.",
      "severity": "warning",
      "conditions": [
        {
          "field": "insulation.roofMuFactor",
          "operator": "<",
          "value": 30
        },
        {
          "field": "insulation.roofPosition",
          "operator": "==",
          "value": "exterior"
        },
        {
          "field": "insulation.hasVaporBarrier",
          "operator": "==",
          "value": false
        }
      ],
      "remediation": "Em coberturas com isolamento exterior permeável ao vapor (lã mineral, μ ≈ 1-3), é essencial instalar barreira pára-vapor na face quente (interior). Em alternativa, utilizar isolamento com μ elevado (XPS μ ≈ 80-200, PUR μ ≈ 30-100) que funciona simultaneamente como barreira ao vapor. Verificar o perfil de condensações pelo método de Glaser conforme EN ISO 13788.",
      "currentValueTemplate": "μ isolamento cobertura = {insulation.roofMuFactor}; posição: {insulation.roofPosition}; barreira pára-vapor: {insulation.hasVaporBarrier}",
      "requiredValue": "Se μ < 30 e posição exterior → barreira pára-vapor obrigatória na face quente",
      "enabled": true,
      "tags": [
        "isolamento",
        "humidade",
        "vapor",
        "cobertura",
        "condensação",
        "barreira pára-vapor"
      ]
    },
    {
      "id": "REH-ISOMOIST-02",
      "regulationId": "en-iso-13788",
      "article": "EN ISO 13788 — Absorção de Água do Isolamento em Contacto com Solo",
      "description": "O isolamento térmico em contacto com o solo ({insulation.groundContactType}) possui absorção de água a longo prazo (WL(T)) superior a 3%, comprometendo o desempenho térmico.",
      "severity": "warning",
      "conditions": [
        {
          "field": "insulation.groundContactWaterAbsorption",
          "operator": ">",
          "value": 3
        },
        {
          "field": "insulation.isGroundContact",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Utilizar exclusivamente isolamento com baixa absorção de água em contacto com o solo: XPS (WL(T) ≤ 0.7%), vidro celular (WL(T) ≈ 0%), ou PUR de célula fechada com membrana impermeável. EPS e lã mineral não são adequados para aplicação em contacto directo com solo ou água. Verificar WL(T) conforme EN 12087.",
      "currentValueTemplate": "Absorção de água WL(T) = {insulation.groundContactWaterAbsorption}%",
      "requiredValue": "WL(T) ≤ 3% para isolamento em contacto com solo (recomendado ≤ 1%)",
      "enabled": true,
      "tags": [
        "isolamento",
        "humidade",
        "absorção de água",
        "solo",
        "XPS",
        "fundação"
      ]
    },
    {
      "id": "REH-ISOMOIST-03",
      "regulationId": "en-iso-13788",
      "article": "EN ISO 13788 — Resistência à Humidade do Isolamento em Paredes Enterradas",
      "description": "O isolamento térmico em paredes enterradas ({insulation.basementWallType}) não é resistente à humidade, podendo degradar-se e perder desempenho térmico.",
      "severity": "warning",
      "conditions": [
        {
          "field": "insulation.basementWallType",
          "operator": "in",
          "value": ["EPS", "mineral_wool", "wood_fiber"]
        },
        {
          "field": "insulation.basementWallDepthM",
          "operator": ">",
          "value": 0
        },
        {
          "field": "insulation.basementWallWaterproofing",
          "operator": "==",
          "value": false
        }
      ],
      "remediation": "Em paredes enterradas, utilizar XPS (extrudido) ou vidro celular como isolamento, ou proteger EPS/lã mineral com membrana impermeabilizante contínua (membrana de bentonite, membrana betuminosa, ou membrana drenante tipo noppenbahn). Garantir drenagem perimetral adequada para reduzir a pressão hidrostática sobre a impermeabilização.",
      "currentValueTemplate": "Isolamento {insulation.basementWallType} em parede enterrada sem protecção",
      "requiredValue": "Isolamento resistente à humidade (XPS, vidro celular) ou protecção impermeável contínua",
      "enabled": true,
      "tags": [
        "isolamento",
        "humidade",
        "parede enterrada",
        "cave",
        "impermeabilização"
      ]
    },
    {
      "id": "REH-VENTFAC-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 + Despacho 15793-K/2013 — U Total de Fachada Ventilada",
      "description": "O coeficiente de transmissão térmica total da fachada ventilada ({envelope.ventilatedFacadeUValue} W/(m².K)) excede o valor máximo para a zona climática {location.climateZoneWinter}. O cálculo deve considerar a resistência térmica da caixa-de-ar ventilada (Rsi interior conforme EN ISO 6946).",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.ventilatedFacadeUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_u_walls",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Reforçar o isolamento na fachada ventilada. No cálculo de U, a caixa-de-ar fortemente ventilada elimina a contribuição das camadas exteriores ao isolamento — o U é calculado apenas com as camadas do suporte para o interior + Rse = Rsi = 0.13 m².K/W. Aumentar a espessura de isolamento (MW ou PIR fixados ao suporte), garantindo continuidade e fixação mecânica adequada.",
      "currentValueTemplate": "U fachada ventilada = {envelope.ventilatedFacadeUValue} W/(m².K)",
      "requiredValue": "Consultar Despacho 15793-K/2013 Tabela I.01 — mesmos limites que paredes exteriores por zona climática",
      "enabled": true,
      "tags": [
        "fachada ventilada",
        "valor-U",
        "caixa-de-ar",
        "isolamento",
        "cálculo térmico"
      ]
    },
    {
      "id": "REH-VENTFAC-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Espessura Mínima da Caixa-de-Ar em Fachada Ventilada",
      "description": "A espessura da caixa-de-ar ventilada ({envelope.ventilatedFacadeAirGapMM} mm) é inferior ao mínimo de 20mm para garantir ventilação efectiva.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.ventilatedFacadeAirGapMM",
          "operator": "<",
          "value": 20
        }
      ],
      "remediation": "Aumentar a espessura da caixa-de-ar ventilada para um mínimo de 20mm (recomendado 30-50mm). Garantir aberturas de ventilação inferior e superior com área mínima de 50 cm² por metro linear de fachada. A ventilação da caixa-de-ar é essencial para a evacuação da humidade e para o efeito chaminé que melhora o desempenho em verão.",
      "currentValueTemplate": "Caixa-de-ar fachada ventilada = {envelope.ventilatedFacadeAirGapMM} mm",
      "requiredValue": "≥ 20 mm (recomendado 30-50 mm conforme EN 13947)",
      "enabled": true,
      "tags": [
        "fachada ventilada",
        "caixa-de-ar",
        "ventilação",
        "espessura"
      ]
    },
    {
      "id": "REH-VENTFAC-03",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Protecção Contra a Chuva do Isolamento em Fachada Ventilada",
      "description": "O isolamento em fachada ventilada não possui protecção adequada contra a infiltração de água de chuva ({insulation.ventFacadeRainProtection}).",
      "severity": "warning",
      "conditions": [
        {
          "field": "insulation.ventFacadeRainProtection",
          "operator": "==",
          "value": false
        },
        {
          "field": "insulation.ventFacadeInsulationType",
          "operator": "in",
          "value": ["mineral_wool", "wood_fiber"]
        }
      ],
      "remediation": "Aplicar membrana permeável ao vapor mas impermeável à água (tipo Tyvek) na face exterior do isolamento em fachada ventilada, especialmente com lã mineral ou fibra de madeira. A membrana impede a penetração de chuva batida na caixa-de-ar ventilada mas permite a difusão de vapor do interior para o exterior. Sd da membrana deve ser ≤ 0.2m.",
      "currentValueTemplate": "Isolamento em fachada ventilada sem protecção contra chuva",
      "requiredValue": "Membrana permeável ao vapor (Sd ≤ 0.2m) na face exterior do isolamento",
      "enabled": true,
      "tags": [
        "fachada ventilada",
        "humidade",
        "chuva",
        "membrana",
        "protecção"
      ]
    },
    {
      "id": "REH-CURTWALL-01",
      "regulationId": "portaria-379a-2015",
      "article": "Portaria 379-A/2015 — U Máximo de Fachada Cortina",
      "description": "O coeficiente de transmissão térmica da fachada cortina ({envelope.curtainWallUcw} W/(m².K)) excede o valor máximo para a zona climática {location.climateZoneWinter}. A fachada cortina deve cumprir requisitos idênticos aos dos vãos envidraçados.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.curtainWallUcw",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_u_curtain_wall",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Melhorar o desempenho térmico da fachada cortina: utilizar vidro duplo ou triplo com capa low-e (Ug ≤ 1.1 W/(m².K)), perfis com corte térmico (poliamida ≥ 24mm), painéis de enchimento (spandrel) com isolamento. Calcular Ucw conforme EN 13947 considerando as áreas de vidro, perfil e painel. Verificar factor solar para evitar sobreaquecimento.",
      "currentValueTemplate": "U fachada cortina = {envelope.curtainWallUcw} W/(m².K)",
      "requiredValue": "Consultar Portaria 379-A/2015 e Despacho 15793-K/2013 — limites de Ucw por zona climática",
      "enabled": true,
      "tags": [
        "fachada cortina",
        "curtain wall",
        "valor-U",
        "vidro",
        "corte térmico"
      ]
    },
    {
      "id": "REH-CURTWALL-02",
      "regulationId": "portaria-379a-2015",
      "article": "Portaria 379-A/2015 — Factor Solar da Fachada Cortina",
      "description": "O factor solar dos panos envidraçados da fachada cortina com protecção solar ({envelope.curtainWallGTvc}) excede o valor máximo para a zona climática de verão {location.climateZoneSummer}.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.curtainWallGTvc",
          "operator": ">",
          "value": 0.56
        },
        {
          "field": "location.climateZoneSummer",
          "operator": "in",
          "value": ["V2", "V3"]
        }
      ],
      "remediation": "Reduzir o factor solar da fachada cortina: utilizar vidro de controlo solar (g ≤ 0.30), instalar protecções solares interiores ou exteriores (estores, screen), aplicar película de controlo solar. Para zonas V2/V3, gT,vc deve ser calculado conforme o método do factor solar corrigido do REH, incluindo sombreamento exterior se aplicável.",
      "currentValueTemplate": "gT,vc fachada cortina = {envelope.curtainWallGTvc}",
      "requiredValue": "gT,vc ≤ 0.56 para zonas V2/V3 (verificar por orientação e tipo de vão)",
      "enabled": true,
      "tags": [
        "fachada cortina",
        "factor solar",
        "sobreaquecimento",
        "controlo solar"
      ]
    },
    {
      "id": "REH-INSREND-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — U de Sistema de Reboco Isolante (Reboco Térmico)",
      "description": "O coeficiente de transmissão térmica da parede com sistema de reboco isolante ({envelope.insulatedRenderUValue} W/(m².K)) excede o valor máximo para a zona climática {location.climateZoneWinter}.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.insulatedRenderUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_u_walls",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "O reboco isolante (à base de cortiça, perlite, EPS ou aerogel) tem condutividade típica de 0.040-0.080 W/(m.K), exigindo espessuras maiores que isolamento convencional. Para atingir U ≤ 0.50 em zona I1, uma parede de tijolo 22cm pode necessitar de 40-60mm de reboco térmico. Para zonas I2/I3, considerar combinar com isolamento convencional ou usar reboco de aerogel (λ ≈ 0.028).",
      "currentValueTemplate": "U com reboco isolante = {envelope.insulatedRenderUValue} W/(m².K)",
      "requiredValue": "Consultar Despacho 15793-K/2013 — mesmos limites que paredes exteriores",
      "enabled": true,
      "tags": [
        "reboco isolante",
        "reboco térmico",
        "valor-U",
        "cortiça",
        "aerogel"
      ]
    },
    {
      "id": "REH-INSREND-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Espessura Mínima de Reboco Isolante",
      "description": "A espessura do reboco isolante aplicado ({insulation.insulatedRenderThicknessMM} mm) é inferior ao mínimo recomendado de 20mm para garantir desempenho térmico e durabilidade.",
      "severity": "info",
      "conditions": [
        {
          "field": "insulation.insulatedRenderThicknessMM",
          "operator": "<",
          "value": 20
        }
      ],
      "remediation": "Aumentar a espessura do reboco isolante para no mínimo 20mm (recomendado 30-60mm). Com espessura inferior a 20mm, o reboco isolante não oferece desempenho térmico significativo e pode apresentar problemas de fissuração. Aplicar em duas ou mais camadas com rede de fibra de vidro entre camadas para espessuras > 30mm.",
      "currentValueTemplate": "Espessura reboco isolante = {insulation.insulatedRenderThicknessMM} mm",
      "requiredValue": "≥ 20 mm mínimo; recomendado 30-60 mm para desempenho térmico significativo",
      "enabled": true,
      "tags": [
        "reboco isolante",
        "espessura",
        "durabilidade",
        "aplicação"
      ]
    },
    {
      "id": "REH-CAVITY-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Preenchimento Total da Caixa-de-Ar em Parede Dupla",
      "description": "A caixa-de-ar da parede dupla não está totalmente preenchida com isolamento ({envelope.cavityFullFill}), reduzindo o desempenho térmico e criando risco de convecção na caixa-de-ar residual.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.cavityFullFill",
          "operator": "==",
          "value": false
        },
        {
          "field": "envelope.cavityInsulationThicknessMM",
          "operator": "<",
          "value": 40
        }
      ],
      "remediation": "Preencher totalmente a caixa-de-ar com isolamento ou garantir que o isolamento parcial tem espessura suficiente (mínimo 40mm). Em preenchimento total, utilizar lã mineral semi-rígida, EPS com encaixe, ou injecção de espuma/grânulos. Deixar caixa-de-ar residual de 10-15mm no lado exterior apenas se o pano exterior não for estanque à chuva. O preenchimento total elimina a convecção interna que degrada o desempenho.",
      "currentValueTemplate": "Caixa-de-ar não totalmente preenchida; isolamento = {envelope.cavityInsulationThicknessMM} mm",
      "requiredValue": "Preenchimento total da caixa-de-ar ou isolamento parcial ≥ 40mm com caixa-de-ar residual ≤ 15mm",
      "enabled": true,
      "tags": [
        "caixa-de-ar",
        "parede dupla",
        "preenchimento",
        "isolamento",
        "convecção"
      ]
    },
    {
      "id": "REH-CAVITY-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Espessura Mínima da Caixa-de-Ar Isolada",
      "description": "A espessura total da caixa-de-ar em parede dupla ({envelope.cavityWidthMM} mm) é insuficiente para acomodar o isolamento necessário ao cumprimento do U máximo na zona climática {location.climateZoneWinter}.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.cavityWidthMM",
          "operator": "<",
          "value": 40
        },
        {
          "field": "location.climateZoneWinter",
          "operator": "in",
          "value": ["I2", "I3"]
        }
      ],
      "remediation": "Para zonas I2/I3, a caixa-de-ar deve ter no mínimo 40-60mm para acomodar isolamento suficiente. Se a caixa-de-ar existente é estreita, considerar isolamento pelo exterior (ETICS) ou pelo interior como complemento. Em construção nova, dimensionar a caixa-de-ar para ≥ 60mm (I2) ou ≥ 80mm (I3).",
      "currentValueTemplate": "Largura caixa-de-ar = {envelope.cavityWidthMM} mm",
      "requiredValue": "≥ 40 mm para I2; ≥ 60 mm para I3 (para acomodar isolamento adequado)",
      "enabled": true,
      "tags": [
        "caixa-de-ar",
        "parede dupla",
        "espessura",
        "zona climática"
      ]
    },
    {
      "id": "REH-BLOWNIN-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Isolamento Injectado/Insuflado na Caixa-de-Ar: Densidade Mínima",
      "description": "A densidade do isolamento injectado/insuflado na caixa-de-ar ({insulation.blownInDensity} kg/m³) é inferior ao mínimo para evitar assentamento ao longo do tempo.",
      "severity": "warning",
      "conditions": [
        {
          "field": "insulation.blownInDensity",
          "operator": "<",
          "value": 25
        },
        {
          "field": "insulation.applicationType",
          "operator": "==",
          "value": "blown_in"
        }
      ],
      "remediation": "Aumentar a densidade do isolamento insuflado para evitar assentamento e pontes térmicas no topo da parede. Densidades mínimas recomendadas: lã mineral insuflada ≥ 25 kg/m³, grânulos de EPS ≥ 15 kg/m³ (com ligante), celulose insuflada ≥ 45 kg/m³ em paredes (para evitar assentamento). Verificar conforme EN 14064 (lã mineral) ou ETA específico do produto.",
      "currentValueTemplate": "Densidade isolamento insuflado = {insulation.blownInDensity} kg/m³",
      "requiredValue": "≥ 25 kg/m³ (lã mineral); ≥ 45 kg/m³ (celulose) conforme EN 14064 e ETAs",
      "enabled": true,
      "tags": [
        "isolamento insuflado",
        "blown-in",
        "densidade",
        "assentamento",
        "caixa-de-ar"
      ]
    },
    {
      "id": "REH-BLOWNIN-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Isolamento Insuflado: Verificação de Preenchimento Completo",
      "description": "O isolamento insuflado na caixa-de-ar não tem confirmação de preenchimento completo sem vazios ({insulation.blownInFillVerified}).",
      "severity": "info",
      "conditions": [
        {
          "field": "insulation.blownInFillVerified",
          "operator": "==",
          "value": false
        },
        {
          "field": "insulation.applicationType",
          "operator": "==",
          "value": "blown_in"
        }
      ],
      "remediation": "Verificar o preenchimento completo da caixa-de-ar após insuflação: utilizar câmara endoscópica ou termografia infravermelha para confirmar ausência de vazios e assentamento. A declaração de conformidade do instalador deve incluir a densidade de aplicação, a área tratada, e a confirmação de preenchimento. Abrir pontos de inspecção no topo da parede para verificar o nível do isolamento.",
      "currentValueTemplate": "Preenchimento verificado: {insulation.blownInFillVerified}",
      "requiredValue": "Verificação obrigatória de preenchimento completo com relatório do instalador",
      "enabled": true,
      "tags": [
        "isolamento insuflado",
        "blown-in",
        "verificação",
        "qualidade",
        "termografia"
      ]
    },
    {
      "id": "REH-SPRAY-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Espessura Máxima de Espuma de Poliuretano Projectada (PUR)",
      "description": "A espessura de espuma de poliuretano projectada ({insulation.sprayFoamThicknessMM} mm) excede o máximo recomendado por camada de aplicação ({insulation.sprayFoamMaxLayerMM} mm), comprometendo a qualidade da cura e a aderência.",
      "severity": "warning",
      "conditions": [
        {
          "field": "insulation.sprayFoamThicknessMM",
          "operator": ">",
          "value": 50
        },
        {
          "field": "insulation.sprayFoamLayers",
          "operator": "==",
          "value": 1
        }
      ],
      "remediation": "Aplicar a espuma de poliuretano projectada em camadas sucessivas, com espessura máxima de 30-50mm por camada, permitindo a cura entre camadas (mínimo 15 minutos). Espessura total em camada única > 50mm pode causar: cura incompleta no interior, fissuras térmicas, descolamento do suporte, e risco de incêndio durante a aplicação. Para espessuras totais > 80mm, aplicar em 2-3 camadas.",
      "currentValueTemplate": "Espessura PUR projectada = {insulation.sprayFoamThicknessMM} mm em {insulation.sprayFoamLayers} camada(s)",
      "requiredValue": "≤ 50 mm por camada; espessuras superiores em camadas múltiplas com cura entre camadas",
      "enabled": true,
      "tags": [
        "spray foam",
        "poliuretano",
        "espessura",
        "aplicação",
        "qualidade"
      ]
    },
    {
      "id": "REH-SPRAY-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Espuma Projectada: Reacção ao Fogo Mínima",
      "description": "A espuma de poliuretano projectada ({insulation.sprayFoamFireClass}) não cumpre a classe de reacção ao fogo mínima para a aplicação.",
      "severity": "critical",
      "conditions": [
        {
          "field": "insulation.sprayFoamFireClass",
          "operator": "ordinal_gt",
          "value": "E",
          "scale": [
            "A1",
            "A2",
            "B",
            "C",
            "D",
            "E",
            "F"
          ]
        }
      ],
      "remediation": "A espuma de poliuretano projectada deve atingir no mínimo classe E de reacção ao fogo (Euroclass). Para aplicações em edifícios de habitação, classe E é o mínimo regulamentar. Se a espuma ficar exposta (sem revestimento incombustível), considerar PUR com retardante de chama ou aplicar revestimento de protecção (gesso cartonado BA13, reboco cimentício ≥ 15mm). Em caves e vias de evacuação, classe mínima B-s2,d0.",
      "currentValueTemplate": "Reacção ao fogo PUR: {insulation.sprayFoamFireClass}",
      "requiredValue": "≤ classe E (Euroclass); classe B-s2,d0 em vias de evacuação",
      "enabled": true,
      "tags": [
        "spray foam",
        "poliuretano",
        "fogo",
        "reacção ao fogo",
        "segurança"
      ]
    },
    {
      "id": "REH-PIRXPS-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Comparação PIR vs XPS: Desempenho Térmico por Espessura",
      "description": "Para a espessura disponível ({insulation.availableThicknessMM} mm), a selecção de XPS em vez de PIR resulta num valor U superior ao máximo permitido. PIR (λ ≈ 0.022) atinge o mesmo desempenho com ~65% da espessura do XPS (λ ≈ 0.034).",
      "severity": "info",
      "conditions": [
        {
          "field": "insulation.selectedType",
          "operator": "==",
          "value": "XPS"
        },
        {
          "field": "insulation.availableThicknessMM",
          "operator": "<",
          "value": 60
        },
        {
          "field": "insulation.resultingUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_u_walls",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Considerar substituir XPS (λ_D ≈ 0.034 W/(m.K)) por PIR (λ_D ≈ 0.022 W/(m.K)) quando o espaço é limitado. Comparação para R = 2.0 m².K/W: XPS necessita ~68mm, PIR necessita ~44mm. O PIR é mais caro por m² mas permite cumprir requisitos em espessuras menores. Verificar compatibilidade com o sistema construtivo (PIR requer protecção ao fogo em aplicação exposta).",
      "currentValueTemplate": "XPS {insulation.availableThicknessMM}mm → U = {insulation.resultingUValue} W/(m².K)",
      "requiredValue": "PIR com {insulation.availableThicknessMM}mm atingiria U mais baixo — consultar tabela de U por zona climática",
      "enabled": true,
      "tags": [
        "PIR",
        "XPS",
        "comparação",
        "espessura",
        "selecção material"
      ]
    },
    {
      "id": "REH-PIRXPS-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Comparação PIR vs XPS: Resistência à Humidade em Cobertura Invertida",
      "description": "O isolamento PIR foi especificado para cobertura invertida ({insulation.invertedRoofType}), mas PIR não é adequado para imersão prolongada em água. XPS é o material de referência para coberturas invertidas.",
      "severity": "critical",
      "conditions": [
        {
          "field": "insulation.invertedRoofType",
          "operator": "==",
          "value": "PIR"
        },
        {
          "field": "envelope.roofType",
          "operator": "==",
          "value": "inverted"
        }
      ],
      "remediation": "Em coberturas invertidas, substituir PIR por XPS. O XPS é o único isolamento corrente adequado para cobertura invertida (sobre a impermeabilização) devido à sua baixa absorção de água (WL(T) ≤ 0.7%), resistência à compressão elevada, e estabilidade dimensional em contacto com água. PIR, apesar de melhor λ, absorve água e perde desempenho térmico quando colocado sobre a impermeabilização.",
      "currentValueTemplate": "PIR em cobertura invertida — material inadequado",
      "requiredValue": "XPS obrigatório em cobertura invertida (WL(T) ≤ 0.7%, CS(10) ≥ 200 kPa)",
      "enabled": true,
      "tags": [
        "PIR",
        "XPS",
        "cobertura invertida",
        "humidade",
        "selecção material"
      ]
    },
    {
      "id": "REH-FIXPTL-01",
      "regulationId": "en-iso-10211",
      "article": "EN ISO 10211 — Ponte Térmica Pontual por Fixações Mecânicas do Isolamento",
      "description": "As fixações mecânicas do isolamento (buchas de fixação) introduzem ponte térmica pontual significativa. O número de fixações ({insulation.fixingsPerM2} un/m²) e o tipo ({insulation.fixingType}) excedem o impacto admissível.",
      "severity": "warning",
      "conditions": [
        {
          "field": "insulation.fixingsPerM2",
          "operator": ">",
          "value": 8
        },
        {
          "field": "insulation.fixingType",
          "operator": "==",
          "value": "metallic"
        }
      ],
      "remediation": "Reduzir o impacto das fixações mecânicas: utilizar buchas com cabeça de plástico expandido (χ ≈ 0.002 W/K vs 0.008 W/K para buchas metálicas), reduzir o número de fixações ao mínimo estruturalmente necessário (4-6/m² é típico), ou utilizar fixação colada em vez de mecânica quando o suporte permite. O acréscimo de U por fixações pode ser calculado: ΔU = n × χ, onde n é o nº de fixações/m².",
      "currentValueTemplate": "{insulation.fixingsPerM2} fixações metálicas/m² → ΔU = {insulation.fixingsPerM2} × 0.008 = {insulation.fixingsDeltaU} W/(m².K)",
      "requiredValue": "≤ 8 fixações/m² com buchas metálicas; usar buchas de plástico para χ < 0.003 W/K",
      "enabled": true,
      "tags": [
        "fixações",
        "ponte térmica pontual",
        "buchas",
        "ETICS",
        "ΔU"
      ]
    },
    {
      "id": "REH-FIXPTL-02",
      "regulationId": "en-iso-10211",
      "article": "EN ISO 10211 — Correcção ΔU por Fixações Mecânicas no Cálculo de U",
      "description": "O cálculo do coeficiente U não inclui a correcção ΔU devida às fixações mecânicas do isolamento ({insulation.fixingsCorrectionApplied}).",
      "severity": "info",
      "conditions": [
        {
          "field": "insulation.fixingsCorrectionApplied",
          "operator": "==",
          "value": false
        },
        {
          "field": "insulation.fixingsPerM2",
          "operator": ">",
          "value": 0
        }
      ],
      "remediation": "Incluir a correcção ΔU por fixações mecânicas no cálculo do U conforme EN ISO 6946 Anexo D. ΔUf = n × χ × (d_fix / d_iso)², onde n = número de fixações/m², χ = coeficiente pontual da bucha, d_fix = diâmetro da fixação, d_iso = espessura do isolamento. Para ETICS com buchas plásticas típicas (6/m²), ΔU ≈ 0.01-0.02 W/(m².K). Esta correcção pode ser decisiva em edifícios próximos do limite U máximo.",
      "currentValueTemplate": "Correcção ΔU por fixações não aplicada",
      "requiredValue": "Incluir ΔU conforme EN ISO 6946 Anexo D no cálculo de U total",
      "enabled": true,
      "tags": [
        "fixações",
        "ΔU",
        "correcção",
        "EN ISO 6946",
        "cálculo"
      ]
    },
    {
      "id": "REH-WARMROOF-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Cobertura Quente: Isolamento sobre a Laje (Warm Roof)",
      "description": "Na cobertura quente (warm roof), o isolamento colocado sobre a laje estrutural não possui barreira pára-vapor na face inferior ({insulation.warmRoofVaporBarrier}), criando risco de condensações.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.roofType",
          "operator": "==",
          "value": "warm"
        },
        {
          "field": "insulation.warmRoofVaporBarrier",
          "operator": "==",
          "value": false
        }
      ],
      "remediation": "Em cobertura quente (isolamento sobre a laje, sob a impermeabilização), instalar barreira pára-vapor na face inferior do isolamento (sobre a laje). A barreira deve ter Sd ≥ 100m (ex: membrana betuminosa, folha de polietileno 200μm). Sem barreira, o vapor difunde para cima, condensa sob a impermeabilização (fria), e degrada o isolamento. Verificar pelo método de Glaser (EN ISO 13788).",
      "currentValueTemplate": "Cobertura quente sem barreira pára-vapor",
      "requiredValue": "Barreira pára-vapor obrigatória (Sd ≥ 100m) na face quente do isolamento",
      "enabled": true,
      "tags": [
        "cobertura quente",
        "warm roof",
        "barreira pára-vapor",
        "condensação",
        "isolamento"
      ]
    },
    {
      "id": "REH-COLDROOF-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Cobertura Fria: Ventilação do Desvão (Cold Roof)",
      "description": "Na cobertura fria (cold roof), o desvão ventilado não possui ventilação suficiente ({envelope.coldRoofVentilationRatio}% da área em planta).",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.roofType",
          "operator": "==",
          "value": "cold"
        },
        {
          "field": "envelope.coldRoofVentilationRatio",
          "operator": "<",
          "value": 0.5
        }
      ],
      "remediation": "Garantir ventilação adequada do desvão em cobertura fria: área de aberturas de ventilação ≥ 1/300 da área em planta (≈ 0.33%), distribuída entre beiral (entrada) e cumeeira (saída). Para coberturas com inclinação < 15°, aumentar para 1/150 (≈ 0.67%). A ventilação do desvão evita condensações na face inferior das telhas e mantém o isolamento seco. Utilizar grelhas anti-insectos nas aberturas.",
      "currentValueTemplate": "Ventilação desvão = {envelope.coldRoofVentilationRatio}% da área em planta",
      "requiredValue": "≥ 0.33% (1/300) para inclinação ≥ 15°; ≥ 0.67% (1/150) para inclinação < 15°",
      "enabled": true,
      "tags": [
        "cobertura fria",
        "cold roof",
        "desvão",
        "ventilação",
        "condensação"
      ]
    },
    {
      "id": "REH-COLDROOF-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Isolamento na Esteira em Cobertura Fria",
      "description": "O isolamento na laje de esteira da cobertura fria ({insulation.ceilingInsulationMM} mm) é insuficiente para a zona climática {location.climateZoneWinter}.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.roofType",
          "operator": "==",
          "value": "cold"
        },
        {
          "field": "insulation.ceilingInsulationMM",
          "operator": "<",
          "value": 80
        },
        {
          "field": "location.climateZoneWinter",
          "operator": "in",
          "value": ["I2", "I3"]
        }
      ],
      "remediation": "Aumentar o isolamento na laje de esteira para cumprir U máximo da cobertura. Em cobertura fria, o isolamento é colocado sobre a laje do último piso (esteira). Espessuras típicas para lã mineral (λ ≈ 0.040): I1 ≥ 80mm, I2 ≥ 100mm, I3 ≥ 120mm. Cruzar duas camadas perpendiculares para eliminar juntas. Não comprimir o isolamento com objectos armazenados — usar passadiços sobre a lã mineral.",
      "currentValueTemplate": "Isolamento esteira = {insulation.ceilingInsulationMM} mm",
      "requiredValue": "≥ 80mm (I2); ≥ 100mm (I3) para lã mineral λ ≈ 0.040 W/(m.K)",
      "enabled": true,
      "tags": [
        "cobertura fria",
        "esteira",
        "isolamento",
        "lã mineral",
        "zona climática"
      ]
    },
    {
      "id": "REH-FLATROOF-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — U Máximo de Cobertura Plana",
      "description": "O coeficiente de transmissão térmica da cobertura plana ({envelope.flatRoofUValue} W/(m².K)) excede o valor máximo para a zona climática {location.climateZoneWinter}.",
      "severity": "critical",
      "conditions": [
        {
          "field": "envelope.flatRoofUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_u_roofs",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Reforçar o isolamento da cobertura plana. Sistemas possíveis: cobertura convencional (isolamento sob impermeabilização) com barreira pára-vapor, cobertura invertida (XPS sobre impermeabilização), ou cobertura ajardinada (substrato + isolamento). A cobertura plana tem área de exposição solar máxima no verão — considerar acabamento reflectante (cool roof) ou cobertura verde para reduzir sobreaquecimento.",
      "currentValueTemplate": "U cobertura plana = {envelope.flatRoofUValue} W/(m².K)",
      "requiredValue": "Consultar Despacho 15793-K/2013: I1 ≤ 0.40 / I2 ≤ 0.35 / I3 ≤ 0.30 W/(m².K)",
      "enabled": true,
      "tags": [
        "cobertura plana",
        "flat roof",
        "valor-U",
        "isolamento",
        "impermeabilização"
      ]
    },
    {
      "id": "REH-FLATROOF-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Cobertura Plana Invertida: Resistência à Compressão do XPS",
      "description": "A resistência à compressão do XPS em cobertura plana invertida transitável ({insulation.flatRoofXPSCompStrength} kPa) é insuficiente para a utilização prevista.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.roofType",
          "operator": "==",
          "value": "inverted"
        },
        {
          "field": "insulation.flatRoofXPSCompStrength",
          "operator": "<",
          "value": 300
        },
        {
          "field": "envelope.flatRoofTrafficable",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Para cobertura plana invertida transitável, utilizar XPS com resistência à compressão CS(10) ≥ 300 kPa (tipo IV conforme classificação EPS/XPS). Para terraços com cargas pesadas (vasos, equipamentos AVAC), considerar CS(10) ≥ 500 kPa. O XPS deve ser colocado com juntas desencontradas, protegido por geotêxtil e laje de betão ou pavimento flutuante sobre apoios reguláveis.",
      "currentValueTemplate": "CS(10) XPS = {insulation.flatRoofXPSCompStrength} kPa",
      "requiredValue": "CS(10) ≥ 300 kPa para cobertura transitável; ≥ 500 kPa para cargas pesadas",
      "enabled": true,
      "tags": [
        "cobertura plana",
        "invertida",
        "XPS",
        "resistência compressão",
        "transitável"
      ]
    },
    {
      "id": "REH-DORMER-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 + EN ISO 10211 — Isolamento Térmico da Trapeira (Dormer)",
      "description": "O coeficiente de transmissão térmica da envolvente da trapeira ({envelope.dormerUValue} W/(m².K)) excede o valor máximo para a zona climática {location.climateZoneWinter}. A trapeira inclui faces verticais (paredes) e cobertura própria.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.dormerUValue",
          "operator": "lookup_gt",
          "value": null,
          "table": "max_u_walls",
          "keys": [
            "location.climateZoneWinter"
          ]
        }
      ],
      "remediation": "Isolar todas as faces da trapeira: paredes laterais e frontal (como parede exterior), cobertura da trapeira (como cobertura, U mais restritivo), e garantir continuidade com o isolamento da cobertura principal. As junções trapeira-cobertura são pontes térmicas lineares significativas — prever sobreposição do isolamento ≥ 150mm nestas ligações.",
      "currentValueTemplate": "U envolvente trapeira = {envelope.dormerUValue} W/(m².K)",
      "requiredValue": "Paredes da trapeira: mesmo U_máx que paredes; cobertura da trapeira: mesmo U_máx que cobertura",
      "enabled": true,
      "tags": [
        "trapeira",
        "dormer",
        "valor-U",
        "isolamento",
        "cobertura"
      ]
    },
    {
      "id": "REH-DORMER-02",
      "regulationId": "en-iso-10211",
      "article": "EN ISO 10211 — Pontes Térmicas Lineares nas Junções da Trapeira",
      "description": "As pontes térmicas lineares nas junções da trapeira com a cobertura principal ({envelope.dormerJunctionPsi} W/(m·K)) excedem o valor de referência.",
      "severity": "info",
      "conditions": [
        {
          "field": "envelope.dormerJunctionPsi",
          "operator": ">",
          "value": 0.3
        }
      ],
      "remediation": "Reduzir as pontes térmicas nas junções da trapeira: garantir sobreposição contínua do isolamento na ligação trapeira-cobertura (mínimo 150mm), utilizar isolamento flexível (lã mineral) para preencher geometrias complexas, prever corte térmico na base da trapeira se estrutura metálica. Modelação 3D conforme EN ISO 10211 é recomendada para quantificar ψ e χ nas ligações.",
      "currentValueTemplate": "ψ junção trapeira-cobertura = {envelope.dormerJunctionPsi} W/(m·K)",
      "requiredValue": "ψ ≤ 0.30 W/(m·K) com tratamento adequado das ligações",
      "enabled": true,
      "tags": [
        "trapeira",
        "dormer",
        "ponte térmica",
        "junção",
        "ψ"
      ]
    },
    {
      "id": "REH-BLOWER-01",
      "regulationId": "portaria-379a-2015",
      "article": "Portaria 379-A/2015 Art. 2.º — Ensaio Blower Door (Estanquidade ao Ar)",
      "description": "O ensaio de pressurização blower door não foi realizado ou o resultado n50 ({thermal.n50Value} Rph) excede o limite regulamentar. O ensaio é obrigatório quando se pretende utilizar o valor medido para cálculo de Rph e pode substituir os valores por defeito do REH.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.n50Value",
          "operator": ">",
          "value": 4.0
        }
      ],
      "remediation": "Melhorar a estanquidade ao ar do edifício e repetir o ensaio blower door conforme EN ISO 9972 (método B — edifício em uso). Pontos críticos a selar: caixas de estore, caixilharia (interface com parede), passagens de tubagens/cabos, portas exteriores (vedantes), tampas de acesso ao sótão, tomadas/interruptores em paredes exteriores. Objectivo: n50 ≤ 4.0 Rph (convencional) ou ≤ 1.0 Rph (Passive House).",
      "currentValueTemplate": "n50 = {thermal.n50Value} Rph @ 50 Pa",
      "requiredValue": "n50 ≤ 4.0 Rph (REH convencional); ≤ 3.0 Rph (NZEB); ≤ 0.6 Rph (Passive House)",
      "enabled": true,
      "tags": [
        "blower door",
        "estanquidade",
        "n50",
        "pressurização",
        "EN ISO 9972"
      ]
    },
    {
      "id": "REH-BLOWER-02",
      "regulationId": "portaria-379a-2015",
      "article": "Portaria 379-A/2015 — Protocolo de Ensaio Blower Door (EN ISO 9972)",
      "description": "O ensaio blower door não foi realizado conforme o protocolo da norma EN ISO 9972 ({thermal.blowerDoorProtocolCompliant}).",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.blowerDoorProtocolCompliant",
          "operator": "==",
          "value": false
        }
      ],
      "remediation": "Repetir o ensaio blower door conforme EN ISO 9972: método A (teste do edifício) ou método B (teste da envolvente). Requisitos: velocidade do vento ≤ 6 m/s, diferença de temperatura interior-exterior × altura do edifício ≤ 500 m.K, mínimo 5 pontos de pressão entre 10-60 Pa, despressurização e pressurização, incerteza do resultado < 15%. O relatório deve incluir condições atmosféricas, preparação do edifício, e curva de regressão.",
      "currentValueTemplate": "Protocolo EN ISO 9972 cumprido: {thermal.blowerDoorProtocolCompliant}",
      "requiredValue": "Ensaio conforme EN ISO 9972 método B, com relatório completo",
      "enabled": true,
      "tags": [
        "blower door",
        "protocolo",
        "EN ISO 9972",
        "ensaio",
        "relatório"
      ]
    },
    {
      "id": "REH-INFILT-01",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 7.º — Taxa de Renovação do Ar (Rph) Mínima",
      "description": "A taxa de renovação do ar da fracção ({ventilation.airChangeRate} Rph) é inferior ao mínimo regulamentar de 0.4 Rph, comprometendo a qualidade do ar interior.",
      "severity": "critical",
      "conditions": [
        {
          "field": "ventilation.airChangeRate",
          "operator": "<",
          "value": 0.4
        }
      ],
      "remediation": "Aumentar a taxa de renovação do ar para no mínimo 0.4 Rph. Soluções: instalar grelhas de admissão auto-reguláveis nos compartimentos principais (2 m do pavimento, ou na caixilharia), instalar extractores nos compartimentos de serviço (cozinha, IS), verificar passagens de ar sob as portas interiores (folga ≥ 8mm). Em edifícios estanques (n50 < 2), considerar VMC (Ventilação Mecânica Controlada) com recuperação de calor.",
      "currentValueTemplate": "Rph = {ventilation.airChangeRate} Rph",
      "requiredValue": "Rph ≥ 0.4 h⁻¹ (mínimo REH para qualidade do ar interior)",
      "enabled": true,
      "tags": [
        "infiltração",
        "renovação do ar",
        "Rph",
        "qualidade do ar",
        "ventilação"
      ]
    },
    {
      "id": "REH-INFILT-02",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 7.º — Taxa de Infiltração Excessiva (Rph > 0.9 sem VMC)",
      "description": "A taxa de renovação do ar ({ventilation.airChangeRate} Rph) é excessiva (> 0.9 Rph), aumentando significativamente as necessidades de aquecimento sem benefício adicional para a qualidade do ar interior.",
      "severity": "warning",
      "conditions": [
        {
          "field": "ventilation.airChangeRate",
          "operator": ">",
          "value": 0.9
        },
        {
          "field": "ventilation.hasMechanicalVentilation",
          "operator": "==",
          "value": false
        }
      ],
      "remediation": "Reduzir a taxa de infiltração para o intervalo óptimo de 0.4-0.6 Rph. Infiltração excessiva indica problemas de estanquidade: selar caixas de estore, substituir vedantes de caixilharia degradados, verificar portas exteriores, colmatar fissuras na envolvente. Realizar ensaio blower door para identificar fugas. Cada 0.1 Rph acima de 0.6 aumenta Nic em ~3-5 kWh/(m².ano).",
      "currentValueTemplate": "Rph = {ventilation.airChangeRate} Rph",
      "requiredValue": "0.4 ≤ Rph ≤ 0.6 Rph (óptimo sem VMC); ≤ 0.9 Rph (aceitável)",
      "enabled": true,
      "tags": [
        "infiltração",
        "renovação do ar",
        "Rph",
        "estanquidade",
        "perdas térmicas"
      ]
    },
    {
      "id": "REH-INFILT-03",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Rph por Defeito vs Rph Medido",
      "description": "O cálculo REH utiliza o Rph por defeito ({ventilation.rphDefault} Rph) em vez do valor medido. O valor por defeito é conservativo e pode penalizar o desempenho calculado do edifício.",
      "severity": "info",
      "conditions": [
        {
          "field": "ventilation.rphSource",
          "operator": "==",
          "value": "default"
        },
        {
          "field": "ventilation.rphDefault",
          "operator": ">",
          "value": 0.6
        }
      ],
      "remediation": "Realizar ensaio blower door (EN ISO 9972) para obter o valor medido de n50 e calcular o Rph real. O Rph por defeito do REH é calculado com base no tipo de caixilharia e exposição ao vento, sendo frequentemente conservativo (0.6-0.9 Rph). Um ensaio pode demonstrar Rph inferior, melhorando a classe energética. Custo do ensaio: ~200-400 EUR para habitação unifamiliar.",
      "currentValueTemplate": "Rph usado no cálculo: {ventilation.rphDefault} Rph (por defeito)",
      "requiredValue": "Considerar ensaio blower door para obter Rph medido (potencialmente inferior)",
      "enabled": true,
      "tags": [
        "infiltração",
        "Rph",
        "blower door",
        "valor por defeito",
        "optimização"
      ]
    },
    {
      "id": "REH-HLOSS-01",
      "regulationId": "despacho-15793k-2013",
      "article": "Despacho 15793-K/2013 — Cálculo de Perdas Térmicas pela Envolvente (Qtr)",
      "description": "As perdas térmicas por transmissão pela envolvente ({thermal.transmissionHeatLoss} W/K) excedem o valor de referência para a área de envolvente e zona climática, indicando isolamento insuficiente ou área excessiva de envolvente.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.transmissionHeatLoss",
          "operator": "formula_gt",
          "value": "thermal.transmissionHeatLossRef"
        }
      ],
      "remediation": "Reduzir as perdas por transmissão: reforçar isolamento dos elementos com maior HTR (tipicamente cobertura e paredes exteriores), tratar pontes térmicas lineares e planas, melhorar envidraçados. O coeficiente de transferência por transmissão Htr = Σ(Ui × Ai) + Σ(ψj × Bj) + Σ(χk). Priorizar elementos com maior contribuição (Ui × Ai) no cálculo.",
      "currentValueTemplate": "Htr = {thermal.transmissionHeatLoss} W/K",
      "requiredValue": "Htr ≤ {thermal.transmissionHeatLossRef} W/K (valor de referência para a envolvente)",
      "enabled": true,
      "tags": [
        "perdas térmicas",
        "transmissão",
        "Htr",
        "envolvente",
        "cálculo"
      ]
    },
    {
      "id": "REH-HLOSS-02",
      "regulationId": "despacho-15793k-2013",
      "article": "Despacho 15793-K/2013 — Perdas Térmicas por Ventilação (Qve)",
      "description": "As perdas térmicas por ventilação ({thermal.ventilationHeatLoss} W/K) são excessivas face ao Rph e volume do edifício, indicando infiltração descontrolada ou ventilação sobre-dimensionada.",
      "severity": "warning",
      "conditions": [
        {
          "field": "thermal.ventilationHeatLoss",
          "operator": "formula_gt",
          "value": "thermal.ventilationHeatLossRef"
        }
      ],
      "remediation": "Reduzir as perdas por ventilação: Hve = 0.34 × Rph × Ap × Pd. Melhorar a estanquidade ao ar (reduzir Rph), instalar VMC com recuperação de calor (eficiência ≥ 70%), dimensionar a ventilação para o Rph mínimo (0.4 Rph). Em edifícios com Rph elevado, a VMC com recuperação pode reduzir as perdas por ventilação em 50-70%.",
      "currentValueTemplate": "Hve = {thermal.ventilationHeatLoss} W/K",
      "requiredValue": "Hve ≤ {thermal.ventilationHeatLossRef} W/K (referência para Rph = 0.4-0.6)",
      "enabled": true,
      "tags": [
        "perdas térmicas",
        "ventilação",
        "Hve",
        "recuperação de calor",
        "VMC"
      ]
    },
    {
      "id": "REH-HLOSS-03",
      "regulationId": "despacho-15793k-2013",
      "article": "Despacho 15793-K/2013 — Balanço Energético: Razão Ganhos/Perdas",
      "description": "A razão entre ganhos solares e internos e as perdas térmicas totais ({thermal.gainLossRatio}) é inferior a 0.3, indicando que o edifício beneficia pouco dos ganhos passivos.",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.gainLossRatio",
          "operator": "<",
          "value": 0.3
        }
      ],
      "remediation": "Aumentar a razão ganhos/perdas: maximizar ganhos solares de inverno (envidraçados orientados a sul, sem sombreamento excessivo de inverno), reduzir perdas pela envolvente (isolamento), e optimizar inércia térmica para aproveitar ganhos intermitentes. Uma razão ganhos/perdas de 0.4-0.6 indica bom equilíbrio passivo. Edifícios com ratio < 0.3 dependem excessivamente de aquecimento activo.",
      "currentValueTemplate": "Razão ganhos/perdas = {thermal.gainLossRatio}",
      "requiredValue": "≥ 0.30 (recomendado 0.40-0.60 para bom balanço passivo)",
      "enabled": true,
      "tags": [
        "balanço energético",
        "ganhos solares",
        "perdas térmicas",
        "passivo",
        "razão"
      ]
    },
    {
      "id": "REH-HDD-01",
      "regulationId": "despacho-15793f-2013",
      "article": "Despacho 15793-F/2013 — Graus-Dia de Aquecimento: Correcção por Altitude",
      "description": "Os graus-dia de aquecimento utilizados ({location.heatingDegreeDays} GD) não foram corrigidos para a altitude real do edifício ({location.altitudeM} m), resultando em cálculo impreciso das necessidades de aquecimento.",
      "severity": "warning",
      "conditions": [
        {
          "field": "location.heatingDegreeDaysAdjusted",
          "operator": "==",
          "value": false
        },
        {
          "field": "location.altitudeM",
          "operator": ">",
          "value": 200
        }
      ],
      "remediation": "Corrigir os graus-dia de aquecimento para a altitude real conforme Despacho 15793-F/2013: GD_corrigido = GD_ref + a × (z - z_ref), onde a é o declive de ajustamento por município (tipicamente 1.5-2.5 GD/m), z a altitude real, e z_ref a altitude de referência do município. Para cada 100m de altitude adicional, os GD aumentam ~150-250 GD, o que pode alterar a zona climática de inverno.",
      "currentValueTemplate": "GD = {location.heatingDegreeDays} (sem correcção altitude); altitude = {location.altitudeM} m",
      "requiredValue": "GD corrigidos para altitude real conforme Despacho 15793-F/2013 Tabela 01",
      "enabled": true,
      "tags": [
        "graus-dia",
        "GD",
        "altitude",
        "correcção",
        "zona climática"
      ]
    },
    {
      "id": "REH-HDD-02",
      "regulationId": "despacho-15793f-2013",
      "article": "Despacho 15793-F/2013 — Duração da Estação de Aquecimento (M) por Graus-Dia",
      "description": "A duração da estação de aquecimento ({location.heatingSeasonMonths} meses) não é coerente com os graus-dia corrigidos ({location.heatingDegreeDays} GD) para o município.",
      "severity": "info",
      "conditions": [
        {
          "field": "location.heatingSeasonMonths",
          "operator": "<",
          "value": 4
        },
        {
          "field": "location.heatingDegreeDays",
          "operator": ">",
          "value": 1300
        }
      ],
      "remediation": "Verificar a coerência entre GD e duração da estação de aquecimento M conforme Despacho 15793-F/2013: M = M_ref + a × (z - z_ref). Para GD > 1300, a estação de aquecimento é tipicamente ≥ 6 meses. A duração M é utilizada no cálculo de Ni e afecta directamente as necessidades de aquecimento. Limiares: I1 (GD ≤ 1300, M ≤ 5.3), I2 (1300 < GD ≤ 1800, 5.3 < M ≤ 7.3), I3 (GD > 1800, M > 7.3).",
      "currentValueTemplate": "M = {location.heatingSeasonMonths} meses; GD = {location.heatingDegreeDays}",
      "requiredValue": "M coerente com GD: para GD > 1300, M ≥ 5.3 meses (tipicamente ≥ 6 meses)",
      "enabled": true,
      "tags": [
        "graus-dia",
        "GD",
        "estação aquecimento",
        "duração",
        "M"
      ]
    },
    {
      "id": "REH-HDD-03",
      "regulationId": "despacho-15793f-2013",
      "article": "Despacho 15793-F/2013 — Temperatura Exterior de Verão: Correcção por Distância ao Litoral",
      "description": "A temperatura exterior média de verão ({location.summerExteriorTemp}°C) não foi corrigida para a distância real ao litoral ({location.distanceToCoastKm} km), afectando a zona climática de verão.",
      "severity": "info",
      "conditions": [
        {
          "field": "location.summerTempAdjusted",
          "operator": "==",
          "value": false
        },
        {
          "field": "location.distanceToCoastKm",
          "operator": ">",
          "value": 30
        }
      ],
      "remediation": "Corrigir a temperatura exterior de verão para a distância real ao litoral conforme Despacho 15793-F/2013: θ_ext,v_corrigido = θ_ext,v_ref + b × (d - d_ref), onde b é o declive por município e d a distância ao litoral. A proximidade do mar modera as temperaturas de verão. Para locais a > 30km do litoral, a temperatura pode ser 1-3°C superior ao litoral, passando de V1/V2 para V2/V3.",
      "currentValueTemplate": "θ_ext,v = {location.summerExteriorTemp}°C; distância litoral = {location.distanceToCoastKm} km",
      "requiredValue": "θ_ext,v corrigida para distância ao litoral conforme Despacho 15793-F/2013",
      "enabled": true,
      "tags": [
        "temperatura verão",
        "litoral",
        "correcção",
        "zona climática",
        "V1/V2/V3"
      ]
    },
    {
      "id": "REH-RENMIN-04",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 Art. 9.º — Melhoria do Factor Solar em Renovação",
      "description": "Na renovação térmica, o factor solar dos envidraçados substituídos com protecção ({envelope.rehabGTvc}) excede o máximo para a zona climática de verão {location.climateZoneSummer}.",
      "severity": "warning",
      "conditions": [
        {
          "field": "isRehabilitation",
          "operator": "==",
          "value": true
        },
        {
          "field": "envelope.rehabGTvc",
          "operator": ">",
          "value": 0.56
        },
        {
          "field": "location.climateZoneSummer",
          "operator": "in",
          "value": ["V2", "V3"]
        }
      ],
      "remediation": "Instalar protecções solares exteriores nos envidraçados substituídos (estores, portadas, screen). Em renovação, aproveitar a substituição de janelas para integrar sombreamento exterior eficaz. Para zonas V2/V3, gT,vc ≤ 0.56 para envidraçados a Sul, Este e Oeste. Considerar vidro de controlo solar para reduzir o gT,vi base.",
      "currentValueTemplate": "gT,vc envidraçado renovado = {envelope.rehabGTvc}",
      "requiredValue": "gT,vc ≤ 0.56 para zonas V2/V3 conforme Portaria 349-B/2013",
      "enabled": true,
      "tags": [
        "reabilitação",
        "renovação",
        "factor solar",
        "envidraçados",
        "sombreamento"
      ]
    },
    {
      "id": "REH-BLOWER-03",
      "regulationId": "portaria-379a-2015",
      "article": "Portaria 379-A/2015 — Estanquidade: Classe de Permeabilidade da Caixilharia",
      "description": "A classe de permeabilidade ao ar da caixilharia ({envelope.windowAirPermeabilityClass}) é insuficiente para garantir a estanquidade ao ar mínima do edifício.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.windowAirPermeabilityClass",
          "operator": "ordinal_lt",
          "value": "3",
          "scale": [
            "1",
            "2",
            "3",
            "4"
          ]
        }
      ],
      "remediation": "Substituir a caixilharia por modelos com classe de permeabilidade ao ar ≥ 3 (conforme EN 12207). Classe 3 corresponde a fugas ≤ 9 m³/(h.m²) a 100 Pa. Para edifícios NZEB ou Passive House, exigir classe 4 (≤ 3 m³/(h.m²) a 100 Pa). A classe de permeabilidade é essencial para controlar a infiltração e é o factor dominante na estanquidade ao ar do edifício.",
      "currentValueTemplate": "Classe permeabilidade caixilharia: {envelope.windowAirPermeabilityClass}",
      "requiredValue": "≥ classe 3 (EN 12207); classe 4 para NZEB/Passive House",
      "enabled": true,
      "tags": [
        "estanquidade",
        "caixilharia",
        "permeabilidade ao ar",
        "EN 12207",
        "classe"
      ]
    },
    {
      "id": "REH-ENVTEST-01",
      "regulationId": "portaria-379a-2015",
      "article": "Portaria 379-A/2015 — Requisito de Ensaio de Estanquidade da Envolvente",
      "description": "O edifício com classe energética pretendida A ou superior não realizou ensaio de estanquidade da envolvente (blower door) para demonstrar conformidade ({thermal.blowerDoorTestPerformed}).",
      "severity": "info",
      "conditions": [
        {
          "field": "thermal.blowerDoorTestPerformed",
          "operator": "==",
          "value": false
        },
        {
          "field": "energy.targetEnergyClass",
          "operator": "ordinal_lte",
          "value": "A",
          "scale": [
            "A+",
            "A",
            "B",
            "B-",
            "C",
            "D",
            "E",
            "F"
          ]
        }
      ],
      "remediation": "Realizar ensaio blower door conforme EN ISO 9972 para validar a estanquidade da envolvente. Para classe A ou superior, o ensaio permite: (1) usar o Rph medido em vez do valor por defeito (geralmente mais favorável), (2) demonstrar qualidade construtiva, (3) identificar e corrigir fugas antes da utilização. Custo do ensaio: ~200-400 EUR, com potencial benefício significativo na classificação energética.",
      "currentValueTemplate": "Ensaio blower door realizado: {thermal.blowerDoorTestPerformed}",
      "requiredValue": "Recomendado para classe A/A+ — permite Rph medido no cálculo REH",
      "enabled": true,
      "tags": [
        "blower door",
        "ensaio",
        "estanquidade",
        "classe energética",
        "envolvente"
      ]
    },
    {
      "id": "REH-HLOSS-04",
      "regulationId": "despacho-15793k-2013",
      "article": "Despacho 15793-K/2013 — Factor de Conversão de Energia Primária (Fpu) Aplicado",
      "description": "O factor de conversão de energia primária (Fpu) para electricidade utilizado no cálculo ({thermal.fpuElectricity}) difere do valor regulamentar de 2.5 kWhEP/kWh conforme Despacho 15793-K/2013.",
      "severity": "critical",
      "conditions": [
        {
          "field": "thermal.fpuElectricity",
          "operator": "!=",
          "value": 2.5
        }
      ],
      "remediation": "Corrigir o Fpu de electricidade para 2.5 kWhEP/kWh conforme Despacho 15793-K/2013. O Fpu converte energia final em energia primária para o cálculo de Ntc. Valores regulamentares: electricidade Fpu = 2.5, gás natural Fpu = 1.0, GPL Fpu = 1.0, gasóleo Fpu = 1.0, biomassa Fpu = 1.0, renováveis produzidas no local Fpu = 1.0 (para exportação = 2.5).",
      "currentValueTemplate": "Fpu electricidade = {thermal.fpuElectricity} kWhEP/kWh",
      "requiredValue": "Fpu = 2.5 kWhEP/kWh conforme Despacho 15793-K/2013",
      "enabled": true,
      "tags": [
        "Fpu",
        "energia primária",
        "electricidade",
        "conversão",
        "Ntc"
      ]
    },
    {
      "id": "REH-CAVITY-03",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Ponte Térmica na Caixa-de-Ar: Grampos Metálicos",
      "description": "A parede dupla com caixa-de-ar possui grampos metálicos de ligação entre panos ({envelope.cavityWallMetalTies}) sem isolamento, criando pontes térmicas pontuais significativas.",
      "severity": "info",
      "conditions": [
        {
          "field": "envelope.cavityWallMetalTies",
          "operator": "==",
          "value": true
        },
        {
          "field": "envelope.cavityTiesInsulated",
          "operator": "==",
          "value": false
        }
      ],
      "remediation": "Utilizar grampos de ligação em aço inoxidável com disco de isolamento térmico (break térmico) ou grampos em material compósito (fibra de vidro, basalto). Cada grampo metálico sem isolamento introduz χ ≈ 0.002-0.005 W/K. Com 4-6 grampos/m², o acréscimo ΔU pode atingir 0.01-0.03 W/(m².K). Grampos com disco isolante reduzem χ para < 0.001 W/K.",
      "currentValueTemplate": "Grampos metálicos sem isolamento na caixa-de-ar",
      "requiredValue": "Grampos com corte térmico ou material compósito (χ < 0.001 W/K)",
      "enabled": true,
      "tags": [
        "caixa-de-ar",
        "grampos",
        "ponte térmica pontual",
        "χ",
        "parede dupla"
      ]
    },
    {
      "id": "REH-FLATROOF-03",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Cobertura Plana: Acabamento Reflectante (Cool Roof)",
      "description": "A cobertura plana não possui acabamento reflectante ({envelope.flatRoofCoolRoofApplied}) em zona climática de verão V2 ou V3, aumentando as necessidades de arrefecimento.",
      "severity": "info",
      "conditions": [
        {
          "field": "envelope.flatRoofCoolRoofApplied",
          "operator": "==",
          "value": false
        },
        {
          "field": "location.climateZoneSummer",
          "operator": "in",
          "value": ["V2", "V3"]
        },
        {
          "field": "envelope.hasFlatRoof",
          "operator": "==",
          "value": true
        }
      ],
      "remediation": "Aplicar acabamento reflectante (cool roof) na cobertura plana: tinta reflectante branca com coeficiente de absorção solar α ≤ 0.40 (recomendado α ≤ 0.30). Alternativas: membrana de impermeabilização de cor clara, cobertura verde (substrato + vegetação), ou seixo branco. Em zonas V2/V3, o cool roof pode reduzir a temperatura superficial da cobertura em 20-30°C e as necessidades de arrefecimento em 10-25%.",
      "currentValueTemplate": "Cool roof aplicado: {envelope.flatRoofCoolRoofApplied}",
      "requiredValue": "Recomendado em zonas V2/V3: α ≤ 0.40 (reflectância solar ≥ 0.60)",
      "enabled": true,
      "tags": [
        "cobertura plana",
        "cool roof",
        "reflectante",
        "arrefecimento",
        "absorção solar"
      ]
    },
    {
      "id": "REH-ISOMAT-04",
      "regulationId": "portaria-349b-2013-reh",
      "article": "Portaria 349-B/2013 — Resistência ao Fogo do Isolamento em Vias de Evacuação",
      "description": "O isolamento térmico em vias de evacuação ({insulation.evacuationRouteType}) não atinge a classe de reacção ao fogo A2-s1,d0 exigida para estes espaços.",
      "severity": "critical",
      "conditions": [
        {
          "field": "insulation.isEvacuationRoute",
          "operator": "==",
          "value": true
        },
        {
          "field": "insulation.evacuationRouteFireClass",
          "operator": "ordinal_gt",
          "value": "A2-s1,d0",
          "scale": [
            "A1",
            "A2-s1,d0",
            "B-s1,d0",
            "B-s2,d0",
            "C-s2,d0",
            "D-s2,d0",
            "E",
            "F"
          ]
        }
      ],
      "remediation": "Em vias de evacuação (escadas, corredores de acesso), utilizar exclusivamente isolamento de classe A1 (lã mineral, vidro celular) ou A2-s1,d0 (lã mineral com revestimento). EPS, XPS, PUR e PIR não são admissíveis em vias de evacuação sem protecção por barreira incombustível (ex: gesso cartonado tipo F, 2 × BA13). Verificar conformidade com SCIE (Regulamento de Segurança Contra Incêndios).",
      "currentValueTemplate": "Isolamento em via de evacuação: {insulation.evacuationRouteFireClass}",
      "requiredValue": "Classe A1 ou A2-s1,d0 em vias de evacuação (SCIE)",
      "enabled": true,
      "tags": [
        "isolamento",
        "fogo",
        "via de evacuação",
        "SCIE",
        "segurança"
      ]
    },
    {
      "id": "REH-CURTWALL-03",
      "regulationId": "portaria-379a-2015",
      "article": "Portaria 379-A/2015 — Corte Térmico dos Perfis da Fachada Cortina",
      "description": "Os perfis da fachada cortina não possuem corte térmico adequado ({envelope.curtainWallThermalBreak}). Perfis sem corte térmico (alumínio contínuo) têm Uf > 5.0 W/(m².K), degradando significativamente o Ucw global.",
      "severity": "warning",
      "conditions": [
        {
          "field": "envelope.curtainWallThermalBreak",
          "operator": "==",
          "value": false
        }
      ],
      "remediation": "Especificar perfis de fachada cortina com corte térmico em poliamida (PA6.6) com espessura ≥ 24mm. O Uf dos perfis com corte térmico típico: 2.0-3.5 W/(m².K) vs 5.0-7.0 W/(m².K) sem corte térmico. Para desempenho elevado (NZEB), considerar perfis com Uf ≤ 1.8 W/(m².K) (corte térmico ≥ 34mm com preenchimento de espuma isolante). A contribuição dos perfis no Ucw é significativa (10-20% da área).",
      "currentValueTemplate": "Corte térmico fachada cortina: {envelope.curtainWallThermalBreak}",
      "requiredValue": "Corte térmico PA6.6 ≥ 24mm nos perfis (Uf ≤ 3.5 W/(m².K))",
      "enabled": true,
      "tags": [
        "fachada cortina",
        "corte térmico",
        "perfis",
        "alumínio",
        "Uf"
      ]
    },
    {
      "id": "REH-RENMIN-05",
      "regulationId": "dl-101d-2020-nzeb",
      "article": "DL 101-D/2020 — Classe Energética Mínima Após Grande Renovação",
      "description": "Após grande renovação, a classe energética do edifício ({energy.postRenovationClass}) não atinge o mínimo de B- exigido pelo REH.",
      "severity": "critical",
      "conditions": [
        {
          "field": "isRehabilitation",
          "operator": "==",
          "value": true
        },
        {
          "field": "renovation.isMajorRenovation",
          "operator": "==",
          "value": true
        },
        {
          "field": "energy.postRenovationClass",
          "operator": "ordinal_gt",
          "value": "B-",
          "scale": [
            "A+",
            "A",
            "B",
            "B-",
            "C",
            "D",
            "E",
            "F"
          ]
        }
      ],
      "remediation": "Em grande renovação (intervenção em > 25% da envolvente ou custo > 25% do valor do edifício), o edifício deve atingir classe energética B- ou superior (Ntc/Nt ≤ 1.0). Reforçar o pacote de medidas: envolvente (ETICS, cobertura, envidraçados), sistemas (bomba de calor, VMC), e renováveis (solar térmico, PV). Considerar o apoio financeiro do Fundo Ambiental e PRR.",
      "currentValueTemplate": "Classe energética pós-renovação: {energy.postRenovationClass}",
      "requiredValue": "≥ B- (Ntc/Nt ≤ 1.0) para grande renovação",
      "enabled": true,
      "tags": [
        "reabilitação",
        "grande renovação",
        "classe energética",
        "B-",
        "obrigatório"
      ]
    }
  ]
}
