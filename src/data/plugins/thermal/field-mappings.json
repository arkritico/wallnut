{
  "pluginId": "thermal",
  "version": "1.0.0",
  "description": "Mapeamento de campos para regras REH (Regulamento de Desempenho Energético dos Edifícios de Habitação — Portaria 349-B/2013)",
  "fields": [
    {
      "_group": "Dados Climáticos",
      "field": "location.heatingDegreeDays",
      "label": "Graus-dia de aquecimento",
      "type": "number",
      "unit": "\u00b0C.dia",
      "sources": ["form"],
      "required": true,
      "description": "Número de graus-dia de aquecimento na base de 18 \u00b0C para a localidade do edifício (Despacho 15793-F/2013)"
    },
    {
      "_group": "Dados Climáticos",
      "field": "location.climateZoneWinter",
      "label": "Zona climática de inverno",
      "type": "select",
      "options": [
        { "value": "I1", "label": "I1 — Inverno pouco severo" },
        { "value": "I2", "label": "I2 — Inverno moderado" },
        { "value": "I3", "label": "I3 — Inverno severo" }
      ],
      "sources": ["form"],
      "required": true,
      "description": "Zona climática de inverno conforme Despacho 15793-F/2013 (determinada pelos graus-dia)"
    },
    {
      "_group": "Dados Climáticos",
      "field": "location.climateZoneSummer",
      "label": "Zona climática de verão",
      "type": "select",
      "options": [
        { "value": "V1", "label": "V1 — Verão pouco severo" },
        { "value": "V2", "label": "V2 — Verão moderado" },
        { "value": "V3", "label": "V3 — Verão severo" }
      ],
      "sources": ["form"],
      "description": "Zona climática de verão conforme Despacho 15793-F/2013 (determinada pela temperatura exterior)"
    },
    {
      "_group": "Dados Climáticos",
      "field": "location.summerExteriorTemp",
      "label": "Temperatura exterior de projeto (verão)",
      "type": "number",
      "unit": "\u00b0C",
      "sources": ["form"],
      "description": "Temperatura exterior de projeto para a estação de arrefecimento na localidade"
    },
    {
      "_group": "Dados Climáticos",
      "field": "building.isNew",
      "label": "Edifício novo",
      "type": "boolean",
      "sources": ["form"],
      "required": true,
      "defaults": { "_default": true },
      "description": "Indica se o edifício é de construção nova (aplica requisitos mais exigentes do REH)"
    },

    {
      "_group": "Envolvente Opaca",
      "field": "envelope.externalWallUValue",
      "label": "Coeficiente U da parede exterior",
      "type": "number",
      "unit": "W/(m\u00b2.\u00b0C)",
      "sources": ["ifc", "form"],
      "ifcMapping": {
        "entity": "IfcWall",
        "filter": "IsExternal=true",
        "property": "ThermalTransmittance",
        "pset": "Pset_WallCommon"
      },
      "required": true,
      "description": "Coeficiente de transmissão térmica da parede exterior — valores máximos conforme zona climática"
    },
    {
      "_group": "Envolvente Opaca",
      "field": "envelope.roofUValue",
      "label": "Coeficiente U da cobertura",
      "type": "number",
      "unit": "W/(m\u00b2.\u00b0C)",
      "sources": ["ifc", "form"],
      "ifcMapping": {
        "entity": "IfcRoof",
        "property": "ThermalTransmittance",
        "pset": "Pset_RoofCommon"
      },
      "required": true,
      "description": "Coeficiente de transmissão térmica da cobertura exterior"
    },
    {
      "_group": "Envolvente Opaca",
      "field": "envelope.floorUValue",
      "label": "Coeficiente U do pavimento",
      "type": "number",
      "unit": "W/(m\u00b2.\u00b0C)",
      "sources": ["ifc", "form"],
      "ifcMapping": {
        "entity": "IfcSlab",
        "property": "ThermalTransmittance",
        "pset": "Pset_SlabCommon"
      },
      "description": "Coeficiente de transmissão térmica do pavimento exterior ou sobre espaço não aquecido"
    },
    {
      "_group": "Envolvente Opaca",
      "field": "envelope.interiorWallHighBtrUValue",
      "label": "Coeficiente U de parede interior (btr > 0,7)",
      "type": "number",
      "unit": "W/(m\u00b2.\u00b0C)",
      "sources": ["form"],
      "description": "Coeficiente de transmissão térmica de paredes interiores em contacto com espaços com btr > 0,7"
    },
    {
      "_group": "Envolvente Opaca",
      "field": "envelope.adjacentWallUValue",
      "label": "Coeficiente U de parede adjacente",
      "type": "number",
      "unit": "W/(m\u00b2.\u00b0C)",
      "sources": ["form"],
      "description": "Coeficiente de transmissão térmica de parede em contacto com edifício adjacente"
    },
    {
      "_group": "Envolvente Opaca",
      "field": "envelope.floorOverUnheatedUValue",
      "label": "Coeficiente U do pavimento sobre espaço não aquecido",
      "type": "number",
      "unit": "W/(m\u00b2.\u00b0C)",
      "sources": ["form"],
      "description": "Coeficiente de transmissão térmica do pavimento sobre espaço não útil (garagem, cave)"
    },
    {
      "_group": "Envolvente Opaca",
      "field": "envelope.groundFloorUValue",
      "label": "Coeficiente U do pavimento em contacto com o solo",
      "type": "number",
      "unit": "W/(m\u00b2.\u00b0C)",
      "sources": ["form"],
      "description": "Coeficiente de transmissão térmica do pavimento em contacto com o solo (inclui resistência do solo)"
    },
    {
      "_group": "Envolvente Opaca",
      "field": "envelope.externalDoorUValue",
      "label": "Coeficiente U da porta exterior",
      "type": "number",
      "unit": "W/(m\u00b2.\u00b0C)",
      "sources": ["form"],
      "description": "Coeficiente de transmissão térmica da porta exterior opaca"
    },
    {
      "_group": "Envolvente Opaca",
      "field": "energy.thermalInertiaMass",
      "label": "Massa de inércia térmica",
      "type": "number",
      "unit": "kg/m\u00b2",
      "sources": ["form"],
      "required": true,
      "description": "Massa superficial útil por unidade de área de pavimento para classificação da inércia térmica (fraca < 150, média 150-400, forte > 400)"
    },

    {
      "_group": "Vãos Envidraçados",
      "field": "envelope.windowUValue",
      "label": "Coeficiente U dos vãos envidraçados",
      "type": "number",
      "unit": "W/(m\u00b2.\u00b0C)",
      "sources": ["ifc", "form"],
      "ifcMapping": {
        "entity": "IfcWindow",
        "property": "ThermalTransmittance",
        "pset": "Pset_WindowCommon"
      },
      "required": true,
      "description": "Coeficiente de transmissão térmica dos vãos envidraçados (vidro + caixilharia)"
    },
    {
      "_group": "Vãos Envidraçados",
      "field": "envelope.windowSolarFactor",
      "label": "Fator solar do vão envidraçado",
      "type": "number",
      "sources": ["form"],
      "description": "Fator solar global do vão envidraçado com proteção solar ativada (g\u22a5vi)"
    },
    {
      "_group": "Vãos Envidraçados",
      "field": "envelope.hasExteriorSolarProtection",
      "label": "Proteção solar exterior nos vãos",
      "type": "boolean",
      "sources": ["form"],
      "defaults": { "_default": false },
      "description": "Indica se os vãos envidraçados possuem dispositivos de proteção solar pelo exterior (estores, portadas, palas)"
    },

    {
      "_group": "Pontes Térmicas",
      "field": "envelope.thermalBridgeCoefficient",
      "label": "Coeficiente de transmissão térmica linear",
      "type": "number",
      "unit": "W/(m.\u00b0C)",
      "sources": ["form"],
      "description": "Coeficiente de transmissão térmica linear das pontes térmicas lineares (\u03c8)"
    },

    {
      "_group": "Ventilação",
      "field": "envelope.airChangesPerHour",
      "label": "Renovações de ar por hora",
      "type": "number",
      "unit": "h\u207b\u00b9",
      "sources": ["form"],
      "required": true,
      "defaults": { "_default": 0.6 },
      "description": "Taxa de renovação de ar do edifício (Rph) — mínimo regulamentar de 0,4 h\u207b\u00b9"
    },
    {
      "_group": "Ventilação",
      "field": "envelope.ventilationType",
      "label": "Tipo de ventilação",
      "type": "select",
      "options": [
        { "value": "natural", "label": "Ventilação natural" },
        { "value": "mechanical", "label": "Ventilação mecânica" },
        { "value": "hybrid", "label": "Ventilação híbrida" }
      ],
      "sources": ["form"],
      "defaults": { "_default": "natural" },
      "description": "Tipo de sistema de ventilação do edifício conforme REH"
    },
    {
      "_group": "Ventilação",
      "field": "envelope.hasSelfRegulatingGrilles",
      "label": "Grelhas autorreguláveis",
      "type": "boolean",
      "sources": ["form"],
      "defaults": { "_default": false },
      "description": "Indica se existem grelhas de admissão de ar autorreguláveis nas fachadas"
    },
    {
      "_group": "Ventilação",
      "field": "envelope.kitchenExtractionRate",
      "label": "Caudal de extração da cozinha",
      "type": "number",
      "unit": "m\u00b3/h",
      "sources": ["form"],
      "description": "Caudal de extração de ar na cozinha conforme NP 1037-1"
    },
    {
      "_group": "Ventilação",
      "field": "envelope.bathroomExtractionRate",
      "label": "Caudal de extração da casa de banho",
      "type": "number",
      "unit": "m\u00b3/h",
      "sources": ["form"],
      "description": "Caudal de extração de ar nas instalações sanitárias conforme NP 1037-1"
    },
    {
      "_group": "Ventilação",
      "field": "envelope.heatRecoveryEfficiency",
      "label": "Eficiência do recuperador de calor",
      "type": "number",
      "unit": "%",
      "sources": ["form"],
      "description": "Eficiência nominal do sistema de recuperação de calor na ventilação mecânica"
    },

    {
      "_group": "Sistemas e Renováveis",
      "field": "energy.hasSolarThermal",
      "label": "Sistema solar térmico",
      "type": "boolean",
      "sources": ["form"],
      "required": true,
      "defaults": { "_default": false },
      "description": "Indica se o edifício possui sistema solar térmico para AQS (obrigatório em edifícios novos — Art. 27.º REH)"
    },
    {
      "_group": "Sistemas e Renováveis",
      "field": "envelope.solarCollectorArea",
      "label": "Área de coletores solares",
      "type": "number",
      "unit": "m\u00b2",
      "sources": ["form"],
      "description": "Área total de captação dos coletores solares térmicos instalados"
    },
    {
      "_group": "Sistemas e Renováveis",
      "field": "envelope.dhwHeatPumpCOP",
      "label": "COP da bomba de calor para AQS",
      "type": "number",
      "sources": ["form"],
      "description": "Coeficiente de desempenho (COP) da bomba de calor dedicada à produção de AQS"
    },

    {
      "_group": "Necessidades Energéticas",
      "field": "energy.energyClassRatio",
      "label": "Rácio de classe energética (Ntc/Nt)",
      "type": "number",
      "sources": ["form"],
      "required": true,
      "description": "Rácio entre necessidades nominais globais de energia primária e o limite regulamentar — determina a classe energética"
    },
    {
      "_group": "Necessidades Energéticas",
      "field": "energy.heatingNeeds",
      "label": "Necessidades de aquecimento (Nic)",
      "type": "number",
      "unit": "kWh/m\u00b2.ano",
      "sources": ["form"],
      "description": "Necessidades nominais anuais de energia útil para aquecimento"
    },
    {
      "_group": "Necessidades Energéticas",
      "field": "energy.coolingNeeds",
      "label": "Necessidades de arrefecimento (Nvc)",
      "type": "number",
      "unit": "kWh/m\u00b2.ano",
      "sources": ["form"],
      "description": "Necessidades nominais anuais de energia útil para arrefecimento"
    },
    {
      "_group": "Necessidades Energéticas",
      "field": "energy.dhwNeeds",
      "label": "Necessidades de AQS (Qa)",
      "type": "number",
      "unit": "kWh/ano",
      "sources": ["form"],
      "description": "Necessidades anuais de energia para preparação de águas quentes sanitárias"
    },
    {
      "_group": "Necessidades Energéticas",
      "field": "energy.primaryEnergyNeeds",
      "label": "Necessidades de energia primária (Ntc)",
      "type": "number",
      "unit": "kWhEP/m\u00b2.ano",
      "sources": ["form"],
      "description": "Necessidades nominais globais anuais de energia primária do edifício"
    }
  ]
}