# ğŸ—ï¸ Framework Universal de ValidaÃ§Ã£o - Todas as Especialidades

**Objetivo:** Criar um sistema de validaÃ§Ã£o profunda para TODAS as especialidades de projeto, seguindo o padrÃ£o RTIEBT.

---

## ğŸ“Š Especialidades a Cobrir

### 1. âš¡ InstalaÃ§Ãµes ElÃ©tricas (RTIEBT)
**Status:** âœ… COMPLETO - 292 regras
- Regulamentos: RTIEBT, RSRDEEBT, Portaria 1532/2008
- Engine especializado implementado
- PadrÃ£o de referÃªncia para outras especialidades

### 2. ğŸš° InstalaÃ§Ãµes de Ãguas e Esgotos
**Status:** ğŸ”´ A IMPLEMENTAR
- Regulamentos:
  - Decreto Regulamentar 23/95 (RGSPPDADAR)
  - NP EN 806 (InstalaÃ§Ãµes prediais de Ã¡gua fria e quente)
  - NP EN 1717 (ProteÃ§Ã£o contra poluiÃ§Ã£o da Ã¡gua potÃ¡vel)
  - NP EN 12056 (Sistemas de drenagem por gravidade)
- Regras exemplo:
  - PressÃ£o mÃ­nima/mÃ¡xima nas torneiras
  - DiÃ¢metros mÃ­nimos por aparelho
  - Declives mÃ­nimos em drenagens
  - Caixas de visita/inspeÃ§Ã£o
  - Sistemas de tratamento (fossas, ETAR)

### 3. ğŸ”¥ SeguranÃ§a Contra IncÃªndios (SCIE)
**Status:** ğŸ”´ A IMPLEMENTAR
- Regulamentos:
  - Decreto-Lei 220/2008 (SCIE)
  - Portaria 1532/2008
  - Despacho 2074/2009
- Regras exemplo:
  - CompartimentaÃ§Ã£o corta-fogo (REI)
  - Caminhos de evacuaÃ§Ã£o (largura, distÃ¢ncia)
  - SinalizaÃ§Ã£o e iluminaÃ§Ã£o emergÃªncia
  - Extintores e bocas de incÃªndio
  - DeteÃ§Ã£o e alarme
  - Controlo de fumos

### 4. â„ï¸ AVAC (ClimatizaÃ§Ã£o)
**Status:** ğŸ”´ A IMPLEMENTAR
- Regulamentos:
  - RSECE (DL 118/2013)
  - REH (DL 95/2021) - Regulamento de HabitaÃ§Ã£o
  - NP 1037 (VentilaÃ§Ã£o e evacuaÃ§Ã£o de produtos de combustÃ£o)
- Regras exemplo:
  - Taxas de renovaÃ§Ã£o de ar
  - Caudais mÃ­nimos por espaÃ§o
  - EficiÃªncia energÃ©tica (SCOP, SEER)
  - Tratamento de ar (filtraÃ§Ã£o)
  - Condutas e isolamentos

### 5. â›½ InstalaÃ§Ãµes de GÃ¡s
**Status:** ğŸ”´ A IMPLEMENTAR
- Regulamentos:
  - RGSPGN (DL 521/99)
  - NP 1037 (VentilaÃ§Ã£o)
  - NP EN 1775 (InstalaÃ§Ãµes interiores de gÃ¡s)
- Regras exemplo:
  - VentilaÃ§Ã£o de compartimentos com aparelhos
  - DiÃ¢metros e materiais de tubagem
  - VÃ¡lvulas de seguranÃ§a
  - DistÃ¢ncias de seguranÃ§a
  - Ensaios de estanquidade

### 6. ğŸ—ï¸ Estruturas
**Status:** ğŸ”´ A IMPLEMENTAR
- Regulamentos:
  - EurocÃ³digo 0 (EN 1990) - Bases de cÃ¡lculo
  - EurocÃ³digo 1 (EN 1991) - AÃ§Ãµes
  - EurocÃ³digo 2 (EN 1992) - BetÃ£o
  - EurocÃ³digo 3 (EN 1993) - AÃ§o
  - EurocÃ³digo 8 (EN 1998) - Sismo
- Regras exemplo:
  - VerificaÃ§Ã£o de seguranÃ§a (ELU, ELS)
  - Recobrimentos de armaduras
  - AmarraÃ§Ã£o e emendas
  - Flechas mÃ¡ximas
  - AÃ§Ã£o sÃ­smica

### 7. ğŸ  TÃ©rmica de EdifÃ­cios
**Status:** ğŸ”´ A IMPLEMENTAR
- Regulamentos:
  - REH (DL 95/2021)
  - Despacho 6476-H/2021
- Regras exemplo:
  - Coeficientes de transmissÃ£o tÃ©rmica (U)
  - Requisitos mÃ­nimos de isolamento
  - Pontes tÃ©rmicas
  - VentilaÃ§Ã£o natural
  - Necessidades nominais anuais (Nic, Nvc)

### 8. ğŸ”Š AcÃºstica
**Status:** ğŸ”´ A IMPLEMENTAR
- Regulamentos:
  - RRAE (DL 96/2008)
  - NP ISO 717 (Isolamento sonoro)
- Regras exemplo:
  - Isolamento a sons aÃ©reos (DnT,w)
  - Isolamento a sons de percussÃ£o (L'nT,w)
  - RuÃ­do de equipamentos
  - Tempo de reverberaÃ§Ã£o

### 9. â™¿ Acessibilidades
**Status:** ğŸ”´ A IMPLEMENTAR
- Regulamentos:
  - DL 163/2006
  - NP 4433 (Acessos e circulaÃ§Ã£o)
- Regras exemplo:
  - Larguras mÃ­nimas de passagem
  - Rampas (inclinaÃ§Ã£o, comprimento)
  - InstalaÃ§Ãµes sanitÃ¡rias acessÃ­veis
  - Portas (largura, forÃ§a de abertura)
  - SinalizaÃ§Ã£o e contraste

### 10. ğŸŒ³ EspaÃ§os Exteriores
**Status:** ğŸ”´ A IMPLEMENTAR
- Regulamentos:
  - PDM locais
  - Regulamentos municipais
- Regras exemplo:
  - Ãreas permeÃ¡veis mÃ­nimas
  - Estacionamento (lugares, dimensÃµes)
  - DistÃ¢ncias a limites
  - ContenÃ§Ã£o de Ã¡guas pluviais
  - EspaÃ§os verdes (mÂ²/fogo)

### 11. ğŸ”‹ Energias RenovÃ¡veis
**Status:** ğŸ”´ A IMPLEMENTAR
- Regulamentos:
  - REH (DL 95/2021) - quotas mÃ­nimas
  - LegislaÃ§Ã£o sobre autoconsumo (DL 162/2019)
- Regras exemplo:
  - Ãrea mÃ­nima de coletores solares
  - PotÃªncia mÃ­nima de painÃ©is FV
  - OrientaÃ§Ã£o e inclinaÃ§Ã£o
  - Sombreamentos
  - IntegraÃ§Ã£o arquitetÃ³nica

### 12. ğŸ’¡ IluminaÃ§Ã£o Natural
**Status:** ğŸ”´ A IMPLEMENTAR
- Regulamentos:
  - REH (DL 95/2021)
  - NP EN 12464 (IluminaÃ§Ã£o de interiores)
- Regras exemplo:
  - Fator de luz natural mÃ­nimo
  - Ãreas de vÃ£os envidraÃ§ados
  - Profundidade de compartimentos
  - ProteÃ§Ãµes solares

### 13. ğŸšª VÃ£os e Caixilharias
**Status:** ğŸ”´ A IMPLEMENTAR
- Regulamentos:
  - REH (DL 95/2021)
  - NP EN 14351 (Janelas e portas)
- Regras exemplo:
  - Coeficientes de transmissÃ£o tÃ©rmica (Uw)
  - Permeabilidade ao ar
  - Estanquidade Ã  Ã¡gua
  - ResistÃªncia ao vento
  - Fator solar (g)

### 14. ğŸ§± Paredes e DivisÃ³rias
**Status:** ğŸ”´ A IMPLEMENTAR
- Regulamentos:
  - EurocÃ³digo 6 (Alvenaria)
  - REH (requisitos tÃ©rmicos)
  - RRAE (requisitos acÃºsticos)
- Regras exemplo:
  - Espessuras mÃ­nimas
  - ResistÃªncia mecÃ¢nica
  - Isolamento tÃ©rmico
  - Isolamento acÃºstico
  - ResistÃªncia ao fogo

### 15. ğŸšï¸ Coberturas
**Status:** ğŸ”´ A IMPLEMENTAR
- Regulamentos:
  - NP EN 13707 (ImpermeabilizaÃ§Ãµes)
  - REH (isolamento tÃ©rmico)
- Regras exemplo:
  - Isolamento tÃ©rmico mÃ­nimo
  - ImpermeabilizaÃ§Ã£o
  - VentilaÃ§Ã£o de coberturas
  - InclinaÃ§Ãµes mÃ­nimas
  - Drenagem de Ã¡guas pluviais

### 16. ğŸ“¡ TelecomunicaÃ§Ãµes (ITED/ITUR)
**Status:** ğŸ”´ A IMPLEMENTAR
- Regulamentos:
  - Manual ITED (4Âª ediÃ§Ã£o)
  - Manual ITUR (3Âª ediÃ§Ã£o)
- Regras exemplo:
  - Cablagem estruturada
  - NÃºmero de tomadas por divisÃ£o
  - Tubagens e caixas
  - Repartidor geral (ATI, ATE)
  - Sistemas de satÃ©lite

### 17. ğŸ¬ Sistemas Especiais
**Status:** ğŸ”´ A IMPLEMENTAR
- Regulamentos:
  - Normas especÃ­ficas por sistema
- Regras exemplo:
  - CCTV (cobertura, resoluÃ§Ã£o)
  - Controlo de acessos
  - DeteÃ§Ã£o de intrusÃ£o
  - DomÃ³tica/automaÃ§Ã£o
  - Som ambiente

### 18. ğŸ¥ SaÃºde e Higiene
**Status:** ğŸ”´ A IMPLEMENTAR
- Regulamentos:
  - Portaria 353-A/2013 (Qualidade do ar interior)
  - DL 118/2013 (RSECE)
- Regras exemplo:
  - Taxa de ventilaÃ§Ã£o mÃ­nima
  - Qualidade do ar (COâ‚‚, COV)
  - Temperatura e humidade
  - Controlo de legionella
  - Materiais e acabamentos

---

## ğŸ—ï¸ Estrutura do Framework

### Modelo de Regra Universal

```typescript
interface UniversalRule {
  // IdentificaÃ§Ã£o
  id: string;                    // Ex: "PLUMB_R042", "HVAC_R128"
  specialty: SpecialtyType;      // 'electrical' | 'plumbing' | 'hvac' | ...
  category: string;
  subcategory: string;

  // Regulamento
  reference: string;             // Ex: "RGSPPDADAR Art. 42"
  regulation: string;            // Ex: "NP EN 806-2"
  article: string;
  version: string;
  date: string;

  // Regra
  rule_text: string;             // DescriÃ§Ã£o humana
  parameters: Record<string, any>;
  validation_type: 'formula' | 'lookup' | 'range' | 'boolean' | 'spatial';

  // ValidaÃ§Ã£o
  formula?: string;
  lookup_tables?: any;
  spatial_check?: {
    type: 'distance' | 'area' | 'height' | 'slope';
    condition: string;
  };

  // Severidade
  severity: 'mandatory' | 'recommended' | 'optional';

  // Mensagens
  error_message: string;
  success_message: string;
  recommendation?: string;

  // Metadados
  metadata: {
    complexity: 'simple' | 'medium' | 'complex';
    requires_calculation: boolean;
    requires_spatial_analysis: boolean;
    application_scope: string[];
    building_types?: string[];
    zones?: string[];
  };

  // Fonte
  source: {
    regulation: string;
    article: string;
    version: string;
    date: string;
    document_url?: string;
  };
}
```

### Tipos de Especialidades

```typescript
type SpecialtyType =
  | 'electrical'          // âš¡ RTIEBT (jÃ¡ implementado)
  | 'plumbing'           // ğŸš° Ãguas e esgotos
  | 'fire_safety'        // ğŸ”¥ SCIE
  | 'hvac'               // â„ï¸ AVAC
  | 'gas'                // â›½ GÃ¡s
  | 'structures'         // ğŸ—ï¸ Estruturas
  | 'thermal'            // ğŸ  TÃ©rmica
  | 'acoustic'           // ğŸ”Š AcÃºstica
  | 'accessibility'      // â™¿ Acessibilidades
  | 'exterior'           // ğŸŒ³ EspaÃ§os exteriores
  | 'renewable_energy'   // ğŸ”‹ RenovÃ¡veis
  | 'natural_lighting'   // ğŸ’¡ IluminaÃ§Ã£o natural
  | 'windows'            // ğŸšª VÃ£os
  | 'walls'              // ğŸ§± Paredes
  | 'roofs'              // ğŸšï¸ Coberturas
  | 'telecom'            // ğŸ“¡ ITED/ITUR
  | 'special_systems'    // ğŸ¬ Sistemas especiais
  | 'health'             // ğŸ¥ SaÃºde e higiene
  ;
```

### Engine Especializado por Especialidade

```typescript
interface SpecialtyEngine {
  specialty: SpecialtyType;
  symbol: string;              // Ex: 'ğŸ’§' para Ã¡guas, 'ğŸ”¥' para incÃªndio
  name: string;
  version: string;

  // Regras
  rules: UniversalRule[];
  totalRules: number;

  // Capacidades
  canAnalyze(project: Project): boolean;
  analyze(project: Project, context: AnalysisContext): SpecialtyAnalysisResult;

  // Metadados
  regulations: string[];       // Lista de regulamentos cobertos
  lastUpdated: string;
  coverage: {
    categories: string[];
    buildingTypes: string[];
  };
}
```

### Resultado de AnÃ¡lise Especializada

```typescript
interface SpecialtyAnalysisResult {
  specialty: SpecialtyType;
  engineType: string;          // Ex: "PLUMBING_SPECIALIZED"
  symbol: string;              // Ex: "ğŸ’§"

  statistics: {
    totalRules: number;
    rulesEvaluated: number;
    passed: number;
    failed: number;
    critical: number;
    warnings: number;
    recommendations: number;
  };

  findings: Finding[];         // Todos marcados com sÃ­mbolo

  regulationSources: string[];
  regulationVersion: string;

  scopesAnalyzed: string[];
  buildingContext: {
    type: string;
    zones: string[];
    special_requirements: string[];
  };
}
```

---

## ğŸ¯ Plano de ImplementaÃ§Ã£o

### Fase 1: Framework Base (Semana 1-2)
- [ ] Definir `UniversalRule` interface
- [ ] Criar `SpecialtyEngine` abstract class
- [ ] Sistema de carregamento de regras por especialidade
- [ ] Validador universal de fÃ³rmulas
- [ ] Sistema de sÃ­mbolos e marcaÃ§Ã£o visual

### Fase 2: Especialidades PrioritÃ¡rias (Semana 3-6)

#### 2.1 ğŸš° Ãguas e Esgotos (~100 regras)
- [ ] Regulamento RGSPPDADAR
- [ ] Normas NP EN 806, 1717, 12056
- [ ] Engine especializado
- [ ] Testes E2E

#### 2.2 ğŸ”¥ SeguranÃ§a Contra IncÃªndios (~150 regras)
- [ ] SCIE (DL 220/2008)
- [ ] Portaria 1532/2008
- [ ] Engine especializado
- [ ] ValidaÃ§Ã£o de caminhos de evacuaÃ§Ã£o
- [ ] CompartimentaÃ§Ã£o

#### 2.3 â„ï¸ AVAC (~80 regras)
- [ ] RSECE
- [ ] REH (parte AVAC)
- [ ] Engine especializado
- [ ] CÃ¡lculos de caudais

### Fase 3: Especialidades Estruturais (Semana 7-10)

#### 3.1 ğŸ—ï¸ Estruturas (~200 regras)
- [ ] EurocÃ³digos 0, 1, 2, 3, 8
- [ ] VerificaÃ§Ãµes de seguranÃ§a
- [ ] Engine especializado

#### 3.2 ğŸ  TÃ©rmica (~120 regras)
- [ ] REH (DL 95/2021)
- [ ] CÃ¡lculos tÃ©rmicos
- [ ] Engine especializado

### Fase 4: Especialidades Complementares (Semana 11-14)
- [ ] â›½ GÃ¡s (~60 regras)
- [ ] ğŸ”Š AcÃºstica (~70 regras)
- [ ] â™¿ Acessibilidades (~90 regras)
- [ ] ğŸ“¡ ITED/ITUR (~80 regras)

### Fase 5: Especialidades Finais (Semana 15-18)
- [ ] ğŸŒ³ EspaÃ§os Exteriores
- [ ] ğŸ”‹ RenovÃ¡veis
- [ ] ğŸ’¡ IluminaÃ§Ã£o Natural
- [ ] ğŸšª VÃ£os e Caixilharias
- [ ] ğŸ§± Paredes
- [ ] ğŸšï¸ Coberturas
- [ ] ğŸ¬ Sistemas Especiais
- [ ] ğŸ¥ SaÃºde

---

## ğŸ“Š Estrutura de DiretÃ³rios

```
regulamentos/
â”œâ”€â”€ electrical/              âœ… 292 regras (RTIEBT)
â”‚   â”œâ”€â”€ rtiebt/
â”‚   â”œâ”€â”€ rsrdeebt/
â”‚   â””â”€â”€ portaria-1532/
â”‚
â”œâ”€â”€ plumbing/               ğŸ”´ A criar (~100 regras)
â”‚   â”œâ”€â”€ rgsppdadar/
â”‚   â”œâ”€â”€ np-en-806/
â”‚   â””â”€â”€ np-en-12056/
â”‚
â”œâ”€â”€ fire-safety/            ğŸ”´ A criar (~150 regras)
â”‚   â”œâ”€â”€ scie/
â”‚   â”œâ”€â”€ portaria-1532/
â”‚   â””â”€â”€ evacuation/
â”‚
â”œâ”€â”€ hvac/                   ğŸ”´ A criar (~80 regras)
â”‚   â”œâ”€â”€ rsece/
â”‚   â”œâ”€â”€ reh/
â”‚   â””â”€â”€ np-1037/
â”‚
â”œâ”€â”€ structures/             ğŸ”´ A criar (~200 regras)
â”‚   â”œâ”€â”€ ec0-bases/
â”‚   â”œâ”€â”€ ec1-acoes/
â”‚   â”œâ”€â”€ ec2-betao/
â”‚   â”œâ”€â”€ ec3-aco/
â”‚   â””â”€â”€ ec8-sismo/
â”‚
â””â”€â”€ [outras especialidades]/
```

---

## ğŸ¨ Sistema de SÃ­mbolos

Cada especialidade terÃ¡ um sÃ­mbolo Ãºnico para identificaÃ§Ã£o visual:

| Especialidade | SÃ­mbolo | Prefixo | Exemplo Finding |
|---------------|---------|---------|-----------------|
| ElÃ©trica      | âš¡      | ELEC_   | âš¡ RTIEBT 533.2 |
| Ãguas         | ğŸ’§      | PLUMB_  | ğŸ’§ RGSPPDADAR Art.42 |
| IncÃªndios     | ğŸ”¥      | FIRE_   | ğŸ”¥ SCIE DL220/2008 |
| AVAC          | â„ï¸      | HVAC_   | â„ï¸ RSECE Art.28 |
| GÃ¡s           | â›½      | GAS_    | â›½ RGSPGN DL521/99 |
| Estruturas    | ğŸ—ï¸      | STRUCT_ | ğŸ—ï¸ EC2 EN1992 |
| TÃ©rmica       | ğŸŒ¡ï¸      | THERM_  | ğŸŒ¡ï¸ REH DL95/2021 |
| AcÃºstica      | ğŸ”Š      | ACOUS_  | ğŸ”Š RRAE DL96/2008 |
| Acessibilidad | â™¿      | ACCESS_ | â™¿ DL163/2006 |
| EspaÃ§os Ext   | ğŸŒ³      | EXTR_   | ğŸŒ³ PDM Local |
| RenovÃ¡veis    | ğŸ”‹      | RENEW_  | ğŸ”‹ REH Quota Solar |
| Ilum Natural  | â˜€ï¸      | NATLT_  | â˜€ï¸ REH Fator Luz |
| VÃ£os          | ğŸšª      | WIND_   | ğŸšª REH Uw<1.8 |
| Paredes       | ğŸ§±      | WALL_   | ğŸ§± EC6 Alvenaria |
| Coberturas    | ğŸšï¸      | ROOF_   | ğŸšï¸ REH Isolamento |
| Telecom       | ğŸ“¡      | ITED_   | ğŸ“¡ ITED 4Âª Ed |
| Sist Especiais| ğŸ¬      | SPEC_   | ğŸ¬ CCTV Coverage |
| SaÃºde         | ğŸ¥      | HLTH_   | ğŸ¥ QAI COâ‚‚<1000ppm |

---

## ğŸ”§ API de AnÃ¡lise Universal

```typescript
// AnÃ¡lise completa de todas as especialidades
const result = await analyzeProject(project, {
  specialties: 'all',  // ou array especÃ­fico: ['electrical', 'plumbing']
  depth: 'comprehensive',
  includeRecommendations: true
});

// Resultado estruturado por especialidade
interface UniversalAnalysisResult {
  summary: {
    totalSpecialties: number;
    specialtiesAnalyzed: string[];
    totalFindings: number;
    critical: number;
    warnings: number;
    passed: number;
  };

  bySpecialty: {
    [key in SpecialtyType]?: SpecialtyAnalysisResult;
  };

  findings: Finding[];  // Todos com sÃ­mbolos e marcaÃ§Ã£o

  regulationCompliance: {
    [regulation: string]: {
      total: number;
      passed: number;
      failed: number;
      coverage: number;  // 0-100%
    };
  };
}
```

---

## ğŸ“ˆ MÃ©tricas de Sucesso

- **Cobertura:** Todas as 18 especialidades com engines especializados
- **Regras:** ~1500-2000 regras totais (vs 292 atuais do RTIEBT)
- **Regulamentos:** 30-50 regulamentos portugueses cobertos
- **Visibilidade:** Cada especialidade claramente identificada (sÃ­mbolo + metadata)
- **Qualidade:** Testes E2E para cada especialidade
- **DocumentaÃ§Ã£o:** Guia completo de regras por especialidade

---

## ğŸ¯ Objetivos Finais

1. **AnÃ¡lise Profunda:** Cada especialidade tÃ£o detalhada quanto RTIEBT
2. **Uniformidade:** Todas seguem o mesmo padrÃ£o de estrutura e validaÃ§Ã£o
3. **Visibilidade:** Clara identificaÃ§Ã£o da origem de cada finding
4. **Manutenibilidade:** FÃ¡cil adicionar/atualizar regras
5. **Escalabilidade:** Sistema preparado para novos regulamentos
6. **Conformidade:** 100% dos regulamentos portugueses relevantes

---

**Data:** 2026-02-16
**VersÃ£o:** 1.0
**Status:** ğŸ“‹ Framework definido, pronto para implementaÃ§Ã£o
